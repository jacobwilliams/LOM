<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="Low Lunar Orbit Maintenance">
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>hstart &ndash; lom</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">lom </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>hstart
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.3% of total for procedures.">100 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/rk_module_variable_step.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/rk_module_variable_step.f90.html'>rk_module_variable_step.f90</a></li>
     <li><a href='../module/rk_module_variable_step.html'>rk_module_variable_step</a></li>
     <li class="active">hstart</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/hstart.html#src">hstart</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>private subroutine hstart(me, a, b, y, yprime, etol, h)</h2>
    

    <p>Computes a starting step size to be used in solving initial
  value problems in ordinary differential equations.</p>
<p>It is based on an estimate of the local lipschitz constant for the
  differential equation (lower bound on a norm of the jacobian) ,
  a bound on the differential equation (first derivative), and
  a bound on the partial derivative of the equation with respect to
  the independent variable. (all approximated near the initial point a)</p>
<p></p><div class="alert alert-info" role="alert"><h4>Note</h4><p>Subroutine hstart also uses the <code>me%stepsize_method%norm</code>
      function for computing vector norms</p></div>
<p></p><div class="alert alert-info" role="alert"><h4>Note</h4><p>This routine is from <a href="https://github.com/jacobwilliams/ddeabm">DDEABM</a>.</p></div>
<h1>History</h1>
<ul>
<li>820301  date written -- watts, h. a., (snla)</li>
<li>890531  changed all specific intrinsics to generic.  (wrb)</li>
<li>890831  modified array declarations.  (wrb)</li>
<li>890911  removed unnecessary intrinsics.  (wrb)</li>
<li>891024  changed references from dvnorm to dhvnrm.  (wrb)</li>
<li>891214  prologue converted to version 4.0 format.  (bab)</li>
<li>900328  added type section.  (wrb)</li>
<li>910722  updated author section.  (als)</li>
<li>December, 2015 : Refactored this routine (jw)</li>
<li>April 2016 : Some modifications for the variable-step RK module (jw)</li>
</ul>

    <h3>Arguments</h3>
      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" id="variable-me~100"></span>class(<a href='../type/rk_variable_step_class.html'>rk_variable_step_class</a>),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>me</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-a~14"></span>real(kind=wp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>a</strong></td><td><p>the initial point of integration.</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-b~6"></span>real(kind=wp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>b</strong></td><td><p>a value of the independent variable used to define
the direction of integration. a reasonable choice is to
set <code>b</code> to the first point at which a solution is desired.
you can also use <code>b</code>, if necessary, to restrict the length
of the first integration step because the algorithm will
not compute a starting step length which is bigger than
<code>abs(b-a)</code>, unless <code>b</code> has been chosen too close to <code>a</code>.
(it is presumed that hstart has been called with <code>b</code>
different from <code>a</code> on the machine being used. also see the
discussion about the parameter <code>small</code>.)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-y~18"></span>real(kind=wp),</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(me%n)</td><td>::</td>
  <td><strong>y</strong></td><td><p>the vector of initial values of the <code>neq</code> solution
components at the initial point <code>a</code>.</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-yprime~2"></span>real(kind=wp),</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(me%n)</td><td>::</td>
  <td><strong>yprime</strong></td><td><p>the vector of derivatives of the <code>neq</code>
solution components at the initial point <code>a</code>.
(defined by the differential equations in subroutine <code>me%f</code>)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-etol~2"></span>real(kind=wp),</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(me%n)</td><td>::</td>
  <td><strong>etol</strong></td><td><p>the vector of error tolerances corresponding to
the <code>neq</code> solution components. it is assumed that all
elements are positive. following the first integration
step, the tolerances are expected to be used by the
integrator in an error test which roughly requires that
<code>abs(local error) &lt;= etol</code> for each vector component.</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-h~22"></span>real(kind=wp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>h</strong></td><td><p>appropriate starting step size to be attempted by the
differential equation method.</p></td>
</tr>
</tbody>
</table>

    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/hstart.html#src">hstart</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="w">    </span><span class="k">subroutine </span><span class="n">hstart</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">yprime</span><span class="p">,</span><span class="n">etol</span><span class="p">,</span><span class="n">h</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">implicit none</span>

<span class="k">    class</span><span class="p">(</span><span class="n">rk_variable_step_class</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">me</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">a</span><span class="w">         </span><span class="c">!! the initial point of integration.</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">b</span><span class="w">         </span><span class="c">!! a value of the independent variable used to define</span>
<span class="w">                                                    </span><span class="c">!! the direction of integration. a reasonable choice is to</span>
<span class="w">                                                    </span><span class="c">!! set `b` to the first point at which a solution is desired.</span>
<span class="w">                                                    </span><span class="c">!! you can also use `b`, if necessary, to restrict the length</span>
<span class="w">                                                    </span><span class="c">!! of the first integration step because the algorithm will</span>
<span class="w">                                                    </span><span class="c">!! not compute a starting step length which is bigger than</span>
<span class="w">                                                    </span><span class="c">!! `abs(b-a)`, unless `b` has been chosen too close to `a`.</span>
<span class="w">                                                    </span><span class="c">!! (it is presumed that hstart has been called with `b`</span>
<span class="w">                                                    </span><span class="c">!! different from `a` on the machine being used. also see the</span>
<span class="w">                                                    </span><span class="c">!! discussion about the parameter `small`.)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">n</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">y</span><span class="w">        </span><span class="c">!! the vector of initial values of the `neq` solution</span>
<span class="w">                                                    </span><span class="c">!! components at the initial point `a`.</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">n</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">yprime</span><span class="w">   </span><span class="c">!! the vector of derivatives of the `neq`</span>
<span class="w">                                                    </span><span class="c">!! solution components at the initial point `a`.</span>
<span class="w">                                                    </span><span class="c">!! (defined by the differential equations in subroutine `me%f`)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">n</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">etol</span><span class="w">     </span><span class="c">!! the vector of error tolerances corresponding to</span>
<span class="w">                                                    </span><span class="c">!! the `neq` solution components. it is assumed that all</span>
<span class="w">                                                    </span><span class="c">!! elements are positive. following the first integration</span>
<span class="w">                                                    </span><span class="c">!! step, the tolerances are expected to be used by the</span>
<span class="w">                                                    </span><span class="c">!! integrator in an error test which roughly requires that</span>
<span class="w">                                                    </span><span class="c">!! `abs(local error) &lt;= etol` for each vector component.</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">h</span><span class="w">       </span><span class="c">!! appropriate starting step size to be attempted by the</span>
<span class="w">                                    </span><span class="c">!! differential equation method.</span>

<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">spy</span><span class="w">  </span><span class="c">!! work array which provide the routine with needed storage space.</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pv</span><span class="w">   </span><span class="c">!! work array which provide the routine with needed storage space.</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">yp</span><span class="w">   </span><span class="c">!! work array which provide the routine with needed storage space.</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">sf</span><span class="w">   </span><span class="c">!! work array which provide the routine with needed storage space.</span>

<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">small</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nb">epsilon</span><span class="p">(</span><span class="n">one</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">big</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nb">huge</span><span class="p">(</span><span class="n">one</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">relper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">small</span><span class="o">**</span><span class="mf">0.375_wp</span><span class="w"></span>

<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">lk</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">absdx</span><span class="p">,</span><span class="w"> </span><span class="n">da</span><span class="p">,</span><span class="w"> </span><span class="n">delf</span><span class="p">,</span><span class="w"> </span><span class="n">dely</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">                </span><span class="n">dfdub</span><span class="p">,</span><span class="w"> </span><span class="n">dfdxb</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">                </span><span class="n">dx</span><span class="p">,</span><span class="w"> </span><span class="n">dy</span><span class="p">,</span><span class="w"> </span><span class="n">fbnd</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">                </span><span class="n">srydpb</span><span class="p">,</span><span class="w"> </span><span class="n">tolexp</span><span class="p">,</span><span class="w"> </span><span class="n">tolmin</span><span class="p">,</span><span class="w"> </span><span class="n">tolp</span><span class="p">,</span><span class="w"> </span><span class="n">tolsum</span><span class="p">,</span><span class="w"> </span><span class="n">ydpb</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">morder</span><span class="w">    </span><span class="c">!! the order of the formula which will be used by</span>
<span class="w">                         </span><span class="c">!! the initial value method for taking the first integration</span>
<span class="w">                         </span><span class="c">!! step.</span>

<span class="w">    </span><span class="n">morder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="w"></span>
<span class="w">    </span><span class="n">dx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="w"></span>
<span class="w">    </span><span class="n">absdx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">dx</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="c">! compute an approximate bound (dfdxb) on the partial</span>
<span class="w">    </span><span class="c">! derivative of the equation with respect to the</span>
<span class="w">    </span><span class="c">! independent variable. protect against an overflow.</span>
<span class="w">    </span><span class="c">! also compute a bound (fbnd) on the first derivative</span>
<span class="w">    </span><span class="c">! locally.</span>

<span class="w">    </span><span class="n">da</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sign</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">relper</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="p">),</span><span class="n">absdx</span><span class="p">),</span><span class="mi">10</span><span class="mf">0.0_wp</span><span class="o">*</span><span class="n">small</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="p">)),</span><span class="n">dx</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">da</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">zero</span><span class="p">)</span><span class="w"> </span><span class="n">da</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">relper</span><span class="o">*</span><span class="n">dx</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">da</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">sf</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">yp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sf</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">yprime</span><span class="w"></span>
<span class="w">    </span><span class="n">delf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">stepsize_method</span><span class="p">%</span><span class="n">norm</span><span class="p">(</span><span class="n">yp</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">dfdxb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">big</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">delf</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">big</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">da</span><span class="p">))</span><span class="w"> </span><span class="n">dfdxb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">delf</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">da</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">fbnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">stepsize_method</span><span class="p">%</span><span class="n">norm</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="c">! compute an estimate (dfdub) of the local lipschitz</span>
<span class="w">    </span><span class="c">! constant for the system of differential equations. this</span>
<span class="w">    </span><span class="c">! also represents an estimate of the norm of the jacobian</span>
<span class="w">    </span><span class="c">! locally.  three iterations (two when neq=1) are used to</span>
<span class="w">    </span><span class="c">! estimate the lipschitz constant by numerical differences.</span>
<span class="w">    </span><span class="c">! the first perturbation vector is based on the initial</span>
<span class="w">    </span><span class="c">! derivatives and direction of integration. the second</span>
<span class="w">    </span><span class="c">! perturbation vector is formed using another evaluation of</span>
<span class="w">    </span><span class="c">! the differential equation.  the third perturbation vector</span>
<span class="w">    </span><span class="c">! is formed using perturbations based only on the initial</span>
<span class="w">    </span><span class="c">! values. components that are zero are always changed to</span>
<span class="w">    </span><span class="c">! non-zero values (except on the first iteration). when</span>
<span class="w">    </span><span class="c">! information is available, care is taken to ensure that</span>
<span class="w">    </span><span class="c">! components of the perturbation vector have signs which are</span>
<span class="w">    </span><span class="c">! consistent with the slopes of local solution curves.</span>
<span class="w">    </span><span class="c">! also choose the largest bound (fbnd) for the first</span>
<span class="w">    </span><span class="c">! derivative.</span>
<span class="w">    </span><span class="c">!</span>
<span class="w">    </span><span class="c">! perturbation vector size is held</span>
<span class="w">    </span><span class="c">! constant for all iterations. compute</span>
<span class="w">    </span><span class="c">! this change from the</span>
<span class="w">    </span><span class="c">! size of the vector of initial</span>
<span class="w">    </span><span class="c">! values.</span>

<span class="w">    </span><span class="n">dely</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">relper</span><span class="o">*</span><span class="n">me</span><span class="p">%</span><span class="n">stepsize_method</span><span class="p">%</span><span class="n">norm</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dely</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">zero</span><span class="p">)</span><span class="w"> </span><span class="n">dely</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">relper</span><span class="w"></span>
<span class="w">    </span><span class="n">dely</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sign</span><span class="p">(</span><span class="n">dely</span><span class="p">,</span><span class="n">dx</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">delf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">stepsize_method</span><span class="p">%</span><span class="n">norm</span><span class="p">(</span><span class="n">yprime</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">fbnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="n">fbnd</span><span class="p">,</span><span class="n">delf</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">delf</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">zero</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">        </span><span class="c">! cannot have a null perturbation vector</span>
<span class="w">        </span><span class="n">spy</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span><span class="w"></span>
<span class="w">        </span><span class="n">yp</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">one</span><span class="w"></span>
<span class="w">        </span><span class="n">delf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">stepsize_method</span><span class="p">%</span><span class="n">norm</span><span class="p">(</span><span class="n">yp</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">else</span><span class="w"></span>
<span class="w">        </span><span class="c">! use initial derivatives for first perturbation</span>
<span class="w">        </span><span class="n">spy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yprime</span><span class="w"></span>
<span class="w">        </span><span class="n">yp</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">yprime</span><span class="w"></span>
<span class="w">    </span><span class="k">end if</span>

<span class="k">    </span><span class="n">dfdub</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span><span class="w"></span>
<span class="w">    </span><span class="n">lk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">lk</span><span class="w"></span>
<span class="w">        </span><span class="c">! define perturbed vector of initial values</span>
<span class="w">        </span><span class="n">pv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">yp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">dely</span><span class="o">/</span><span class="n">delf</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">            </span><span class="c">! use a shifted value of the independent variable</span>
<span class="w">            </span><span class="c">! in computing one estimate</span>
<span class="w">            </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">da</span><span class="p">,</span><span class="n">pv</span><span class="p">,</span><span class="n">yp</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">pv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yp</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sf</span><span class="w"></span>
<span class="w">        </span><span class="k">else</span><span class="w"></span>
<span class="w">            </span><span class="c">! evaluate derivatives associated with perturbed</span>
<span class="w">            </span><span class="c">! vector and compute corresponding differences</span>
<span class="w">            </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">pv</span><span class="p">,</span><span class="n">yp</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">pv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yp</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">yprime</span><span class="w"></span>
<span class="w">        </span><span class="k">end if</span><span class="w"></span>
<span class="w">        </span><span class="c">! choose largest bounds on the first derivative</span>
<span class="w">        </span><span class="c">! and a local lipschitz constant</span>
<span class="w">        </span><span class="n">fbnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="n">fbnd</span><span class="p">,</span><span class="n">me</span><span class="p">%</span><span class="n">stepsize_method</span><span class="p">%</span><span class="n">norm</span><span class="p">(</span><span class="n">yp</span><span class="p">))</span><span class="w"></span>
<span class="w">        </span><span class="n">delf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">stepsize_method</span><span class="p">%</span><span class="n">norm</span><span class="p">(</span><span class="n">pv</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">delf</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">big</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">dely</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">            </span><span class="c">! protect against an overflow</span>
<span class="w">            </span><span class="n">dfdub</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">big</span><span class="w"></span>
<span class="w">            </span><span class="k">exit</span>
<span class="k">        end if</span>
<span class="k">        </span><span class="n">dfdub</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="n">dfdub</span><span class="p">,</span><span class="n">delf</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">dely</span><span class="p">))</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">lk</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span><span class="w"></span>

<span class="w">        </span><span class="c">! choose next perturbation vector</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">delf</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">zero</span><span class="p">)</span><span class="w"> </span><span class="n">delf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span><span class="w"></span>
<span class="w">        </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">n</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                </span><span class="n">dy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dy</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">zero</span><span class="p">)</span><span class="w"> </span><span class="n">dy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dely</span><span class="o">/</span><span class="n">relper</span><span class="w"></span>
<span class="w">            </span><span class="k">else</span>
<span class="k">                </span><span class="n">dy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">pv</span><span class="p">(</span><span class="n">j</span><span class="p">))</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dy</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">zero</span><span class="p">)</span><span class="w"> </span><span class="n">dy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">delf</span><span class="w"></span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">spy</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">zero</span><span class="p">)</span><span class="w"> </span><span class="n">spy</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yp</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">spy</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">zero</span><span class="p">)</span><span class="w"> </span><span class="n">dy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sign</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span><span class="n">spy</span><span class="p">(</span><span class="n">j</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="n">yp</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dy</span><span class="w"></span>
<span class="w">        </span><span class="k">end do</span>
<span class="k">        </span><span class="n">delf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">stepsize_method</span><span class="p">%</span><span class="n">norm</span><span class="p">(</span><span class="n">yp</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">end do</span><span class="w"></span>

<span class="w">    </span><span class="c">! compute a bound (ydpb) on the norm of the second derivative</span>

<span class="w">    </span><span class="n">ydpb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfdxb</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dfdub</span><span class="o">*</span><span class="n">fbnd</span><span class="w"></span>

<span class="w">    </span><span class="c">! define the tolerance parameter upon which the starting step</span>
<span class="w">    </span><span class="c">! size is to be based.  a value in the middle of the error</span>
<span class="w">    </span><span class="c">! tolerance range is selected.</span>

<span class="w">    </span><span class="n">tolmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">big</span><span class="w"></span>
<span class="w">    </span><span class="n">tolsum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span><span class="w"></span>
<span class="w">    </span><span class="k">do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">n</span><span class="w"></span>
<span class="w">        </span><span class="n">tolexp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">log10</span><span class="p">(</span><span class="n">etol</span><span class="p">(</span><span class="n">k</span><span class="p">))</span><span class="w"></span>
<span class="w">        </span><span class="n">tolmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">tolmin</span><span class="p">,</span><span class="n">tolexp</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">tolsum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tolsum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tolexp</span><span class="w"></span>
<span class="w">    </span><span class="k">end do</span>
<span class="k">    </span><span class="n">tolp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="mf">0.0_wp</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5_wp</span><span class="o">*</span><span class="p">(</span><span class="n">tolsum</span><span class="o">/</span><span class="n">me</span><span class="p">%</span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tolmin</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">morder</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>

<span class="w">    </span><span class="c">! compute a starting step size based on the above first and</span>
<span class="w">    </span><span class="c">! second derivative information</span>
<span class="w">    </span><span class="c">!</span>
<span class="w">    </span><span class="c">! restrict the step length to be not bigger</span>
<span class="w">    </span><span class="c">! than abs(b-a). (unless b is too close to a)</span>

<span class="w">    </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">absdx</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ydpb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">zero</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">fbnd</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">zero</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">        </span><span class="c">! both first derivative term (fbnd) and second</span>
<span class="w">        </span><span class="c">! derivative term (ydpb) are zero</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tolp</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">one</span><span class="p">)</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">absdx</span><span class="o">*</span><span class="n">tolp</span><span class="w"></span>
<span class="w">    </span><span class="n">elseif</span><span class="w"> </span><span class="p">(</span><span class="n">ydpb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">zero</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">        </span><span class="c">! only second derivative term (ydpb) is zero</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tolp</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">fbnd</span><span class="o">*</span><span class="n">absdx</span><span class="p">)</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tolp</span><span class="o">/</span><span class="n">fbnd</span><span class="w"></span>
<span class="w">    </span><span class="k">else</span><span class="w"></span>
<span class="w">        </span><span class="c">! second derivative term (ydpb) is non-zero</span>
<span class="w">        </span><span class="n">srydpb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="mf">0.5_wp</span><span class="o">*</span><span class="n">ydpb</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tolp</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">srydpb</span><span class="o">*</span><span class="n">absdx</span><span class="p">)</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tolp</span><span class="o">/</span><span class="n">srydpb</span><span class="w"></span>
<span class="w">    </span><span class="k">end if</span><span class="w"></span>

<span class="w">    </span><span class="c">! further restrict the step length to be not bigger than  1/dfdub</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">h</span><span class="o">*</span><span class="n">dfdub</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">one</span><span class="p">)</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span><span class="o">/</span><span class="n">dfdub</span><span class="w"></span>

<span class="w">    </span><span class="c">! finally, restrict the step length to be not</span>
<span class="w">    </span><span class="c">! smaller than 100*small*abs(a). however, if</span>
<span class="w">    </span><span class="c">! a=0. and the computed h underflowed to zero,</span>
<span class="w">    </span><span class="c">! the algorithm returns small*abs(b) for the step length.</span>
<span class="w">    </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="mi">10</span><span class="mf">0.0_wp</span><span class="o">*</span><span class="n">small</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="p">))</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">h</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">zero</span><span class="p">)</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">small</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="c">! now set direction of integration</span>
<span class="w">    </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sign</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="n">dx</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">end subroutine </span><span class="n">hstart</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>lom was developed by Jacob Williams<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>