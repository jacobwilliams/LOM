<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="Low Lunar Orbit Maintenance">
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>altitude_maintenance.f90 &ndash; lom</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">lom </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>altitude_maintenance.f90
    <small>Source File</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.7% of total for source files.">227 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/altitude_maintenance.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li class="active">altitude_maintenance.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../module/altitude_maintenance_module.html">altitude_maintenance_module</a>
    </div>
  </div>
</div>
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/altitude_maintenance.f90.html#src">altitude_maintenance.f90</a>
  </div>
</div>

</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: sourcefile~~altitude_maintenance.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilealtitude_maintenancef90EfferentGraph" width="641pt" height="764pt"
 viewBox="0.00 0.00 641.00 764.09" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph" class="graph" transform="scale(2.35 2.35) rotate(0) translate(4 1792.4)">
<title>sourcefile~~altitude_maintenance.f90~~EfferentGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1792.4 1503,-1792.4 1503,4 -4,4"/>
<!-- sourcefile~altitude_maintenance.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~altitude_maintenance.f90</title>
<polygon fill="none" stroke="black" points="1499,-1124.4 1350,-1124.4 1350,-1100.4 1499,-1100.4 1499,-1124.4"/>
<text text-anchor="middle" x="1424.5" y="-1110" font-family="Helvetica,sans-Serif" font-size="10.50">altitude_maintenance.f90</text>
</g>
<!-- sourcefile~ddeabm_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~ddeabm_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/ddeabm_module.f90.html" xlink:title="ddeabm_module.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1281.5,-1466.4 1156.5,-1466.4 1156.5,-1442.4 1281.5,-1442.4 1281.5,-1466.4"/>
<text text-anchor="middle" x="1219" y="-1452" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ddeabm_module.F90</text>
</a>
</g>
</g>
<!-- sourcefile~altitude_maintenance.f90&#45;&gt;sourcefile~ddeabm_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~altitude_maintenance.f90&#45;&gt;sourcefile~ddeabm_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1416.26,-1124.57C1386.15,-1175.16 1270.71,-1369.17 1232.42,-1433.52"/>
<polygon fill="#000000" stroke="#000000" points="1229.26,-1431.99 1227.16,-1442.37 1235.28,-1435.57 1229.26,-1431.99"/>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~fortran_astrodynamics_toolkit.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/fortran_astrodynamics_toolkit.f90.html" xlink:title="fortran_astrodynamics_toolkit.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1314,-1103.4 1124,-1103.4 1124,-1079.4 1314,-1079.4 1314,-1103.4"/>
<text text-anchor="middle" x="1219" y="-1089" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fortran_astrodynamics_toolkit.f90</text>
</a>
</g>
</g>
<!-- sourcefile~altitude_maintenance.f90&#45;&gt;sourcefile~fortran_astrodynamics_toolkit.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~altitude_maintenance.f90&#45;&gt;sourcefile~fortran_astrodynamics_toolkit.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1349.74,-1104.78C1341.41,-1103.92 1332.79,-1103.04 1324.16,-1102.14"/>
<polygon fill="#000000" stroke="#000000" points="1324.33,-1098.64 1314.03,-1101.1 1323.62,-1105.61 1324.33,-1098.64"/>
</g>
<!-- sourcefile~root_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~root_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node26"><a xlink:href=".././sourcefile/root_module.f90.html" xlink:title="root_module.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1060,-1788.4 958,-1788.4 958,-1764.4 1060,-1764.4 1060,-1788.4"/>
<text text-anchor="middle" x="1009" y="-1774" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">root_module.F90</text>
</a>
</g>
</g>
<!-- sourcefile~ddeabm_module.f90&#45;&gt;sourcefile~root_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~ddeabm_module.f90&#45;&gt;sourcefile~root_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1216.23,-1466.58C1209.11,-1511.27 1178.41,-1667.95 1088,-1750.4 1082.63,-1755.29 1076.32,-1759.26 1069.65,-1762.49"/>
<polygon fill="#000000" stroke="#000000" points="1068.2,-1759.3 1060.38,-1766.45 1070.95,-1765.74 1068.2,-1759.3"/>
</g>
<!-- sourcefile~bplane_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~bplane_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/bplane_module.f90.html" xlink:title="bplane_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="653,-970.4 538,-970.4 538,-946.4 653,-946.4 653,-970.4"/>
<text text-anchor="middle" x="595.5" y="-956" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bplane_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~bplane_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~bplane_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008,-1306.4C921.23,-1328.32 958.93,-1201.99 894,-1140.4 812.65,-1063.23 693.31,-1002.46 633.52,-974.75"/>
<polygon fill="#000000" stroke="#000000" points="634.65,-971.42 624.1,-970.44 631.74,-977.79 634.65,-971.42"/>
</g>
<!-- sourcefile~transformation_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~transformation_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/transformation_module.f90.html" xlink:title="transformation_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1088,-888.4 930,-888.4 930,-864.4 1088,-864.4 1088,-888.4"/>
<text text-anchor="middle" x="1009" y="-874" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">transformation_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~transformation_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~transformation_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1206.22,-1079.22C1171.76,-1043.6 1070.9,-939.34 1028.8,-895.83"/>
<polygon fill="#000000" stroke="#000000" points="1031.12,-893.19 1021.65,-888.44 1026.09,-898.06 1031.12,-893.19"/>
</g>
<!-- sourcefile~celestial_body_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~celestial_body_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/celestial_body_module.f90.html" xlink:title="celestial_body_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463,-1354.4 309,-1354.4 309,-1330.4 463,-1330.4 463,-1354.4"/>
<text text-anchor="middle" x="386" y="-1340" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">celestial_body_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~celestial_body_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~celestial_body_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008,-1306.4C973.74,-1316.36 955.88,-1300.84 930,-1325.4 889.61,-1363.72 916.64,-1394.52 894,-1445.4 865.46,-1509.53 874.51,-1548.44 812,-1580.4"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-1580.4C758.97,-1606.48 746.21,-1547 692,-1528.4 650.61,-1514.19 637.98,-1518.35 596.5,-1504.4"/>
</g>
<!-- sourcefile~gravity_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~gravity_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/gravity_module.f90.html" xlink:title="gravity_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443.5,-1514.4 328.5,-1514.4 328.5,-1490.4 443.5,-1490.4 443.5,-1514.4"/>
<text text-anchor="middle" x="386" y="-1500" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gravity_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~gravity_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~gravity_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-1580.4C720.6,-1626.79 697.22,-1657.06 596.5,-1656.4"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-1656.4C505.9,-1655.81 430.5,-1564.46 400.67,-1522.75"/>
<polygon fill="#000000" stroke="#000000" points="403.45,-1520.62 394.85,-1514.42 397.71,-1524.63 403.45,-1520.62"/>
</g>
<!-- sourcefile~rk_module_variable_step.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~rk_module_variable_step.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/rk_module_variable_step.f90.html" xlink:title="rk_module_variable_step.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="894,-528.4 728,-528.4 728,-504.4 894,-504.4 894,-528.4"/>
<text text-anchor="middle" x="811" y="-514" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rk_module_variable_step.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~rk_module_variable_step.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~rk_module_variable_step.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008,-638.4C954.15,-599.83 952.02,-574.35 894,-542.4 886.67,-538.36 878.61,-534.84 870.5,-531.81"/>
<polygon fill="#000000" stroke="#000000" points="871.6,-528.48 861,-528.47 869.28,-535.09 871.6,-528.48"/>
</g>
<!-- sourcefile~geodesy_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~geodesy_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/geodesy_module.f90.html" xlink:title="geodesy_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="448,-1434.4 324,-1434.4 324,-1410.4 448,-1410.4 448,-1434.4"/>
<text text-anchor="middle" x="386" y="-1420" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">geodesy_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~geodesy_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~geodesy_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-1580.4C686.56,-1643.49 613.41,-1634.69 499,-1556.4 468.49,-1535.51 486.22,-1510.17 463,-1481.4 449.93,-1465.21 431.59,-1450.8 416.2,-1440.28"/>
<polygon fill="#000000" stroke="#000000" points="417.81,-1437.15 407.54,-1434.55 413.95,-1442.99 417.81,-1437.15"/>
</g>
<!-- sourcefile~crtbp_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~crtbp_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node10"><a xlink:href=".././sourcefile/crtbp_module.f90.html" xlink:title="crtbp_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="648.5,-1476.4 542.5,-1476.4 542.5,-1452.4 648.5,-1452.4 648.5,-1476.4"/>
<text text-anchor="middle" x="595.5" y="-1462" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">crtbp_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~crtbp_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~crtbp_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-1384.4C774.04,-1394.71 763.38,-1391.24 728,-1403.4 692.6,-1415.56 653.95,-1434.18 627.77,-1447.65"/>
<polygon fill="#000000" stroke="#000000" points="625.97,-1444.64 618.72,-1452.36 629.2,-1450.85 625.97,-1444.64"/>
</g>
<!-- sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~kind_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node11"><a xlink:href=".././sourcefile/kind_module.f90.html" xlink:title="kind_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="101,-1472.4 0,-1472.4 0,-1448.4 101,-1448.4 101,-1472.4"/>
<text text-anchor="middle" x="50.5" y="-1458" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kind_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1214.04,-1103.66C1192.95,-1166.94 1087.46,-1458.68 894,-1594.4 702.43,-1728.78 620.65,-1749.27 387,-1736.4"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-1736.4C370.84,-1736.02 147.7,-1686.68 137,-1677.4 77.35,-1625.65 58.96,-1526.81 53.59,-1482.66"/>
<polygon fill="#000000" stroke="#000000" points="57.04,-1481.99 52.46,-1472.44 50.08,-1482.76 57.04,-1481.99"/>
</g>
<!-- sourcefile~minpack_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~minpack_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node12"><a xlink:href=".././sourcefile/minpack_module.f90.html" xlink:title="minpack_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="448,-1194.4 324,-1194.4 324,-1170.4 448,-1170.4 448,-1194.4"/>
<text text-anchor="middle" x="386" y="-1180" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">minpack_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~minpack_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~minpack_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-1154.4C750.29,-1124.31 562.25,-1151.04 458.12,-1169.09"/>
<polygon fill="#000000" stroke="#000000" points="457.25,-1165.68 448.01,-1170.86 458.46,-1172.58 457.25,-1165.68"/>
</g>
<!-- sourcefile~c_interface_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~c_interface_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node13"><a xlink:href=".././sourcefile/c_interface_module.f90.html" xlink:title="c_interface_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1078,-416.4 940,-416.4 940,-392.4 1078,-392.4 1078,-416.4"/>
<text text-anchor="middle" x="1009" y="-402" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">c_interface_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~c_interface_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~c_interface_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1214.9,-1079.04C1201.23,-1024.89 1144.56,-803.35 1088,-624.4 1064.79,-550.97 1033.06,-465.34 1018.25,-426.07"/>
<polygon fill="#000000" stroke="#000000" points="1021.51,-424.81 1014.7,-416.7 1014.97,-427.29 1021.51,-424.81"/>
</g>
<!-- sourcefile~drag_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~drag_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node14"><a xlink:href=".././sourcefile/drag_module.f90.html" xlink:title="drag_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="256.5,-1668.4 153.5,-1668.4 153.5,-1644.4 256.5,-1644.4 256.5,-1668.4"/>
<text text-anchor="middle" x="205" y="-1654" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">drag_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~drag_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~drag_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-1656.4C345.78,-1654.13 301.64,-1654.1 267.01,-1654.65"/>
<polygon fill="#000000" stroke="#000000" points="266.52,-1651.16 256.58,-1654.84 266.64,-1658.16 266.52,-1651.16"/>
</g>
<!-- sourcefile~time_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~time_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node15"><a xlink:href=".././sourcefile/time_module.f90.html" xlink:title="time_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="647,-890.4 544,-890.4 544,-866.4 647,-866.4 647,-890.4"/>
<text text-anchor="middle" x="595.5" y="-876" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">time_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~time_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~time_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008,-638.4C935.24,-586.28 953.42,-737.46 894,-804.4 861.8,-840.67 858.67,-863.22 812,-876.4"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-876.4C759.97,-890.52 700.67,-889.77 657.28,-886.2"/>
<polygon fill="#000000" stroke="#000000" points="657.44,-882.7 647.17,-885.3 656.81,-889.68 657.44,-882.7"/>
</g>
<!-- sourcefile~relative_motion_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~relative_motion_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node16"><a xlink:href=".././sourcefile/relative_motion_module.f90.html" xlink:title="relative_motion_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="676,-810.4 515,-810.4 515,-786.4 676,-786.4 676,-810.4"/>
<text text-anchor="middle" x="595.5" y="-796" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">relative_motion_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~relative_motion_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~relative_motion_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008,-638.4C955.52,-600.81 952.14,-700.34 894,-728.4 828.14,-760.18 746.96,-778.03 686.05,-787.74"/>
<polygon fill="#000000" stroke="#000000" points="685.42,-784.3 676.07,-789.29 686.49,-791.21 685.42,-784.3"/>
</g>
<!-- sourcefile~halo_orbit_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~halo_orbit_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node17"><a xlink:href=".././sourcefile/halo_orbit_module.f90.html" xlink:title="halo_orbit_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="877,-1240.4 745,-1240.4 745,-1216.4 877,-1216.4 877,-1240.4"/>
<text text-anchor="middle" x="811" y="-1226" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">halo_orbit_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~halo_orbit_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~halo_orbit_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008,-1306.4C942.25,-1323 869.08,-1274.78 833.62,-1246.83"/>
<polygon fill="#000000" stroke="#000000" points="835.82,-1244.1 825.84,-1240.54 831.41,-1249.54 835.82,-1244.1"/>
</g>
<!-- sourcefile~kepler_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~kepler_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node18"><a xlink:href=".././sourcefile/kepler_module.f90.html" xlink:title="kepler_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="651.5,-730.4 539.5,-730.4 539.5,-706.4 651.5,-706.4 651.5,-730.4"/>
<text text-anchor="middle" x="595.5" y="-716" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kepler_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~kepler_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~kepler_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-638.4C739.67,-640.46 664.08,-678.23 624.44,-701.12"/>
<polygon fill="#000000" stroke="#000000" points="622.46,-698.22 615.62,-706.31 626.01,-704.26 622.46,-698.22"/>
</g>
<!-- sourcefile~eispack_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~eispack_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node19"><a xlink:href=".././sourcefile/eispack_module.f90.html" xlink:title="eispack_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="445.5,-260.4 326.5,-260.4 326.5,-236.4 445.5,-236.4 445.5,-260.4"/>
<text text-anchor="middle" x="386" y="-246" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eispack_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~eispack_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~eispack_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-248.4C781.21,-229.65 568.43,-238.31 456.07,-244.33"/>
<polygon fill="#000000" stroke="#000000" points="455.65,-240.85 445.85,-244.88 456.02,-247.84 455.65,-240.85"/>
</g>
<!-- sourcefile~brent_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~brent_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node20"><a xlink:href=".././sourcefile/brent_module.f90.html" xlink:title="brent_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439,-420.4 333,-420.4 333,-396.4 439,-396.4 439,-420.4"/>
<text text-anchor="middle" x="386" y="-406" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">brent_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~brent_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~brent_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-324.4C550.59,-338.73 540.03,-344.19 499,-365.4 482.34,-374.01 480.2,-379.94 463,-387.4 458.25,-389.45 453.26,-391.36 448.18,-393.12"/>
<polygon fill="#000000" stroke="#000000" points="446.8,-389.89 438.37,-396.31 448.96,-396.54 446.8,-389.89"/>
</g>
<!-- sourcefile~jpl_ephemeris_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~jpl_ephemeris_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node21"><a xlink:href=".././sourcefile/jpl_ephemeris_module.f90.html" xlink:title="jpl_ephemeris_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="888,-930.4 734,-930.4 734,-906.4 888,-906.4 888,-930.4"/>
<text text-anchor="middle" x="811" y="-916" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jpl_ephemeris_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~jpl_ephemeris_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~jpl_ephemeris_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1212.32,-1103.49C1192.07,-1144.75 1118.76,-1278.92 1010,-1306.4"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008,-1306.4C845.28,-1347.5 1011.34,-1066.39 894,-946.4 889.58,-941.88 884.41,-938.09 878.84,-934.91"/>
<polygon fill="#000000" stroke="#000000" points="880.34,-931.75 869.83,-930.4 877.21,-938.01 880.34,-931.75"/>
</g>
<!-- sourcefile~geopotential_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~geopotential_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node22"><a xlink:href=".././sourcefile/geopotential_module.f90.html" xlink:title="geopotential_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="668.5,-178.4 522.5,-178.4 522.5,-154.4 668.5,-154.4 668.5,-178.4"/>
<text text-anchor="middle" x="595.5" y="-164" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">geopotential_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~geopotential_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~geopotential_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1216.65,-1079.35C1209.25,-1019.72 1168.07,-754.3 1010,-638.4"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008,-638.4C851.56,-523.68 974.57,-354.25 812,-248.4"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-248.4C777.61,-227.3 761.29,-239.05 728,-219.4 709.57,-208.51 711.07,-197.12 692,-187.4 687.64,-185.18 683.06,-183.19 678.36,-181.41"/>
<polygon fill="#000000" stroke="#000000" points="679.15,-177.98 668.56,-178.05 676.88,-184.61 679.15,-177.98"/>
</g>
<!-- sourcefile~ephemeris_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~ephemeris_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node23"><a xlink:href=".././sourcefile/ephemeris_module.f90.html" xlink:title="ephemeris_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="663.5,-1396.4 527.5,-1396.4 527.5,-1372.4 663.5,-1372.4 663.5,-1396.4"/>
<text text-anchor="middle" x="595.5" y="-1382" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ephemeris_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~ephemeris_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~ephemeris_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008,-1306.4C973.74,-1316.38 963.5,-1313.12 930,-1325.4 874.95,-1345.57 868.36,-1368.23 812,-1384.4"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-1384.4C766.06,-1397 714.9,-1397.46 673.68,-1394.55"/>
<polygon fill="#000000" stroke="#000000" points="673.94,-1391.06 663.7,-1393.77 673.4,-1398.04 673.94,-1391.06"/>
</g>
<!-- sourcefile~iau_orientation_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~iau_orientation_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node24"><a xlink:href=".././sourcefile/iau_orientation_module.f90.html" xlink:title="iau_orientation_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="675,-650.4 516,-650.4 516,-626.4 675,-626.4 675,-650.4"/>
<text text-anchor="middle" x="595.5" y="-636" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iau_orientation_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~iau_orientation_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~iau_orientation_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-638.4C769.02,-639.6 723.59,-639.76 685.21,-639.56"/>
<polygon fill="#000000" stroke="#000000" points="685.12,-636.06 675.1,-639.5 685.08,-643.06 685.12,-636.06"/>
</g>
<!-- sourcefile~vector_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~vector_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node25"><a xlink:href=".././sourcefile/vector_module.f90.html" xlink:title="vector_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="442,-378.4 330,-378.4 330,-354.4 442,-354.4 442,-378.4"/>
<text text-anchor="middle" x="386" y="-364" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">vector_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~vector_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~vector_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-248.4C725.59,-193.44 692.25,-293.13 596.5,-324.4"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-324.4C547.86,-339.62 493.44,-350.39 452.03,-357.21"/>
<polygon fill="#000000" stroke="#000000" points="451.38,-353.77 442.07,-358.81 452.5,-360.68 451.38,-353.77"/>
</g>
<!-- sourcefile~modified_equinoctial_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~modified_equinoctial_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node27"><a xlink:href=".././sourcefile/modified_equinoctial_module.f90.html" xlink:title="modified_equinoctial_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="690.5,-56.4 500.5,-56.4 500.5,-32.4 690.5,-32.4 690.5,-56.4"/>
<text text-anchor="middle" x="595.5" y="-42" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modified_equinoctial_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~modified_equinoctial_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~modified_equinoctial_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-84.4C755.25,-81.86 693.84,-69.31 650.99,-58.93"/>
<polygon fill="#000000" stroke="#000000" points="651.6,-55.48 641.06,-56.49 649.93,-62.28 651.6,-55.48"/>
</g>
<!-- sourcefile~complex_step.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~complex_step.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node28"><a xlink:href=".././sourcefile/complex_step.f90.html" xlink:title="complex_step.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="258,-1748.4 152,-1748.4 152,-1724.4 258,-1724.4 258,-1748.4"/>
<text text-anchor="middle" x="205" y="-1734" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">complex_step.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~complex_step.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~complex_step.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-1736.4C346.33,-1734.27 302.9,-1734.21 268.5,-1734.71"/>
<polygon fill="#000000" stroke="#000000" points="268.07,-1731.22 258.13,-1734.89 268.19,-1738.22 268.07,-1731.22"/>
</g>
<!-- sourcefile~geometry_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~geometry_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node29"><a xlink:href=".././sourcefile/geometry_module.f90.html" xlink:title="geometry_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="660.5,-220.4 530.5,-220.4 530.5,-196.4 660.5,-196.4 660.5,-220.4"/>
<text text-anchor="middle" x="595.5" y="-206" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">geometry_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~geometry_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~geometry_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-248.4C787.29,-233.61 722.77,-222.82 670.56,-216.19"/>
<polygon fill="#000000" stroke="#000000" points="670.99,-212.72 660.63,-214.97 670.13,-219.67 670.99,-212.72"/>
</g>
<!-- sourcefile~base_class_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~base_class_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node30"><a xlink:href=".././sourcefile/base_class_module.f90.html" xlink:title="base_class_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="273,-1626.4 137,-1626.4 137,-1602.4 273,-1602.4 273,-1626.4"/>
<text text-anchor="middle" x="205" y="-1612" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">base_class_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~base_class_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~base_class_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-1656.4C502.28,-1655.79 479.07,-1661.72 387,-1656.4"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-1656.4C360.91,-1655 302.82,-1640.6 259.3,-1629.04"/>
<polygon fill="#000000" stroke="#000000" points="259.99,-1625.6 249.42,-1626.4 258.18,-1632.37 259.99,-1625.6"/>
</g>
<!-- sourcefile~string_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node31" class="node">
<title>sourcefile~string_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node31"><a xlink:href=".././sourcefile/string_module.f90.html" xlink:title="string_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1063.5,-1358.4 954.5,-1358.4 954.5,-1334.4 1063.5,-1334.4 1063.5,-1358.4"/>
<text text-anchor="middle" x="1009" y="-1344" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">string_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~string_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~string_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1214.52,-1103.64C1203.08,-1141.64 1163.04,-1258.7 1088,-1320.4 1083.48,-1324.11 1078.41,-1327.31 1073.07,-1330.05"/>
<polygon fill="#000000" stroke="#000000" points="1071.54,-1326.9 1063.9,-1334.25 1074.45,-1333.26 1071.54,-1326.9"/>
</g>
<!-- sourcefile~orbital_mechanics_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node32" class="node">
<title>sourcefile~orbital_mechanics_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node32"><a xlink:href=".././sourcefile/orbital_mechanics_module.f90.html" xlink:title="orbital_mechanics_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="683.5,-608.4 507.5,-608.4 507.5,-584.4 683.5,-584.4 683.5,-608.4"/>
<text text-anchor="middle" x="595.5" y="-594" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">orbital_mechanics_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~orbital_mechanics_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~orbital_mechanics_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008,-638.4C937.75,-586.88 899.07,-635.84 812,-638.4"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-638.4C795.19,-638.83 718.4,-622.97 661.13,-610.62"/>
<polygon fill="#000000" stroke="#000000" points="661.55,-607.13 651.04,-608.43 660.07,-613.97 661.55,-607.13"/>
</g>
<!-- sourcefile~rk_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node33" class="node">
<title>sourcefile~rk_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node33"><a xlink:href=".././sourcefile/rk_module.f90.html" xlink:title="rk_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="640,-1088.4 551,-1088.4 551,-1064.4 640,-1064.4 640,-1088.4"/>
<text text-anchor="middle" x="595.5" y="-1074" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rk_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~rk_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~rk_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-1154.4C759.02,-1128.21 746.02,-1121.53 692,-1102.4 678.58,-1097.64 663.83,-1093.24 650.03,-1089.46"/>
<polygon fill="#000000" stroke="#000000" points="650.75,-1086.03 640.18,-1086.82 648.94,-1092.79 650.75,-1086.03"/>
</g>
<!-- sourcefile~conversion_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node34" class="node">
<title>sourcefile~conversion_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node34"><a xlink:href=".././sourcefile/conversion_module.f90.html" xlink:title="conversion_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="454.5,-593.4 317.5,-593.4 317.5,-569.4 454.5,-569.4 454.5,-593.4"/>
<text text-anchor="middle" x="386" y="-579" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">conversion_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~conversion_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~conversion_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-556.4C717.89,-533.6 691.23,-550.84 596.5,-556.4"/>
</g>
<!-- sourcefile~matrix_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node35" class="node">
<title>sourcefile~matrix_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node35"><a xlink:href=".././sourcefile/matrix_module.f90.html" xlink:title="matrix_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="442.5,-1114.4 329.5,-1114.4 329.5,-1090.4 442.5,-1090.4 442.5,-1114.4"/>
<text text-anchor="middle" x="386" y="-1100" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matrix_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~matrix_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~matrix_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008,-1306.4C943.57,-1325.17 947.65,-1247.71 894,-1207.4 859.31,-1181.33 850.6,-1174.22 812,-1154.4"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-1154.4C749.11,-1123.12 756.33,-1078.81 692,-1055.4 611.39,-1026.06 583.09,-1038.47 499,-1055.4 470.19,-1061.2 439.55,-1074.61 417.62,-1085.63"/>
<polygon fill="#000000" stroke="#000000" points="415.77,-1082.64 408.48,-1090.33 418.98,-1088.87 415.77,-1082.64"/>
</g>
<!-- sourcefile~standish_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node36" class="node">
<title>sourcefile~standish_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node36"><a xlink:href=".././sourcefile/standish_module.f90.html" xlink:title="standish_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="872.5,-1436.4 749.5,-1436.4 749.5,-1412.4 872.5,-1412.4 872.5,-1436.4"/>
<text text-anchor="middle" x="811" y="-1422" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">standish_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~standish_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~standish_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008,-1306.4C973.41,-1315.13 957.84,-1303.08 930,-1325.4 901.78,-1348.02 921.44,-1374.82 894,-1398.4 889.75,-1402.05 884.99,-1405.18 879.95,-1407.88"/>
<polygon fill="#000000" stroke="#000000" points="878.19,-1404.84 870.65,-1412.28 881.18,-1411.17 878.19,-1404.84"/>
</g>
<!-- sourcefile~analytical_ephemeris_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node37" class="node">
<title>sourcefile~analytical_ephemeris_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node37"><a xlink:href=".././sourcefile/analytical_ephemeris_module.f90.html" xlink:title="analytical_ephemeris_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="692,-528.4 499,-528.4 499,-504.4 692,-504.4 692,-528.4"/>
<text text-anchor="middle" x="595.5" y="-514" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">analytical_ephemeris_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~analytical_ephemeris_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~analytical_ephemeris_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008,-638.4C961.49,-604.29 947.8,-597.18 894,-576.4 859.01,-562.88 848.41,-565.41 812,-556.4"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-556.4C768.5,-546.13 721.89,-537.11 682.83,-530.25"/>
<polygon fill="#000000" stroke="#000000" points="683,-526.72 672.54,-528.46 681.8,-533.62 683,-526.72"/>
</g>
<!-- sourcefile~lambert_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node38" class="node">
<title>sourcefile~lambert_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node38"><a xlink:href=".././sourcefile/lambert_module.f90.html" xlink:title="lambert_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="656,-136.4 535,-136.4 535,-112.4 656,-112.4 656,-136.4"/>
<text text-anchor="middle" x="595.5" y="-122" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lambert_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~lambert_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~lambert_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-84.4C780.72,-83.04 708.25,-98.09 655.86,-110.11"/>
<polygon fill="#000000" stroke="#000000" points="654.95,-106.73 645.99,-112.39 656.53,-113.55 654.95,-106.73"/>
</g>
<!-- sourcefile~math_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node39" class="node">
<title>sourcefile~math_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node39"><a xlink:href=".././sourcefile/math_module.f90.html" xlink:title="math_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439,-1236.4 333,-1236.4 333,-1212.4 439,-1212.4 439,-1236.4"/>
<text text-anchor="middle" x="386" y="-1222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">math_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~math_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~math_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008,-1306.4C903.47,-1336.86 582.53,-1269.5 447.68,-1238.71"/>
<polygon fill="#000000" stroke="#000000" points="448.44,-1235.29 437.91,-1236.47 446.87,-1242.11 448.44,-1235.29"/>
</g>
<!-- sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node40" class="node">
<title>sourcefile~numbers_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node40"><a xlink:href=".././sourcefile/numbers_module.f90.html" xlink:title="numbers_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="268,-690.4 142,-690.4 142,-666.4 268,-666.4 268,-690.4"/>
<text text-anchor="middle" x="205" y="-676" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">numbers_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008,-638.4C978.27,-616.6 727.71,-730.27 692,-739.4 689.91,-739.93 389.12,-798.78 387,-798.4"/>
</g>
<!-- sourcefile~obliquity_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node41" class="node">
<title>sourcefile~obliquity_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node41"><a xlink:href=".././sourcefile/obliquity_module.f90.html" xlink:title="obliquity_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="873,-609.4 749,-609.4 749,-585.4 873,-585.4 873,-609.4"/>
<text text-anchor="middle" x="811" y="-595" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">obliquity_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~obliquity_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~obliquity_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008,-638.4C971.99,-612.61 923.27,-602.33 883.42,-598.52"/>
<polygon fill="#000000" stroke="#000000" points="883.49,-595.01 873.23,-597.66 882.9,-601.99 883.49,-595.01"/>
</g>
<!-- sourcefile~gooding_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node42" class="node">
<title>sourcefile~gooding_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node42"><a xlink:href=".././sourcefile/gooding_module.f90.html" xlink:title="gooding_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447,-62.4 325,-62.4 325,-38.4 447,-38.4 447,-62.4"/>
<text text-anchor="middle" x="386" y="-48" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gooding_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~gooding_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~gooding_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1218.21,-1079.39C1219,-1008.73 1216.53,-641.19 1088,-383.4 1007.3,-221.55 992.7,-91.82 812,-84.4"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-84.4C755.49,-61.71 749.37,-37.35 692,-23.4 608.65,-3.13 584.18,-13.27 499,-23.4 478.28,-25.86 455.85,-30.8 436.54,-35.78"/>
<polygon fill="#000000" stroke="#000000" points="435.52,-32.43 426.76,-38.39 437.32,-39.2 435.52,-32.43"/>
</g>
<!-- sourcefile~random_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node43" class="node">
<title>sourcefile~random_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node43"><a xlink:href=".././sourcefile/random_module.f90.html" xlink:title="random_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="446.5,-142.4 325.5,-142.4 325.5,-118.4 446.5,-118.4 446.5,-142.4"/>
<text text-anchor="middle" x="386" y="-128" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">random_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~random_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~random_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-84.4C671.67,-77.99 635.95,-82.87 499,-103.4 479.21,-106.36 457.79,-111.13 439.03,-115.84"/>
<polygon fill="#000000" stroke="#000000" points="438.02,-112.49 429.2,-118.37 439.76,-119.27 438.02,-112.49"/>
</g>
<!-- sourcefile~bplane_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~bplane_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M537.99,-964.06C485.14,-970.28 410.88,-981.66 387,-998.4"/>
</g>
<!-- sourcefile~bplane_module.f90&#45;&gt;sourcefile~vector_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~bplane_module.f90&#45;&gt;sourcefile~vector_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M559.31,-946.19C538.04,-936.86 512.51,-921.74 499,-899.4 439.99,-801.79 535.22,-475.67 463,-387.4 459.67,-383.33 455.63,-380.01 451.17,-377.3"/>
<polygon fill="#000000" stroke="#000000" points="452.66,-374.13 442.15,-372.83 449.55,-380.41 452.66,-374.13"/>
</g>
<!-- sourcefile~bplane_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~bplane_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M559.44,-970.4C514.79,-983.31 437.4,-997.37 387,-960.4"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-960.4C289.66,-890.46 232.64,-753.02 213.38,-699.99"/>
<polygon fill="#000000" stroke="#000000" points="216.67,-698.8 210.03,-690.55 210.07,-701.14 216.67,-698.8"/>
</g>
<!-- sourcefile~transformation_module.f90&#45;&gt;sourcefile~celestial_body_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~transformation_module.f90&#45;&gt;sourcefile~celestial_body_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008.43,-888.74C1009.56,-941.4 1006.49,-1149.17 894,-1249.4 889.99,-1252.97 606.04,-1303.63 464.89,-1328.64"/>
<polygon fill="#000000" stroke="#000000" points="464.22,-1325.2 454.98,-1330.39 465.44,-1332.09 464.22,-1325.2"/>
</g>
<!-- sourcefile~transformation_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~transformation_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M990.27,-888.48C968.53,-902.75 930.11,-926.21 894,-939.4 808.03,-970.79 782.76,-967.64 692,-979.4 658.33,-983.76 414.81,-978.91 387,-998.4"/>
</g>
<!-- sourcefile~transformation_module.f90&#45;&gt;sourcefile~time_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~transformation_module.f90&#45;&gt;sourcefile~time_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M929.87,-866.74C893.41,-864.67 849.82,-865.72 812,-876.4"/>
</g>
<!-- sourcefile~transformation_module.f90&#45;&gt;sourcefile~jpl_ephemeris_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~transformation_module.f90&#45;&gt;sourcefile~jpl_ephemeris_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M951.83,-888.43C928.87,-893.35 902.13,-899.08 878.23,-904.2"/>
<polygon fill="#000000" stroke="#000000" points="877.22,-900.84 868.17,-906.36 878.69,-907.69 877.22,-900.84"/>
</g>
<!-- sourcefile~transformation_module.f90&#45;&gt;sourcefile~ephemeris_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~transformation_module.f90&#45;&gt;sourcefile~ephemeris_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008.39,-888.61C1009.43,-942.74 1006.39,-1163.47 894,-1282.4 836.48,-1343.26 741.1,-1367.81 673.86,-1377.71"/>
<polygon fill="#000000" stroke="#000000" points="673.16,-1374.27 663.74,-1379.12 674.13,-1381.2 673.16,-1374.27"/>
</g>
<!-- sourcefile~transformation_module.f90&#45;&gt;sourcefile~iau_orientation_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~transformation_module.f90&#45;&gt;sourcefile~iau_orientation_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M989.15,-864.24C943.8,-834.91 825.14,-757.7 728,-690.4 711.78,-679.16 709.81,-672.9 692,-664.4 683.1,-660.15 673.4,-656.5 663.69,-653.39"/>
<polygon fill="#000000" stroke="#000000" points="664.6,-650.01 654.02,-650.46 662.58,-656.71 664.6,-650.01"/>
</g>
<!-- sourcefile~transformation_module.f90&#45;&gt;sourcefile~vector_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~transformation_module.f90&#45;&gt;sourcefile~vector_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1004.23,-864.08C993.25,-830.42 957.98,-736.36 894,-690.4 832.53,-646.24 781.53,-705.9 728,-652.4 677.37,-601.78 736.89,-551.16 692,-495.4 632.38,-421.33 522.52,-389.13 452.2,-375.61"/>
<polygon fill="#000000" stroke="#000000" points="452.59,-372.12 442.12,-373.74 451.32,-379 452.59,-372.12"/>
</g>
<!-- sourcefile~transformation_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~transformation_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M929.83,-866.65C917.83,-865.2 905.59,-863.74 894,-862.4 718.58,-842.08 673.69,-845.24 499,-819.4 448.9,-811.98 436.8,-807.63 387,-798.4"/>
</g>
<!-- sourcefile~transformation_module.f90&#45;&gt;sourcefile~obliquity_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~transformation_module.f90&#45;&gt;sourcefile~obliquity_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1006.07,-864.38C999.01,-824.24 970.79,-693.4 894,-624.4 889.5,-620.35 884.38,-616.91 878.95,-613.99"/>
<polygon fill="#000000" stroke="#000000" points="880.1,-610.66 869.57,-609.53 877.1,-616.98 880.1,-610.66"/>
</g>
<!-- sourcefile~celestial_body_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~celestial_body_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M346.34,-1330.32C334.25,-1326.24 320.95,-1321.43 309,-1316.4 261.74,-1296.49 251.8,-1241.34 206,-1264.4"/>
</g>
<!-- sourcefile~celestial_body_module.f90&#45;&gt;sourcefile~base_class_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~celestial_body_module.f90&#45;&gt;sourcefile~base_class_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M364.48,-1354.56C347.84,-1365.24 324.66,-1382.05 309,-1401.4 259.41,-1462.65 226.3,-1551.72 212.82,-1592.52"/>
<polygon fill="#000000" stroke="#000000" points="209.42,-1591.65 209.68,-1602.24 216.08,-1593.8 209.42,-1591.65"/>
</g>
<!-- sourcefile~celestial_body_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~celestial_body_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M327.16,-1330.32C320.27,-1326.8 313.94,-1322.26 309,-1316.4 227.78,-1220.09 209.79,-801.75 206.6,-700.51"/>
<polygon fill="#000000" stroke="#000000" points="210.1,-700.39 206.3,-690.5 203.1,-700.6 210.1,-700.39"/>
</g>
<!-- sourcefile~gravity_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~gravity_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M331.76,-1490.27C323.53,-1486.75 315.58,-1482.22 309,-1476.4 230.53,-1407 299.57,-1217.29 206,-1264.4"/>
</g>
<!-- sourcefile~gravity_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~gravity_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M360.98,-1490.37C343.55,-1480.3 321,-1464.24 309,-1443.4 289.84,-1410.1 222.34,-822.5 208.49,-700.47"/>
<polygon fill="#000000" stroke="#000000" points="211.96,-699.98 207.36,-690.44 205.01,-700.77 211.96,-699.98"/>
</g>
<!-- sourcefile~rk_module_variable_step.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~rk_module_variable_step.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M807.5,-504.38C799.06,-467.26 767.77,-354.32 692,-310.4 636.44,-278.19 234.74,-303.44 206,-326.4"/>
</g>
<!-- sourcefile~rk_module_variable_step.f90&#45;&gt;sourcefile~brent_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~rk_module_variable_step.f90&#45;&gt;sourcefile~brent_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M803.53,-504C788.41,-476.54 747.74,-411.08 692,-386.4 613.57,-351.66 584.37,-378.09 499,-386.4 482.1,-388.04 463.96,-391.05 447.3,-394.33"/>
<polygon fill="#000000" stroke="#000000" points="446.25,-390.97 437.15,-396.39 447.65,-397.83 446.25,-390.97"/>
</g>
<!-- sourcefile~rk_module_variable_step.f90&#45;&gt;sourcefile~orbital_mechanics_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~rk_module_variable_step.f90&#45;&gt;sourcefile~orbital_mechanics_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M762.01,-528.48C750.55,-532.21 738.58,-536.84 728,-542.4 710.06,-551.83 710.13,-561.33 692,-570.4 683.5,-574.64 674.22,-578.27 664.89,-581.34"/>
<polygon fill="#000000" stroke="#000000" points="663.69,-578.05 655.18,-584.35 665.76,-584.73 663.69,-578.05"/>
</g>
<!-- sourcefile~rk_module_variable_step.f90&#45;&gt;sourcefile~conversion_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~rk_module_variable_step.f90&#45;&gt;sourcefile~conversion_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M764.19,-528.46C721.24,-538.94 655.04,-552.96 596.5,-556.4"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-556.4C551.44,-558.92 503.63,-564.49 464.76,-569.74"/>
<polygon fill="#000000" stroke="#000000" points="464,-566.31 454.56,-571.13 464.95,-573.24 464,-566.31"/>
</g>
<!-- sourcefile~rk_module_variable_step.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~rk_module_variable_step.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M775.43,-504.38C689.17,-476.68 460.49,-417.56 309,-510.4 254.04,-544.07 224.19,-619.17 212.26,-656.49"/>
<polygon fill="#000000" stroke="#000000" points="208.82,-655.77 209.24,-666.35 215.51,-657.81 208.82,-655.77"/>
</g>
<!-- sourcefile~geodesy_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~geodesy_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M335.93,-1410.29C326.5,-1406.7 317.06,-1402.14 309,-1396.4 248.39,-1353.23 272.47,-1230.94 206,-1264.4"/>
</g>
<!-- sourcefile~geodesy_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~geodesy_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M326.69,-1410.21C319.96,-1406.7 313.8,-1402.19 309,-1396.4 286.07,-1368.71 222.08,-818.98 208.54,-700.69"/>
<polygon fill="#000000" stroke="#000000" points="212,-700.16 207.39,-690.63 205.04,-700.96 212,-700.16"/>
</g>
<!-- sourcefile~crtbp_module.f90&#45;&gt;sourcefile~celestial_body_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~crtbp_module.f90&#45;&gt;sourcefile~celestial_body_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M542.26,-1458.31C527.07,-1454.5 511.28,-1448.35 499,-1438.4 471.81,-1416.38 489.47,-1391.27 463,-1368.4 458.78,-1364.75 454.02,-1361.61 449,-1358.9"/>
<polygon fill="#000000" stroke="#000000" points="450.26,-1355.63 439.73,-1354.49 447.25,-1361.95 450.26,-1355.63"/>
</g>
<!-- sourcefile~crtbp_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~crtbp_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M542.36,-1474.29C481.46,-1482.94 380.01,-1488.02 309,-1443.4 231.28,-1394.56 287.98,-1223.13 206,-1264.4"/>
</g>
<!-- sourcefile~crtbp_module.f90&#45;&gt;sourcefile~math_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~crtbp_module.f90&#45;&gt;sourcefile~math_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M542.18,-1460.38C526.45,-1456.71 510.37,-1450.11 499,-1438.4 451.26,-1389.19 499.02,-1346.73 463,-1288.4 451.38,-1269.57 432.32,-1253.55 416.2,-1242.24"/>
<polygon fill="#000000" stroke="#000000" points="417.87,-1239.14 407.62,-1236.46 413.96,-1244.95 417.87,-1239.14"/>
</g>
<!-- sourcefile~crtbp_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~crtbp_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M542.12,-1459.83C526.57,-1456.12 510.61,-1449.63 499,-1438.4 459.91,-1400.56 498.27,-1362.82 463,-1321.4 413.51,-1263.29 354.95,-1306.34 309,-1245.4 242.01,-1156.54 213.67,-793.96 207.39,-700.47"/>
<polygon fill="#000000" stroke="#000000" points="210.88,-700.19 206.73,-690.44 203.9,-700.65 210.88,-700.19"/>
</g>
<!-- sourcefile~minpack_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~minpack_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M334.07,-1194.45C325.57,-1197.03 316.94,-1200.02 309,-1203.4 260.04,-1224.22 253.52,-1240.47 206,-1264.4"/>
</g>
<!-- sourcefile~minpack_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~minpack_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M361.89,-1170.25C344.7,-1160.02 322.05,-1143.8 309,-1123.4 218.33,-981.65 207.2,-769.16 206.05,-700.58"/>
<polygon fill="#000000" stroke="#000000" points="209.55,-700.46 205.94,-690.5 202.55,-700.54 209.55,-700.46"/>
</g>
<!-- sourcefile~c_interface_module.f90&#45;&gt;sourcefile~geopotential_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~c_interface_module.f90&#45;&gt;sourcefile~geopotential_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1003.55,-392.23C991.35,-360.72 954.24,-275.99 894,-234.4 830.27,-190.39 742.32,-174.47 678.59,-168.91"/>
<polygon fill="#000000" stroke="#000000" points="678.82,-165.41 668.58,-168.1 678.26,-172.39 678.82,-165.41"/>
</g>
<!-- sourcefile~drag_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~drag_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M153.33,-1645.51C147.43,-1642.85 141.81,-1639.53 137,-1635.4 88.92,-1594.07 65.41,-1519.41 56.26,-1482.41"/>
<polygon fill="#000000" stroke="#000000" points="59.66,-1481.55 53.97,-1472.62 52.84,-1483.15 59.66,-1481.55"/>
</g>
<!-- sourcefile~time_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~time_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M571.46,-890.52C551.44,-901.53 522.1,-918.86 499,-937.4 481.11,-951.76 482.53,-962.35 463,-974.4 432.85,-992.99 416.01,-978.07 387,-998.4"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-998.4C344.04,-1027.1 338.35,-1040.89 309,-1081.4 254.24,-1156.97 289.57,-1222.83 206,-1264.4"/>
</g>
<!-- sourcefile~time_module.f90&#45;&gt;sourcefile~conversion_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~time_module.f90&#45;&gt;sourcefile~conversion_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M561.55,-866.29C540.37,-856.78 514.08,-841.43 499,-819.4 449.24,-746.66 514.15,-696.16 463,-624.4 455.01,-613.18 443.12,-604.51 431.1,-597.99"/>
<polygon fill="#000000" stroke="#000000" points="432.46,-594.76 421.95,-593.42 429.33,-601.02 432.46,-594.76"/>
</g>
<!-- sourcefile~relative_motion_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~relative_motion_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M563.52,-810.54C505.38,-834.84 379.45,-894.93 309,-984.4 226.97,-1088.57 324.72,-1205.35 206,-1264.4"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M204,-1264.4C128.56,-1301.87 79.44,-1396.32 60.41,-1438.94"/>
<polygon fill="#000000" stroke="#000000" points="57.09,-1437.8 56.32,-1448.37 63.51,-1440.59 57.09,-1437.8"/>
</g>
<!-- sourcefile~relative_motion_module.f90&#45;&gt;sourcefile~vector_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~relative_motion_module.f90&#45;&gt;sourcefile~vector_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M560.02,-786.26C538.76,-776.88 512.97,-761.69 499,-739.4 457.26,-672.76 513.75,-447.46 463,-387.4 459.75,-383.55 455.86,-380.37 451.58,-377.75"/>
<polygon fill="#000000" stroke="#000000" points="452.86,-374.48 442.35,-373.13 449.72,-380.74 452.86,-374.48"/>
</g>
<!-- sourcefile~relative_motion_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~relative_motion_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M514.55,-805.22C475.74,-806.81 428.61,-806.17 387,-798.4"/>
</g>
<!-- sourcefile~halo_orbit_module.f90&#45;&gt;sourcefile~celestial_body_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~halo_orbit_module.f90&#45;&gt;sourcefile~celestial_body_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M765.13,-1240.49C686.9,-1261.57 525.83,-1304.98 441.39,-1327.74"/>
<polygon fill="#000000" stroke="#000000" points="440.47,-1324.36 431.73,-1330.34 442.29,-1331.12 440.47,-1324.36"/>
</g>
<!-- sourcefile~halo_orbit_module.f90&#45;&gt;sourcefile~crtbp_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~halo_orbit_module.f90&#45;&gt;sourcefile~crtbp_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M804.3,-1240.41C789.36,-1270.94 746.45,-1352.79 692,-1405.4 674.29,-1422.5 650.81,-1437.09 631.56,-1447.48"/>
<polygon fill="#000000" stroke="#000000" points="629.72,-1444.5 622.49,-1452.24 632.97,-1450.69 629.72,-1444.5"/>
</g>
<!-- sourcefile~halo_orbit_module.f90&#45;&gt;sourcefile~minpack_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~halo_orbit_module.f90&#45;&gt;sourcefile~minpack_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M744.53,-1231.34C702.25,-1232.66 646.08,-1233.35 596.5,-1230.4"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-1230.4C565.17,-1228.65 492.3,-1210.58 441.25,-1197.12"/>
<polygon fill="#000000" stroke="#000000" points="441.91,-1193.67 431.35,-1194.5 440.12,-1200.44 441.91,-1193.67"/>
</g>
<!-- sourcefile~halo_orbit_module.f90&#45;&gt;sourcefile~rk_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~halo_orbit_module.f90&#45;&gt;sourcefile~rk_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M788.43,-1216.29C770.59,-1205.48 745.43,-1188.3 728,-1168.4 705.99,-1143.26 718.22,-1123.11 692,-1102.4 680.06,-1092.96 664.95,-1086.94 650.3,-1083.11"/>
<polygon fill="#000000" stroke="#000000" points="650.8,-1079.63 640.27,-1080.78 649.22,-1086.45 650.8,-1079.63"/>
</g>
<!-- sourcefile~halo_orbit_module.f90&#45;&gt;sourcefile~matrix_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~halo_orbit_module.f90&#45;&gt;sourcefile~matrix_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-1116.4C548.75,-1101.23 494.29,-1098.07 452.64,-1098.53"/>
<polygon fill="#000000" stroke="#000000" points="452.55,-1095.03 442.62,-1098.71 452.68,-1102.03 452.55,-1095.03"/>
</g>
<!-- sourcefile~halo_orbit_module.f90&#45;&gt;sourcefile~math_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~halo_orbit_module.f90&#45;&gt;sourcefile~math_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-1230.4C545.75,-1227.49 490.46,-1225.98 449.23,-1225.2"/>
<polygon fill="#000000" stroke="#000000" points="449.12,-1221.7 439.06,-1225.02 448.99,-1228.7 449.12,-1221.7"/>
</g>
<!-- sourcefile~halo_orbit_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~halo_orbit_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M792.06,-1216.37C756.44,-1193.09 673.58,-1141.95 596.5,-1116.4"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-1116.4C553.42,-1102.78 539.1,-1113.67 499,-1097.4 452.39,-1078.48 340.06,-1013.96 309,-974.4 241.07,-887.87 216.2,-753.41 208.74,-700.68"/>
<polygon fill="#000000" stroke="#000000" points="212.16,-699.89 207.37,-690.45 205.23,-700.82 212.16,-699.89"/>
</g>
<!-- sourcefile~kepler_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~kepler_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.08,-708.37C525.43,-704.56 511.24,-699.38 499,-692.4 479.62,-681.34 482.5,-668.25 463,-657.4 432.58,-640.46 416.63,-656.68 387,-638.4"/>
</g>
<!-- sourcefile~kepler_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~kepler_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M543.4,-730.45C528.88,-734.38 513.17,-739.1 499,-744.4 447.23,-763.74 441.32,-808.54 387,-798.4"/>
</g>
<!-- sourcefile~newton_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node44" class="node">
<title>sourcefile~newton_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node44"><a xlink:href=".././sourcefile/newton_module.f90.html" xlink:title="newton_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="445,-690.4 327,-690.4 327,-666.4 445,-666.4 445,-690.4"/>
<text text-anchor="middle" x="386" y="-676" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newton_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~kepler_module.f90&#45;&gt;sourcefile~newton_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~kepler_module.f90&#45;&gt;sourcefile~newton_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.44,-707.78C513.56,-702.79 482.46,-696.8 455.11,-691.53"/>
<polygon fill="#000000" stroke="#000000" points="455.71,-688.08 445.23,-689.62 454.38,-694.95 455.71,-688.08"/>
</g>
<!-- sourcefile~eispack_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~eispack_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M326.34,-259.55C320.4,-261.26 314.53,-263.2 309,-265.4 259.54,-285 247.56,-293.18 206,-326.4"/>
</g>
<!-- sourcefile~eispack_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~eispack_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M328.4,-260.51C321.15,-264.03 314.39,-268.55 309,-274.4 256,-331.82 219.13,-579.77 208.89,-656.01"/>
<polygon fill="#000000" stroke="#000000" points="205.36,-655.97 207.52,-666.34 212.3,-656.89 205.36,-655.97"/>
</g>
<!-- sourcefile~brent_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~brent_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M334.07,-396.34C325.57,-393.76 316.94,-390.77 309,-387.4 260.04,-366.57 247.56,-293.18 206,-326.4"/>
</g>
<!-- sourcefile~brent_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~brent_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M366.57,-420.61C349.92,-432.36 325.55,-451.39 309,-472.4 261.85,-532.24 227.83,-617.11 213.51,-656.61"/>
<polygon fill="#000000" stroke="#000000" points="210.13,-655.68 210.08,-666.28 216.72,-658.03 210.13,-655.68"/>
</g>
<!-- sourcefile~jpl_ephemeris_module.f90&#45;&gt;sourcefile~celestial_body_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~jpl_ephemeris_module.f90&#45;&gt;sourcefile~celestial_body_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M806.34,-930.43C795.04,-965.78 757.42,-1070.54 692,-1130.4 622.72,-1193.79 574.79,-1160.94 499,-1216.4 457.62,-1246.67 420.42,-1294.52 401.06,-1321.71"/>
<polygon fill="#000000" stroke="#000000" points="398.07,-1319.88 395.2,-1330.08 403.8,-1323.9 398.07,-1319.88"/>
</g>
<!-- sourcefile~jpl_ephemeris_module.f90&#45;&gt;sourcefile~time_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~jpl_ephemeris_module.f90&#45;&gt;sourcefile~time_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M745.94,-906.39C717.83,-901.13 684.98,-894.97 657.26,-889.78"/>
<polygon fill="#000000" stroke="#000000" points="657.77,-886.31 647.29,-887.91 656.48,-893.19 657.77,-886.31"/>
</g>
<!-- sourcefile~jpl_ephemeris_module.f90&#45;&gt;sourcefile~ephemeris_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~jpl_ephemeris_module.f90&#45;&gt;sourcefile~ephemeris_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M805.47,-930.4C792.93,-963.67 756.78,-1059.93 728,-1140.4 711.53,-1186.45 713.97,-1200.7 692,-1244.4 669.08,-1289.97 633.39,-1338.04 612.75,-1364.31"/>
<polygon fill="#000000" stroke="#000000" points="609.85,-1362.34 606.37,-1372.35 615.33,-1366.7 609.85,-1362.34"/>
</g>
<!-- sourcefile~jpl_ephemeris_module.f90&#45;&gt;sourcefile~conversion_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~jpl_ephemeris_module.f90&#45;&gt;sourcefile~conversion_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M803.62,-906.1C779.74,-860.15 696.78,-700.94 692,-697.4 621.74,-645.37 576.43,-699.99 499,-659.4 479.24,-649.03 480.86,-637.78 463,-624.4 449.99,-614.65 434.54,-605.52 420.98,-598.2"/>
<polygon fill="#000000" stroke="#000000" points="422.43,-595.01 411.95,-593.44 419.16,-601.2 422.43,-595.01"/>
</g>
<!-- sourcefile~jpl_ephemeris_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~jpl_ephemeris_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M733.97,-927.38C668.98,-931.94 574.32,-931.01 499,-899.4 437.2,-873.45 452.89,-810.7 387,-798.4"/>
</g>
<!-- sourcefile~geopotential_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~geopotential_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M522.11,-175.98C481.63,-182.59 430.68,-193 387,-208.4"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-208.4C352.16,-219.97 339.47,-210.54 309,-227.4 253.44,-258.13 255.6,-286.76 206,-326.4"/>
</g>
<!-- sourcefile~geopotential_module.f90&#45;&gt;sourcefile~vector_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~geopotential_module.f90&#45;&gt;sourcefile~vector_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M522.1,-173.6C513.61,-176.85 505.63,-181.32 499,-187.4 459.52,-223.59 492.67,-257.81 463,-302.4 450.66,-320.93 431.44,-337.05 415.42,-348.47"/>
<polygon fill="#000000" stroke="#000000" points="413.17,-345.77 406.91,-354.32 417.13,-351.54 413.17,-345.77"/>
</g>
<!-- sourcefile~geopotential_module.f90&#45;&gt;sourcefile~conversion_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~geopotential_module.f90&#45;&gt;sourcefile~conversion_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M522.3,-171.83C513.46,-175.31 505.33,-180.3 499,-187.4 446.81,-245.91 505.91,-472.77 463,-538.4 455.6,-549.72 444.12,-558.38 432.3,-564.85"/>
<polygon fill="#000000" stroke="#000000" points="430.64,-561.76 423.27,-569.38 433.78,-568.02 430.64,-561.76"/>
</g>
<!-- sourcefile~geopotential_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~geopotential_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M522.22,-174.49C513.82,-177.61 505.83,-181.8 499,-187.4 468.22,-212.63 490.51,-240.63 463,-269.4 410.25,-324.56 358.53,-287.32 309,-345.4 228.19,-440.14 210.74,-597.74 207.01,-655.92"/>
<polygon fill="#000000" stroke="#000000" points="203.5,-656 206.43,-666.18 210.49,-656.39 203.5,-656"/>
</g>
<!-- sourcefile~geopotential_module.f90&#45;&gt;sourcefile~random_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~geopotential_module.f90&#45;&gt;sourcefile~random_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M525.12,-154.36C503.05,-150.53 478.64,-146.3 456.56,-142.46"/>
<polygon fill="#000000" stroke="#000000" points="457.05,-139 446.6,-140.74 455.85,-145.89 457.05,-139"/>
</g>
<!-- sourcefile~ephemeris_module.f90&#45;&gt;sourcefile~celestial_body_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~ephemeris_module.f90&#45;&gt;sourcefile~celestial_body_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M535.04,-1372.36C510.51,-1367.4 481.92,-1361.61 456.44,-1356.45"/>
<polygon fill="#000000" stroke="#000000" points="456.97,-1352.99 446.47,-1354.43 455.58,-1359.85 456.97,-1352.99"/>
</g>
<!-- sourcefile~ephemeris_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~ephemeris_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M573.27,-1372.35C547.79,-1358.34 503.44,-1335.36 463,-1321.4 352.41,-1283.2 310.49,-1211.77 206,-1264.4"/>
</g>
<!-- sourcefile~iau_orientation_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~iau_orientation_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515.83,-646.75C466.38,-650.43 408.08,-651.4 387,-638.4"/>
</g>
<!-- sourcefile~iau_orientation_module.f90&#45;&gt;sourcefile~vector_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~iau_orientation_module.f90&#45;&gt;sourcefile~vector_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515.65,-629.57C509.46,-626.45 503.77,-622.47 499,-617.4 428.11,-542.03 531.86,-464.62 463,-387.4 459.65,-383.63 455.69,-380.52 451.36,-377.95"/>
<polygon fill="#000000" stroke="#000000" points="452.57,-374.64 442.05,-373.38 449.49,-380.93 452.57,-374.64"/>
</g>
<!-- sourcefile~iau_orientation_module.f90&#45;&gt;sourcefile~conversion_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~iau_orientation_module.f90&#45;&gt;sourcefile~conversion_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M535.7,-626.38C523.52,-623.64 510.8,-620.58 499,-617.4 476.46,-611.31 451.72,-603.48 431.24,-596.68"/>
<polygon fill="#000000" stroke="#000000" points="432.15,-593.3 421.56,-593.44 429.93,-599.93 432.15,-593.3"/>
</g>
<!-- sourcefile~iau_orientation_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~iau_orientation_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M572.53,-650.45C552.69,-661.69 523.01,-679.39 499,-697.4 445.38,-737.62 452.89,-810.7 387,-798.4"/>
</g>
<!-- sourcefile~vector_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~vector_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M345.85,-354.3C296.53,-339.58 216.88,-317.7 206,-326.4"/>
</g>
<!-- sourcefile~vector_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~vector_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M329.75,-374.78C322.13,-377.81 314.91,-381.89 309,-387.4 229.2,-461.75 211.18,-601.81 207.15,-656.1"/>
<polygon fill="#000000" stroke="#000000" points="203.64,-656.12 206.48,-666.33 210.63,-656.58 203.64,-656.12"/>
</g>
<!-- sourcefile~modified_equinoctial_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~modified_equinoctial_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M566.18,-32.36C510.96,-10.97 387.45,26.43 309,-29.4 195.17,-110.4 315.14,-239.18 206,-326.4"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M204,-326.4C113.19,-398.82 61.02,-1285.53 52.68,-1438.11"/>
<polygon fill="#000000" stroke="#000000" points="49.18,-1437.99 52.14,-1448.17 56.17,-1438.37 49.18,-1437.99"/>
</g>
<!-- sourcefile~modified_equinoctial_module.f90&#45;&gt;sourcefile~vector_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~modified_equinoctial_module.f90&#45;&gt;sourcefile~vector_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M562.23,-56.45C541.07,-66.01 514.53,-81.44 499,-103.4 455.41,-165.04 495.09,-201.06 463,-269.4 448.91,-299.39 424.06,-328.59 406.61,-346.99"/>
<polygon fill="#000000" stroke="#000000" points="404.09,-344.56 399.65,-354.18 409.12,-349.43 404.09,-344.56"/>
</g>
<!-- sourcefile~modified_equinoctial_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~modified_equinoctial_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M538.05,-56.42C455.97,-74.01 312.95,-105.16 309,-109.4 273.56,-147.38 282.05,-289.24 273,-340.4 251.84,-459.99 222.1,-602.46 210.7,-656.32"/>
<polygon fill="#000000" stroke="#000000" points="207.27,-655.64 208.62,-666.15 214.12,-657.1 207.27,-655.64"/>
</g>
<!-- sourcefile~complex_step.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~complex_step.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M157.14,-1724.34C149.7,-1720.8 142.62,-1716.25 137,-1710.4 74.06,-1644.84 57.33,-1531.02 52.98,-1482.9"/>
<polygon fill="#000000" stroke="#000000" points="56.45,-1482.34 52.16,-1472.66 49.47,-1482.91 56.45,-1482.34"/>
</g>
<!-- sourcefile~geometry_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~geometry_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M530.46,-197.61C488.47,-193.12 433.04,-192.17 387,-208.4"/>
</g>
<!-- sourcefile~geometry_module.f90&#45;&gt;sourcefile~vector_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~geometry_module.f90&#45;&gt;sourcefile~vector_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M578.56,-220.53C542.43,-248.05 454.09,-315.31 411.18,-347.98"/>
<polygon fill="#000000" stroke="#000000" points="408.83,-345.38 402.99,-354.22 413.07,-350.95 408.83,-345.38"/>
</g>
<!-- sourcefile~orbital_mechanics_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~orbital_mechanics_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.77,-608.42C479.41,-621.53 390.3,-640.43 387,-638.4"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-638.4C353.19,-618.77 334.28,-629.93 309,-602.4 220.44,-505.96 308.28,-244.66 206,-326.4"/>
</g>
<!-- sourcefile~orbital_mechanics_module.f90&#45;&gt;sourcefile~vector_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~orbital_mechanics_module.f90&#45;&gt;sourcefile~vector_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M562.38,-584.23C541.29,-574.63 514.77,-559.18 499,-537.4 458.8,-481.86 510.65,-436.69 463,-387.4 459.55,-383.83 455.56,-380.85 451.25,-378.37"/>
<polygon fill="#000000" stroke="#000000" points="452.54,-375.11 442.01,-373.94 449.51,-381.42 452.54,-375.11"/>
</g>
<!-- sourcefile~orbital_mechanics_module.f90&#45;&gt;sourcefile~math_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~orbital_mechanics_module.f90&#45;&gt;sourcefile~math_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M508.7,-608.67C505.14,-611.15 501.87,-614.04 499,-617.4 414.17,-716.52 545.17,-1102.05 463,-1203.4 458.98,-1208.35 453.91,-1212.2 448.3,-1215.17"/>
<polygon fill="#000000" stroke="#000000" points="446.89,-1211.97 439.12,-1219.17 449.68,-1218.39 446.89,-1211.97"/>
</g>
<!-- sourcefile~orbital_mechanics_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~orbital_mechanics_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M512.75,-608.58C507.84,-611.04 503.2,-613.95 499,-617.4 468.22,-642.63 483.27,-665.14 463,-699.4 434.76,-747.14 441.53,-808.58 387,-798.4"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-798.4C317.14,-785.72 254.11,-728.98 224.2,-698.28"/>
<polygon fill="#000000" stroke="#000000" points="226.43,-695.54 217,-690.72 221.37,-700.37 226.43,-695.54"/>
</g>
<!-- sourcefile~rk_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~rk_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M550.91,-1085.7C534.33,-1089.9 515.48,-1095.49 499,-1102.4 481.92,-1109.56 480.17,-1116.44 463,-1123.4 397.66,-1149.87 370.4,-1126.76 309,-1161.4 252.61,-1193.21 263.97,-1235.57 206,-1264.4"/>
</g>
<!-- sourcefile~rk_module.f90&#45;&gt;sourcefile~brent_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~rk_module.f90&#45;&gt;sourcefile~brent_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M576.23,-1064.15C553.59,-1047.82 515.94,-1016.61 499,-979.4 412.4,-789.12 536.35,-706.16 463,-510.4 450.81,-477.86 424.9,-446.79 406.74,-427.68"/>
<polygon fill="#000000" stroke="#000000" points="409.21,-425.2 399.73,-420.48 404.2,-430.09 409.21,-425.2"/>
</g>
<!-- sourcefile~rk_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~rk_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M580.43,-1064.35C557.32,-1045.09 509.23,-1007.2 463,-984.4 431.23,-968.73 415.56,-981.35 387,-960.4"/>
</g>
<!-- sourcefile~conversion_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~conversion_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M354.36,-569.29C339.22,-562.1 321.56,-551.77 309,-538.4 237.28,-462.04 287.83,-261 206,-326.4"/>
</g>
<!-- sourcefile~conversion_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~conversion_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M362.69,-593.48C331.12,-610.59 273.25,-641.95 237.37,-661.4"/>
<polygon fill="#000000" stroke="#000000" points="235.43,-658.47 228.31,-666.31 238.77,-664.62 235.43,-658.47"/>
</g>
<!-- sourcefile~matrix_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~matrix_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M335.86,-1114.42C326.44,-1118.01 317.02,-1122.59 309,-1128.4 247.56,-1172.83 273.73,-1230.3 206,-1264.4"/>
</g>
<!-- sourcefile~matrix_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~matrix_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M329.18,-1090.63C321.64,-1087.07 314.59,-1082.43 309,-1076.4 256.75,-1019.99 219.5,-776.65 209,-700.95"/>
<polygon fill="#000000" stroke="#000000" points="212.42,-700.11 207.6,-690.67 205.48,-701.05 212.42,-700.11"/>
</g>
<!-- sourcefile~standish_module.f90&#45;&gt;sourcefile~celestial_body_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~standish_module.f90&#45;&gt;sourcefile~celestial_body_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M796.13,-1436.56C762.28,-1464.7 672.66,-1530.01 596.5,-1504.4"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-1504.4C553.48,-1490.6 531.12,-1514.4 499,-1485.4 458.62,-1448.94 500.87,-1407.46 463,-1368.4 459.75,-1365.04 456.04,-1362.11 452.06,-1359.57"/>
<polygon fill="#000000" stroke="#000000" points="453.41,-1356.32 442.96,-1354.57 450.04,-1362.46 453.41,-1356.32"/>
</g>
<!-- sourcefile~standish_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge134" class="edge">
<title>sourcefile~standish_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-1542.4C467.63,-1551.05 411.8,-1598.25 309,-1523.4 208.86,-1450.48 316.94,-1209.28 206,-1264.4"/>
</g>
<!-- sourcefile~standish_module.f90&#45;&gt;sourcefile~time_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~standish_module.f90&#45;&gt;sourcefile~time_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M749.2,-1414.35C741.03,-1410.57 733.57,-1405.41 728,-1398.4 664.12,-1317.91 745.5,-1025.12 692,-937.4 680.23,-918.09 659.51,-904.17 640.38,-894.71"/>
<polygon fill="#000000" stroke="#000000" points="641.7,-891.47 631.16,-890.42 638.75,-897.81 641.7,-891.47"/>
</g>
<!-- sourcefile~standish_module.f90&#45;&gt;sourcefile~ephemeris_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~standish_module.f90&#45;&gt;sourcefile~ephemeris_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M749.39,-1413.04C724.9,-1408.45 696.4,-1403.11 670.69,-1398.3"/>
<polygon fill="#000000" stroke="#000000" points="671.09,-1394.81 660.62,-1396.41 669.8,-1401.69 671.09,-1394.81"/>
</g>
<!-- sourcefile~standish_module.f90&#45;&gt;sourcefile~base_class_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge135" class="edge">
<title>sourcefile~standish_module.f90&#45;&gt;sourcefile~base_class_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M803.36,-1436.51C787.88,-1463.41 746.53,-1528 692,-1556.4 560.84,-1624.69 383.42,-1626.94 283.24,-1621.37"/>
<polygon fill="#000000" stroke="#000000" points="283.39,-1617.87 273.2,-1620.77 282.97,-1624.86 283.39,-1617.87"/>
</g>
<!-- sourcefile~standish_module.f90&#45;&gt;sourcefile~conversion_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~standish_module.f90&#45;&gt;sourcefile~conversion_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M749.37,-1429.8C668.79,-1435.52 532.64,-1439.55 499,-1405.4 438.03,-1343.51 508.48,-698.41 463,-624.4 456.11,-613.18 445.16,-604.63 433.69,-598.23"/>
<polygon fill="#000000" stroke="#000000" points="434.95,-594.94 424.44,-593.54 431.78,-601.18 434.95,-594.94"/>
</g>
<!-- sourcefile~standish_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge133" class="edge">
<title>sourcefile~standish_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M798.47,-1436.47C778.63,-1456.53 735.9,-1496.68 692,-1518.4 652.77,-1537.8 640.16,-1539.42 596.5,-1542.4"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-1542.4C550.84,-1545.37 530.74,-1548.52 499,-1518.4 459.54,-1480.94 502.54,-1438.76 463,-1401.4 411.76,-1352.98 356.49,-1415.5 309,-1363.4 262.99,-1312.91 217.52,-812.5 207.87,-700.54"/>
<polygon fill="#000000" stroke="#000000" points="211.34,-700.08 207,-690.41 204.37,-700.68 211.34,-700.08"/>
</g>
<!-- sourcefile~analytical_ephemeris_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge136" class="edge">
<title>sourcefile~analytical_ephemeris_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M498.94,-523.27C463.75,-524.97 423.56,-525.91 387,-524.4"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-524.4C341.45,-522.59 339.26,-493.77 309,-462.4 256.36,-407.82 265.23,-279.06 206,-326.4"/>
</g>
<!-- sourcefile~analytical_ephemeris_module.f90&#45;&gt;sourcefile~conversion_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge138" class="edge">
<title>sourcefile~analytical_ephemeris_module.f90&#45;&gt;sourcefile~conversion_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M547.68,-528.45C532.13,-532.64 514.76,-537.51 499,-542.4 475.74,-549.6 450.07,-558.47 429.17,-565.93"/>
<polygon fill="#000000" stroke="#000000" points="427.87,-562.69 419.64,-569.36 430.23,-569.27 427.87,-562.69"/>
</g>
<!-- sourcefile~analytical_ephemeris_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge137" class="edge">
<title>sourcefile~analytical_ephemeris_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-524.4C304.08,-521.04 241.45,-614.58 217.08,-657.46"/>
<polygon fill="#000000" stroke="#000000" points="213.99,-655.81 212.21,-666.26 220.11,-659.2 213.99,-655.81"/>
</g>
<!-- sourcefile~lambert_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge141" class="edge">
<title>sourcefile~lambert_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M537.55,-136.43C477.18,-149.27 390.08,-168.09 387,-170.4"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-170.4C356.67,-191.66 338.09,-174.19 309,-194.4 247.88,-236.84 264.13,-279.94 206,-326.4"/>
</g>
<!-- sourcefile~lambert_module.f90&#45;&gt;sourcefile~vector_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge139" class="edge">
<title>sourcefile~lambert_module.f90&#45;&gt;sourcefile~vector_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M534.71,-127.49C521.63,-130.72 508.79,-136.23 499,-145.4 457.1,-184.61 489.17,-218.32 463,-269.4 447.87,-298.92 423.19,-328.26 406.07,-346.81"/>
<polygon fill="#000000" stroke="#000000" points="403.33,-344.62 399.03,-354.31 408.43,-349.42 403.33,-344.62"/>
</g>
<!-- sourcefile~lambert_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge140" class="edge">
<title>sourcefile~lambert_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-170.4C351.23,-195.74 331.99,-191.98 309,-227.4 284.96,-264.42 226.24,-570.51 210.14,-656.19"/>
<polygon fill="#000000" stroke="#000000" points="206.68,-655.67 208.28,-666.14 213.56,-656.96 206.68,-655.67"/>
</g>
<!-- sourcefile~lambert_module.f90&#45;&gt;sourcefile~gooding_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge142" class="edge">
<title>sourcefile~lambert_module.f90&#45;&gt;sourcefile~gooding_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M560.7,-112.34C525.13,-99.66 469.02,-79.65 430.25,-65.82"/>
<polygon fill="#000000" stroke="#000000" points="431.38,-62.51 420.79,-62.44 429.03,-69.1 431.38,-62.51"/>
</g>
<!-- sourcefile~lambert_module.f90&#45;&gt;sourcefile~random_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge143" class="edge">
<title>sourcefile~lambert_module.f90&#45;&gt;sourcefile~random_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M534.76,-126.12C510.45,-126.83 482.19,-127.64 456.93,-128.37"/>
<polygon fill="#000000" stroke="#000000" points="456.57,-124.88 446.68,-128.67 456.77,-131.88 456.57,-124.88"/>
</g>
<!-- sourcefile~math_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge144" class="edge">
<title>sourcefile~math_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M332.97,-1229.19C295.98,-1234.2 245.96,-1244.28 206,-1264.4"/>
</g>
<!-- sourcefile~math_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge145" class="edge">
<title>sourcefile~math_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M332.87,-1218.24C323.9,-1215.04 315.42,-1210.32 309,-1203.4 239.22,-1128.11 213.15,-791.41 207.33,-700.87"/>
<polygon fill="#000000" stroke="#000000" points="210.81,-700.41 206.7,-690.65 203.82,-700.85 210.81,-700.41"/>
</g>
<!-- sourcefile~numbers_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge146" class="edge">
<title>sourcefile~numbers_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M201.6,-690.68C184.31,-779.34 78.63,-1321.28 55.83,-1438.18"/>
<polygon fill="#000000" stroke="#000000" points="52.37,-1437.65 53.89,-1448.14 59.24,-1438.99 52.37,-1437.65"/>
</g>
<!-- sourcefile~obliquity_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge147" class="edge">
<title>sourcefile~obliquity_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M752.97,-585.3C743.94,-581.58 735.21,-576.73 728,-570.4 700.22,-546 721.5,-517.68 692,-495.4 554.17,-391.28 462.37,-508.86 309,-429.4 251.52,-399.61 256.61,-286.03 206,-326.4"/>
</g>
<!-- sourcefile~obliquity_module.f90&#45;&gt;sourcefile~conversion_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge148" class="edge">
<title>sourcefile~obliquity_module.f90&#45;&gt;sourcefile~conversion_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M775.59,-585.35C733.68,-571.95 660.55,-552.64 596.5,-556.4"/>
</g>
<!-- sourcefile~gooding_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge149" class="edge">
<title>sourcefile~gooding_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M325,-59.47C319.19,-62.04 313.71,-65.28 309,-69.4 216.27,-150.29 302.13,-249.58 206,-326.4"/>
</g>
<!-- sourcefile~gooding_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge150" class="edge">
<title>sourcefile~gooding_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M326.65,-62.55C319.93,-66.06 313.78,-70.58 309,-76.4 271.39,-122.12 282.76,-282 273,-340.4 252.98,-460.18 222.58,-602.54 210.85,-656.35"/>
<polygon fill="#000000" stroke="#000000" points="207.42,-655.65 208.7,-666.17 214.26,-657.15 207.42,-655.65"/>
</g>
<!-- sourcefile~random_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge151" class="edge">
<title>sourcefile~random_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M333.79,-142.4C324.95,-145.96 316.28,-150.54 309,-156.4 240.19,-211.8 275.01,-271.25 206,-326.4"/>
</g>
<!-- sourcefile~newton_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge152" class="edge">
<title>sourcefile~newton_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M329.46,-666.36C321.88,-662.84 314.75,-658.28 309,-652.4 202.83,-543.69 324.7,-231.54 206,-326.4"/>
</g>
<!-- sourcefile~newton_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge153" class="edge">
<title>sourcefile~newton_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M326.88,-678.4C311.48,-678.4 294.65,-678.4 278.57,-678.4"/>
<polygon fill="#000000" stroke="#000000" points="278.14,-674.9 268.14,-678.4 278.14,-681.9 278.14,-674.9"/>
</g>
</g>
</svg>
</div><script>var pansourcefilealtitude_maintenancef90EfferentGraph = svgPanZoom('#sourcefilealtitude_maintenancef90EfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="193.5,-24 88.5,-24 88.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: sourcefile~~altitude_maintenance.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilealtitude_maintenancef90AfferentGraph" width="253pt" height="32pt"
 viewBox="0.00 0.00 253.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~altitude_maintenance.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>sourcefile~~altitude_maintenance.f90~~AfferentGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 249,-28 249,4 -4,4"/>
<!-- sourcefile~altitude_maintenance.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~altitude_maintenance.f90</title>
<polygon fill="none" stroke="black" points="149,-24 0,-24 0,0 149,0 149,-24"/>
<text text-anchor="middle" x="74.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">altitude_maintenance.f90</text>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="245,-24 185,-24 185,0 245,0 245,-24"/>
<text text-anchor="middle" x="215" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~altitude_maintenance.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~altitude_maintenance.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M184.97,-12C177.16,-12 168.31,-12 159.11,-12"/>
<polygon fill="#000000" stroke="#000000" points="159.02,-8.5 149.02,-12 159.02,-15.5 159.02,-8.5"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="193.5,-24 88.5,-24 88.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be.
    </p>
    </div></div></div></div>
      </div>
    </div>
<br>
    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../module/altitude_maintenance_module.html">altitude_maintenance_module</a>
    </div>
  </div>
</div>
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/altitude_maintenance.f90.html#src">altitude_maintenance.f90</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a id="ln-1" name="ln-1" href="#ln-1"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-2" name="ln-2" href="#ln-2"></a><span class="c">!&gt;</span>
<a id="ln-3" name="ln-3" href="#ln-3"></a><span class="c">!  Altitude maintenance for low lunar orbits.</span>
<a id="ln-4" name="ln-4" href="#ln-4"></a><span class="c">!</span>
<a id="ln-5" name="ln-5" href="#ln-5"></a><span class="c">!  Assumptions:</span>
<a id="ln-6" name="ln-6" href="#ln-6"></a><span class="c">!</span>
<a id="ln-7" name="ln-7" href="#ln-7"></a><span class="c">!  * Circular low-lunar orbit.</span>
<a id="ln-8" name="ln-8" href="#ln-8"></a><span class="c">!  * Only periapsis altitude is controlled (all other elements float)</span>
<a id="ln-9" name="ln-9" href="#ln-9"></a><span class="c">!  * The low-fidelity IAU_MOON frame is used for the elements and gravity model.</span>
<a id="ln-10" name="ln-10" href="#ln-10"></a>
<a id="ln-11" name="ln-11" href="#ln-11"></a><span class="w">    </span><span class="k">module </span><span class="n">altitude_maintenance_module</span><span class="w"></span>
<a id="ln-12" name="ln-12" href="#ln-12"></a>
<a id="ln-13" name="ln-13" href="#ln-13"></a><span class="w">    </span><span class="k">use </span><span class="n">fortran_astrodynamics_toolkit</span><span class="w"></span>
<a id="ln-14" name="ln-14" href="#ln-14"></a><span class="w">    </span><span class="k">use </span><span class="n">ddeabm_module</span><span class="p">,</span><span class="w">   </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">ddeabm_class</span><span class="p">,</span><span class="n">ddeabm_with_event_class</span><span class="w"></span>
<a id="ln-15" name="ln-15" href="#ln-15"></a><span class="w">    </span><span class="k">use </span><span class="n">iso_fortran_env</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">error_unit</span><span class="p">,</span><span class="n">output_unit</span><span class="p">,</span><span class="w"> </span><span class="n">wp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real64</span><span class="w"></span>
<a id="ln-16" name="ln-16" href="#ln-16"></a>
<a id="ln-17" name="ln-17" href="#ln-17"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-18" name="ln-18" href="#ln-18"></a>
<a id="ln-19" name="ln-19" href="#ln-19"></a><span class="k">    private</span>
<a id="ln-20" name="ln-20" href="#ln-20"></a>
<a id="ln-21" name="ln-21" href="#ln-21"></a><span class="k">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ephemeris_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;./data/eph/JPLEPH_gfortran_mac.421&#39;</span><span class="w"></span>
<a id="ln-22" name="ln-22" href="#ln-22"></a><span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">gravfile</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;./data/grav/gggrx_0020pm_sha.tab&#39;</span><span class="w"></span>
<a id="ln-23" name="ln-23" href="#ln-23"></a>
<a id="ln-24" name="ln-24" href="#ln-24"></a><span class="w">    </span><span class="k">type</span><span class="p">,</span><span class="k">extends</span><span class="p">(</span><span class="n">ddeabm_with_event_class</span><span class="p">),</span><span class="k">public</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">segment</span><span class="w"></span>
<a id="ln-25" name="ln-25" href="#ln-25"></a>
<a id="ln-26" name="ln-26" href="#ln-26"></a><span class="w">        </span><span class="c">!! the main class for integrating a low-lunar orbit.</span>
<a id="ln-27" name="ln-27" href="#ln-27"></a>
<a id="ln-28" name="ln-28" href="#ln-28"></a><span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="c">!! event function to use:</span>
<a id="ln-29" name="ln-29" href="#ln-29"></a><span class="w">                             </span><span class="c">!!</span>
<a id="ln-30" name="ln-30" href="#ln-30"></a><span class="w">                             </span><span class="c">!! 1 = integrate until minimum altitude</span>
<a id="ln-31" name="ln-31" href="#ln-31"></a><span class="w">                             </span><span class="c">!! 2 = integrate to apoapsis</span>
<a id="ln-32" name="ln-32" href="#ln-32"></a>
<a id="ln-33" name="ln-33" href="#ln-33"></a><span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">et_ref</span><span class="w"> </span><span class="c">!! reference ephemeris time (sec)</span>
<a id="ln-34" name="ln-34" href="#ln-34"></a>
<a id="ln-35" name="ln-35" href="#ln-35"></a><span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nominal_altitude</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="mf">0.0_wp</span><span class="w">  </span><span class="c">!! nominal altitude (km)</span>
<a id="ln-36" name="ln-36" href="#ln-36"></a><span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">deadband</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="mf">0.0_wp</span><span class="w">   </span><span class="c">!! altitude below nominal to trigger maneuver (km)</span>
<a id="ln-37" name="ln-37" href="#ln-37"></a><span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">r_moon</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="mi">173</span><span class="mf">7.4_wp</span><span class="w"> </span><span class="c">!! radius of the moon (km)</span>
<a id="ln-38" name="ln-38" href="#ln-38"></a>
<a id="ln-39" name="ln-39" href="#ln-39"></a><span class="w">        </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">include_third_bodies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!! to also include Earth and Sun in force model</span>
<a id="ln-40" name="ln-40" href="#ln-40"></a>
<a id="ln-41" name="ln-41" href="#ln-41"></a><span class="w">        </span><span class="k">type</span><span class="p">(</span><span class="n">geopotential_model_pines</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">grav</span><span class="w">  </span><span class="c">!! central body geopotential model</span>
<a id="ln-42" name="ln-42" href="#ln-42"></a><span class="w">        </span><span class="k">type</span><span class="p">(</span><span class="n">jpl_ephemeris</span><span class="p">)</span><span class="w">            </span><span class="kd">::</span><span class="w"> </span><span class="n">eph</span><span class="w">   </span><span class="c">!! the ephemeris</span>
<a id="ln-43" name="ln-43" href="#ln-43"></a>
<a id="ln-44" name="ln-44" href="#ln-44"></a><span class="w">        </span><span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">n_eoms</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="w">                  </span><span class="c">!! size of EOM derivative vector [x,y,z,vx,vy,vz]</span>
<a id="ln-45" name="ln-45" href="#ln-45"></a><span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">integrator_tol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0e-12_wp</span><span class="w"> </span><span class="c">!! integrator tols</span>
<a id="ln-46" name="ln-46" href="#ln-46"></a><span class="w">        </span><span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">maxsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1000000</span><span class="w">          </span><span class="c">!! integrator max steps</span>
<a id="ln-47" name="ln-47" href="#ln-47"></a><span class="w">        </span><span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">grav_n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="w">                  </span><span class="c">!! max grav degree</span>
<a id="ln-48" name="ln-48" href="#ln-48"></a><span class="w">        </span><span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">grav_m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="w">                  </span><span class="c">!! max grav order</span>
<a id="ln-49" name="ln-49" href="#ln-49"></a><span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">root_tol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0e-6_wp</span><span class="w">        </span><span class="c">!! event tolerance for deadband (km)</span>
<a id="ln-50" name="ln-50" href="#ln-50"></a>
<a id="ln-51" name="ln-51" href="#ln-51"></a><span class="w">        </span><span class="k">contains</span>
<a id="ln-52" name="ln-52" href="#ln-52"></a>
<a id="ln-53" name="ln-53" href="#ln-53"></a><span class="k">        procedure</span><span class="p">,</span><span class="k">public</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">initialize_seg</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">initialize_segment</span><span class="w"></span>
<a id="ln-54" name="ln-54" href="#ln-54"></a><span class="w">        </span><span class="k">procedure</span><span class="p">,</span><span class="k">public</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">altitude_maintenance</span><span class="w"></span>
<a id="ln-55" name="ln-55" href="#ln-55"></a>
<a id="ln-56" name="ln-56" href="#ln-56"></a><span class="w">    </span><span class="k">end type </span><span class="n">segment</span><span class="w"></span>
<a id="ln-57" name="ln-57" href="#ln-57"></a>
<a id="ln-58" name="ln-58" href="#ln-58"></a><span class="w">    </span><span class="k">contains</span><span class="w"></span>
<a id="ln-59" name="ln-59" href="#ln-59"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-60" name="ln-60" href="#ln-60"></a>
<a id="ln-61" name="ln-61" href="#ln-61"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-62" name="ln-62" href="#ln-62"></a><span class="c">!&gt;</span>
<a id="ln-63" name="ln-63" href="#ln-63"></a><span class="c">!  Initialize the segment for integration.</span>
<a id="ln-64" name="ln-64" href="#ln-64"></a>
<a id="ln-65" name="ln-65" href="#ln-65"></a><span class="w">    </span><span class="k">subroutine </span><span class="n">initialize_segment</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">alt0</span><span class="p">,</span><span class="n">deadband_alt</span><span class="p">,</span><span class="n">grav_n</span><span class="p">,</span><span class="n">grav_m</span><span class="p">)</span><span class="w"></span>
<a id="ln-66" name="ln-66" href="#ln-66"></a>
<a id="ln-67" name="ln-67" href="#ln-67"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-68" name="ln-68" href="#ln-68"></a>
<a id="ln-69" name="ln-69" href="#ln-69"></a><span class="k">    class</span><span class="p">(</span><span class="n">segment</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">me</span><span class="w"></span>
<a id="ln-70" name="ln-70" href="#ln-70"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">alt0</span><span class="w"></span>
<a id="ln-71" name="ln-71" href="#ln-71"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">deadband_alt</span><span class="w"></span>
<a id="ln-72" name="ln-72" href="#ln-72"></a><span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">grav_n</span><span class="w"></span>
<a id="ln-73" name="ln-73" href="#ln-73"></a><span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">grav_m</span><span class="w"></span>
<a id="ln-74" name="ln-74" href="#ln-74"></a>
<a id="ln-75" name="ln-75" href="#ln-75"></a><span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">status_ok</span><span class="w"></span>
<a id="ln-76" name="ln-76" href="#ln-76"></a>
<a id="ln-77" name="ln-77" href="#ln-77"></a><span class="w">    </span><span class="c">! set up the integrator:</span>
<a id="ln-78" name="ln-78" href="#ln-78"></a><span class="w">    </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">initialize_event</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">n_eoms</span><span class="p">,</span><span class="n">me</span><span class="p">%</span><span class="n">maxsteps</span><span class="p">,</span><span class="n">ballistic_derivs</span><span class="p">,&amp;</span><span class="w"></span>
<a id="ln-79" name="ln-79" href="#ln-79"></a><span class="w">                                </span><span class="p">[</span><span class="n">me</span><span class="p">%</span><span class="n">integrator_tol</span><span class="p">],[</span><span class="n">me</span><span class="p">%</span><span class="n">integrator_tol</span><span class="p">],&amp;</span><span class="w"></span>
<a id="ln-80" name="ln-80" href="#ln-80"></a><span class="w">                                 </span><span class="n">event_func</span><span class="p">,</span><span class="n">me</span><span class="p">%</span><span class="n">root_tol</span><span class="p">)</span><span class="w"></span>
<a id="ln-81" name="ln-81" href="#ln-81"></a>
<a id="ln-82" name="ln-82" href="#ln-82"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">include_third_bodies</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<a id="ln-83" name="ln-83" href="#ln-83"></a><span class="w">        </span><span class="c">! set up the ephemeris:</span>
<a id="ln-84" name="ln-84" href="#ln-84"></a><span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="n">output_unit</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;loading ephemeris file: &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">ephemeris_file</span><span class="p">)</span><span class="w"></span>
<a id="ln-85" name="ln-85" href="#ln-85"></a><span class="w">        </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">eph</span><span class="p">%</span><span class="n">initialize</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">ephemeris_file</span><span class="p">,</span><span class="n">status_ok</span><span class="o">=</span><span class="n">status_ok</span><span class="p">)</span><span class="w"></span>
<a id="ln-86" name="ln-86" href="#ln-86"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">status_ok</span><span class="p">)</span><span class="w"> </span><span class="k">error stop</span><span class="w"> </span><span class="s1">&#39;error initializing ephemeris&#39;</span><span class="w"></span>
<a id="ln-87" name="ln-87" href="#ln-87"></a><span class="w">    </span><span class="k">end if</span><span class="w"></span>
<a id="ln-88" name="ln-88" href="#ln-88"></a>
<a id="ln-89" name="ln-89" href="#ln-89"></a><span class="w">    </span><span class="c">! set class variables for event function:</span>
<a id="ln-90" name="ln-90" href="#ln-90"></a><span class="w">    </span><span class="n">me</span><span class="p">%</span><span class="n">nominal_altitude</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alt0</span><span class="w"></span>
<a id="ln-91" name="ln-91" href="#ln-91"></a><span class="w">    </span><span class="n">me</span><span class="p">%</span><span class="n">deadband</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deadband_alt</span><span class="w"></span>
<a id="ln-92" name="ln-92" href="#ln-92"></a><span class="w">    </span><span class="n">me</span><span class="p">%</span><span class="n">grav_n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">grav_n</span><span class="w"></span>
<a id="ln-93" name="ln-93" href="#ln-93"></a><span class="w">    </span><span class="n">me</span><span class="p">%</span><span class="n">grav_m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">grav_m</span><span class="w"></span>
<a id="ln-94" name="ln-94" href="#ln-94"></a>
<a id="ln-95" name="ln-95" href="#ln-95"></a><span class="w">    </span><span class="c">! set up the force model [main body is moon]:</span>
<a id="ln-96" name="ln-96" href="#ln-96"></a><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="n">output_unit</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;loading gravity file: &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">gravfile</span><span class="p">)</span><span class="w"></span>
<a id="ln-97" name="ln-97" href="#ln-97"></a><span class="w">    </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">grav</span><span class="p">%</span><span class="n">initialize</span><span class="p">(</span><span class="n">gravfile</span><span class="p">,</span><span class="n">me</span><span class="p">%</span><span class="n">grav_n</span><span class="p">,</span><span class="n">me</span><span class="p">%</span><span class="n">grav_m</span><span class="p">,</span><span class="n">status_ok</span><span class="p">)</span><span class="w"></span>
<a id="ln-98" name="ln-98" href="#ln-98"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">status_ok</span><span class="p">)</span><span class="w"> </span><span class="k">error stop</span><span class="w"> </span><span class="s1">&#39;error initializing gravity model&#39;</span><span class="w"></span>
<a id="ln-99" name="ln-99" href="#ln-99"></a>
<a id="ln-100" name="ln-100" href="#ln-100"></a><span class="w">    </span><span class="k">end subroutine </span><span class="n">initialize_segment</span><span class="w"></span>
<a id="ln-101" name="ln-101" href="#ln-101"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-102" name="ln-102" href="#ln-102"></a>
<a id="ln-103" name="ln-103" href="#ln-103"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-104" name="ln-104" href="#ln-104"></a><span class="c">!&gt;</span>
<a id="ln-105" name="ln-105" href="#ln-105"></a><span class="c">!  Altitude maintenance for a circular lunar orbit - periapsis only control.</span>
<a id="ln-106" name="ln-106" href="#ln-106"></a>
<a id="ln-107" name="ln-107" href="#ln-107"></a><span class="w">    </span><span class="k">subroutine </span><span class="n">altitude_maintenance</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">et0</span><span class="p">,</span><span class="n">inc0</span><span class="p">,</span><span class="n">ran0</span><span class="p">,</span><span class="n">tru0</span><span class="p">,</span><span class="n">dt_max</span><span class="p">,</span><span class="n">n_dvs</span><span class="p">,</span><span class="n">dv_total</span><span class="p">,</span><span class="n">xf</span><span class="p">)</span><span class="w"></span>
<a id="ln-108" name="ln-108" href="#ln-108"></a>
<a id="ln-109" name="ln-109" href="#ln-109"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-110" name="ln-110" href="#ln-110"></a>
<a id="ln-111" name="ln-111" href="#ln-111"></a><span class="k">    class</span><span class="p">(</span><span class="n">segment</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w">      </span><span class="kd">::</span><span class="w"> </span><span class="n">seg</span><span class="w"></span>
<a id="ln-112" name="ln-112" href="#ln-112"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">               </span><span class="kd">::</span><span class="w"> </span><span class="n">et0</span><span class="w">      </span><span class="c">!! initial ephemeris time (sec)</span>
<a id="ln-113" name="ln-113" href="#ln-113"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">               </span><span class="kd">::</span><span class="w"> </span><span class="n">inc0</span><span class="w">     </span><span class="c">!! initial inclination - IAU_MOON of date (deg)</span>
<a id="ln-114" name="ln-114" href="#ln-114"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">               </span><span class="kd">::</span><span class="w"> </span><span class="n">ran0</span><span class="w">     </span><span class="c">!! initial RAAN - IAU_MOON of date (deg)</span>
<a id="ln-115" name="ln-115" href="#ln-115"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">               </span><span class="kd">::</span><span class="w"> </span><span class="n">tru0</span><span class="w">     </span><span class="c">!! initial true anomaly - IAU_MOON of date (deg)</span>
<a id="ln-116" name="ln-116" href="#ln-116"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">               </span><span class="kd">::</span><span class="w"> </span><span class="n">dt_max</span><span class="w">   </span><span class="c">!! how long to propagate (days)</span>
<a id="ln-117" name="ln-117" href="#ln-117"></a><span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w">               </span><span class="kd">::</span><span class="w"> </span><span class="n">n_dvs</span><span class="w">    </span><span class="c">!! number of DV maneuvers performed</span>
<a id="ln-118" name="ln-118" href="#ln-118"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w">              </span><span class="kd">::</span><span class="w"> </span><span class="n">dv_total</span><span class="w"> </span><span class="c">!! total DV (km/s)</span>
<a id="ln-119" name="ln-119" href="#ln-119"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xf</span><span class="w">       </span><span class="c">!! final state - inertial frame (km, km/s)</span>
<a id="ln-120" name="ln-120" href="#ln-120"></a>
<a id="ln-121" name="ln-121" href="#ln-121"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="c">!! position vector (km)</span>
<a id="ln-122" name="ln-122" href="#ln-122"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="c">!! velocity vector (km/s)</span>
<a id="ln-123" name="ln-123" href="#ln-123"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rotmat</span><span class="w">  </span><span class="c">!! rotation matrix from ICRF to IAU_MOON</span>
<a id="ln-124" name="ln-124" href="#ln-124"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span><span class="w">  </span><span class="c">!! J2000-Moon state vector</span>
<a id="ln-125" name="ln-125" href="#ln-125"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">idid</span><span class="w">             </span><span class="c">!! integrator status flag</span>
<a id="ln-126" name="ln-126" href="#ln-126"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">sma</span><span class="w">             </span><span class="c">!! circular orbit semi-major axis (km)</span>
<a id="ln-127" name="ln-127" href="#ln-127"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">min_altitude</span><span class="w">    </span><span class="c">!! minimum altitude (km)</span>
<a id="ln-128" name="ln-128" href="#ln-128"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dv</span><span class="w">              </span><span class="c">!! periapsis raise maneuver magnitude (km/s)</span>
<a id="ln-129" name="ln-129" href="#ln-129"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">t</span><span class="w">               </span><span class="c">!! integration time (sec from et0)</span>
<a id="ln-130" name="ln-130" href="#ln-130"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tf</span><span class="w">              </span><span class="c">!! final integration time (sec from et0)</span>
<a id="ln-131" name="ln-131" href="#ln-131"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">gval</span><span class="w">            </span><span class="c">!! event function value</span>
<a id="ln-132" name="ln-132" href="#ln-132"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tru</span><span class="w">             </span><span class="c">!! true anomaly (deg)</span>
<a id="ln-133" name="ln-133" href="#ln-133"></a>
<a id="ln-134" name="ln-134" href="#ln-134"></a><span class="w">    </span><span class="c">! initialize</span>
<a id="ln-135" name="ln-135" href="#ln-135"></a><span class="w">    </span><span class="n">n_dvs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-136" name="ln-136" href="#ln-136"></a><span class="w">    </span><span class="n">dv_total</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span><span class="w"></span>
<a id="ln-137" name="ln-137" href="#ln-137"></a>
<a id="ln-138" name="ln-138" href="#ln-138"></a><span class="w">    </span><span class="c">! get initial state in J2000 - Cartesian for integration</span>
<a id="ln-139" name="ln-139" href="#ln-139"></a><span class="w">    </span><span class="c">! note that inc,ran are in moon-centered-of-date-frame</span>
<a id="ln-140" name="ln-140" href="#ln-140"></a><span class="w">    </span><span class="c">! [circular orbit so p=sma]</span>
<a id="ln-141" name="ln-141" href="#ln-141"></a><span class="w">    </span><span class="n">sma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">seg</span><span class="p">%</span><span class="n">r_moon</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">seg</span><span class="p">%</span><span class="n">nominal_altitude</span><span class="w">  </span><span class="c">! initial orbit sma (circular)</span>
<a id="ln-142" name="ln-142" href="#ln-142"></a><span class="w">    </span><span class="k">call </span><span class="n">orbital_elements_to_rv</span><span class="p">(</span><span class="n">body_moon</span><span class="p">%</span><span class="n">mu</span><span class="p">,</span><span class="n">sma</span><span class="p">,</span><span class="n">zero</span><span class="p">,&amp;</span><span class="w"></span>
<a id="ln-143" name="ln-143" href="#ln-143"></a><span class="w">                                </span><span class="n">inc0</span><span class="o">*</span><span class="n">deg2rad</span><span class="p">,</span><span class="n">ran0</span><span class="o">*</span><span class="n">deg2rad</span><span class="p">,</span><span class="n">zero</span><span class="p">,</span><span class="n">tru0</span><span class="o">*</span><span class="n">deg2rad</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">v</span><span class="p">)</span><span class="w"></span>
<a id="ln-144" name="ln-144" href="#ln-144"></a>
<a id="ln-145" name="ln-145" href="#ln-145"></a><span class="w">    </span><span class="c">! rotate from body-fixed moon of date to j2000:</span>
<a id="ln-146" name="ln-146" href="#ln-146"></a><span class="w">    </span><span class="n">rotmat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icrf_to_iau_moon</span><span class="p">(</span><span class="n">et0</span><span class="p">)</span><span class="w">   </span><span class="c">! rotation matrix from inertial to body-fixed Moon frame</span>
<a id="ln-147" name="ln-147" href="#ln-147"></a><span class="w">    </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">matmul</span><span class="p">(</span><span class="nb">transpose</span><span class="p">(</span><span class="n">rotmat</span><span class="p">),</span><span class="n">r</span><span class="p">)</span><span class="w"></span>
<a id="ln-148" name="ln-148" href="#ln-148"></a><span class="w">    </span><span class="n">x</span><span class="p">(</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">matmul</span><span class="p">(</span><span class="nb">transpose</span><span class="p">(</span><span class="n">rotmat</span><span class="p">),</span><span class="n">v</span><span class="p">)</span><span class="w">  </span><span class="c">! because using &quot;of date&quot; iau_moon frame</span>
<a id="ln-149" name="ln-149" href="#ln-149"></a>
<a id="ln-150" name="ln-150" href="#ln-150"></a><span class="w">    </span><span class="c">! times are relative to initial epoch (sec)</span>
<a id="ln-151" name="ln-151" href="#ln-151"></a><span class="w">    </span><span class="n">seg</span><span class="p">%</span><span class="n">et_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">et0</span><span class="w"></span>
<a id="ln-152" name="ln-152" href="#ln-152"></a><span class="w">    </span><span class="n">t</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span><span class="w"></span>
<a id="ln-153" name="ln-153" href="#ln-153"></a><span class="w">    </span><span class="n">tf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dt_max</span><span class="o">*</span><span class="n">day2sec</span><span class="w"></span>
<a id="ln-154" name="ln-154" href="#ln-154"></a>
<a id="ln-155" name="ln-155" href="#ln-155"></a><span class="w">    </span><span class="c">! propagate until the altitude is less than min_altitude</span>
<a id="ln-156" name="ln-156" href="#ln-156"></a><span class="w">    </span><span class="n">seg</span><span class="p">%</span><span class="n">event</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-157" name="ln-157" href="#ln-157"></a>
<a id="ln-158" name="ln-158" href="#ln-158"></a><span class="w">    </span><span class="c">! main integration loop:</span>
<a id="ln-159" name="ln-159" href="#ln-159"></a><span class="w">    </span><span class="k">call </span><span class="n">seg</span><span class="p">%</span><span class="n">first_call</span><span class="p">()</span><span class="w"></span>
<a id="ln-160" name="ln-160" href="#ln-160"></a><span class="w">    </span><span class="k">do</span>
<a id="ln-161" name="ln-161" href="#ln-161"></a>
<a id="ln-162" name="ln-162" href="#ln-162"></a><span class="k">        call </span><span class="n">seg</span><span class="p">%</span><span class="n">integrate_to_event</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">tf</span><span class="p">,</span><span class="n">idid</span><span class="o">=</span><span class="n">idid</span><span class="p">,</span><span class="n">gval</span><span class="o">=</span><span class="n">gval</span><span class="p">)</span><span class="w"></span>
<a id="ln-163" name="ln-163" href="#ln-163"></a>
<a id="ln-164" name="ln-164" href="#ln-164"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">idid</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-165" name="ln-165" href="#ln-165"></a>
<a id="ln-166" name="ln-166" href="#ln-166"></a><span class="k">            write</span><span class="p">(</span><span class="n">error_unit</span><span class="p">,</span><span class="s1">&#39;(A,*(I5/))&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;idid: &#39;</span><span class="p">,</span><span class="n">idid</span><span class="w"></span>
<a id="ln-167" name="ln-167" href="#ln-167"></a><span class="w">            </span><span class="k">error stop</span><span class="w"> </span><span class="s1">&#39;error in integrator&#39;</span><span class="w"></span>
<a id="ln-168" name="ln-168" href="#ln-168"></a>
<a id="ln-169" name="ln-169" href="#ln-169"></a><span class="w">        </span><span class="n">elseif</span><span class="w"> </span><span class="p">(</span><span class="n">idid</span><span class="o">==</span><span class="mi">2</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">idid</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<a id="ln-170" name="ln-170" href="#ln-170"></a>
<a id="ln-171" name="ln-171" href="#ln-171"></a><span class="w">            </span><span class="c">! if we reached the max time, then we are done, so exit</span>
<a id="ln-172" name="ln-172" href="#ln-172"></a><span class="w">            </span><span class="k">exit</span>
<a id="ln-173" name="ln-173" href="#ln-173"></a>
<a id="ln-174" name="ln-174" href="#ln-174"></a><span class="k">        </span><span class="n">elseif</span><span class="w"> </span><span class="p">(</span><span class="n">idid</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1000</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">  </span><span class="c">! a root has been found</span>
<a id="ln-175" name="ln-175" href="#ln-175"></a>
<a id="ln-176" name="ln-176" href="#ln-176"></a><span class="w">            </span><span class="k">select case</span><span class="w"> </span><span class="p">(</span><span class="n">seg</span><span class="p">%</span><span class="n">event</span><span class="p">)</span><span class="w"></span>
<a id="ln-177" name="ln-177" href="#ln-177"></a><span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<a id="ln-178" name="ln-178" href="#ln-178"></a>
<a id="ln-179" name="ln-179" href="#ln-179"></a><span class="w">                </span><span class="c">! if we hit the min altitude, then integrate to next apoapsis</span>
<a id="ln-180" name="ln-180" href="#ln-180"></a><span class="w">                </span><span class="c">! and raise the periapsis:</span>
<a id="ln-181" name="ln-181" href="#ln-181"></a><span class="w">                </span><span class="n">seg</span><span class="p">%</span><span class="n">event</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="c">! propagate until apoapsis</span>
<a id="ln-182" name="ln-182" href="#ln-182"></a><span class="w">                </span><span class="k">call </span><span class="n">seg</span><span class="p">%</span><span class="n">first_call</span><span class="p">()</span><span class="w">  </span><span class="c">! have to restart the integration</span>
<a id="ln-183" name="ln-183" href="#ln-183"></a><span class="w">                                       </span><span class="c">! since we just root solved</span>
<a id="ln-184" name="ln-184" href="#ln-184"></a>
<a id="ln-185" name="ln-185" href="#ln-185"></a><span class="w">                </span><span class="c">! compute the maneuver here that will be performed</span>
<a id="ln-186" name="ln-186" href="#ln-186"></a><span class="w">                </span><span class="c">! at next apoapsis to raise the periapsis, no matter what.</span>
<a id="ln-187" name="ln-187" href="#ln-187"></a><span class="w">                </span><span class="n">dv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">periapsis_raise_maneuver</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">sma</span><span class="p">)</span><span class="w"></span>
<a id="ln-188" name="ln-188" href="#ln-188"></a>
<a id="ln-189" name="ln-189" href="#ln-189"></a><span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<a id="ln-190" name="ln-190" href="#ln-190"></a>
<a id="ln-191" name="ln-191" href="#ln-191"></a><span class="w">                </span><span class="c">! we have propagated to periapsis or apoapsis, if at apoapsis,</span>
<a id="ln-192" name="ln-192" href="#ln-192"></a><span class="w">                </span><span class="c">! perform a maneuver to raise periapsis</span>
<a id="ln-193" name="ln-193" href="#ln-193"></a><span class="w">                </span><span class="c">! if at periapsis, just continue on.</span>
<a id="ln-194" name="ln-194" href="#ln-194"></a>
<a id="ln-195" name="ln-195" href="#ln-195"></a><span class="w">                </span><span class="c">! compute current true anomaly:</span>
<a id="ln-196" name="ln-196" href="#ln-196"></a><span class="w">                </span><span class="n">tru</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">true_anomaly</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<a id="ln-197" name="ln-197" href="#ln-197"></a>
<a id="ln-198" name="ln-198" href="#ln-198"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tru</span><span class="o">&lt;</span><span class="mi">17</span><span class="mf">9.0_wp</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">tru</span><span class="o">&gt;</span><span class="mi">18</span><span class="mf">1.0_wp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<a id="ln-199" name="ln-199" href="#ln-199"></a>
<a id="ln-200" name="ln-200" href="#ln-200"></a><span class="w">                    </span><span class="c">! we have to keep integrating, since we stopped at periapsis</span>
<a id="ln-201" name="ln-201" href="#ln-201"></a><span class="w">                    </span><span class="c">! note: this is inefficient since we have to</span>
<a id="ln-202" name="ln-202" href="#ln-202"></a><span class="w">                    </span><span class="c">! restart the integration. it would be better to prevent</span>
<a id="ln-203" name="ln-203" href="#ln-203"></a><span class="w">                    </span><span class="c">! to root solver from stopping here.</span>
<a id="ln-204" name="ln-204" href="#ln-204"></a><span class="w">                    </span><span class="n">seg</span><span class="p">%</span><span class="n">event</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w">  </span><span class="c">! continue with mode 2</span>
<a id="ln-205" name="ln-205" href="#ln-205"></a><span class="w">                    </span><span class="k">call </span><span class="n">seg</span><span class="p">%</span><span class="n">first_call</span><span class="p">()</span><span class="w">  </span><span class="c">! have to restart integration</span>
<a id="ln-206" name="ln-206" href="#ln-206"></a><span class="w">                    </span><span class="k">cycle</span>
<a id="ln-207" name="ln-207" href="#ln-207"></a>
<a id="ln-208" name="ln-208" href="#ln-208"></a><span class="k">                else</span><span class="w"> </span><span class="c">! we are at apoapsis</span>
<a id="ln-209" name="ln-209" href="#ln-209"></a>
<a id="ln-210" name="ln-210" href="#ln-210"></a><span class="w">                    </span><span class="c">! perform the maneuver we computed when</span>
<a id="ln-211" name="ln-211" href="#ln-211"></a><span class="w">                    </span><span class="c">! the min altitude was triggered</span>
<a id="ln-212" name="ln-212" href="#ln-212"></a><span class="w">                    </span><span class="c">! apply the maneuver along the current apoapsis velocity vector:</span>
<a id="ln-213" name="ln-213" href="#ln-213"></a><span class="w">                    </span><span class="n">x</span><span class="p">(</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dv</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">unit</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span><span class="w"></span>
<a id="ln-214" name="ln-214" href="#ln-214"></a>
<a id="ln-215" name="ln-215" href="#ln-215"></a><span class="w">                    </span><span class="c">! keep track of totals:</span>
<a id="ln-216" name="ln-216" href="#ln-216"></a><span class="w">                    </span><span class="n">n_dvs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n_dvs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-217" name="ln-217" href="#ln-217"></a><span class="w">                    </span><span class="n">dv_total</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dv_total</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dv</span><span class="w"></span>
<a id="ln-218" name="ln-218" href="#ln-218"></a>
<a id="ln-219" name="ln-219" href="#ln-219"></a><span class="w">                    </span><span class="k">write</span><span class="p">(</span><span class="n">output_unit</span><span class="p">,</span><span class="s1">&#39;(*(A,F12.6))&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;maneuver at &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="o">*</span><span class="n">sec2hr</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-220" name="ln-220" href="#ln-220"></a><span class="w">                                                      </span><span class="s1">&#39; hr : TRU = &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">tru</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-221" name="ln-221" href="#ln-221"></a><span class="w">                                                      </span><span class="s1">&#39; : dv = &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">dv</span><span class="w"></span>
<a id="ln-222" name="ln-222" href="#ln-222"></a>
<a id="ln-223" name="ln-223" href="#ln-223"></a><span class="w">                </span><span class="k">end if</span>
<a id="ln-224" name="ln-224" href="#ln-224"></a>
<a id="ln-225" name="ln-225" href="#ln-225"></a><span class="k">                </span><span class="n">seg</span><span class="p">%</span><span class="n">event</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">     </span><span class="c">! continue with normal mode</span>
<a id="ln-226" name="ln-226" href="#ln-226"></a><span class="w">                </span><span class="k">call </span><span class="n">seg</span><span class="p">%</span><span class="n">first_call</span><span class="p">()</span><span class="w">  </span><span class="c">! have to restart the integration</span>
<a id="ln-227" name="ln-227" href="#ln-227"></a><span class="w">                                       </span><span class="c">! since we root solved and/or changed</span>
<a id="ln-228" name="ln-228" href="#ln-228"></a><span class="w">                                       </span><span class="c">! the state</span>
<a id="ln-229" name="ln-229" href="#ln-229"></a>
<a id="ln-230" name="ln-230" href="#ln-230"></a><span class="w">            </span><span class="k">case </span><span class="n">default</span><span class="w"></span>
<a id="ln-231" name="ln-231" href="#ln-231"></a><span class="w">                </span><span class="k">error stop</span><span class="w"> </span><span class="s1">&#39;invalid event value in altitude_maintenance&#39;</span><span class="w"></span>
<a id="ln-232" name="ln-232" href="#ln-232"></a><span class="w">            </span><span class="k">end select</span>
<a id="ln-233" name="ln-233" href="#ln-233"></a>
<a id="ln-234" name="ln-234" href="#ln-234"></a><span class="k">        else</span>
<a id="ln-235" name="ln-235" href="#ln-235"></a><span class="k">            write</span><span class="p">(</span><span class="n">error_unit</span><span class="p">,</span><span class="s1">&#39;(A,I5)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;unknown exit code from integrator: idid=&#39;</span><span class="p">,</span><span class="n">idid</span><span class="w"></span>
<a id="ln-236" name="ln-236" href="#ln-236"></a><span class="w">            </span><span class="k">error stop</span><span class="w"> </span><span class="s1">&#39;error in altitude_maintenance&#39;</span><span class="w"></span>
<a id="ln-237" name="ln-237" href="#ln-237"></a><span class="w">        </span><span class="k">end if</span>
<a id="ln-238" name="ln-238" href="#ln-238"></a>
<a id="ln-239" name="ln-239" href="#ln-239"></a><span class="k">    end do</span><span class="w"></span>
<a id="ln-240" name="ln-240" href="#ln-240"></a>
<a id="ln-241" name="ln-241" href="#ln-241"></a><span class="w">    </span><span class="c">! final state:</span>
<a id="ln-242" name="ln-242" href="#ln-242"></a><span class="w">    </span><span class="n">xf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"></span>
<a id="ln-243" name="ln-243" href="#ln-243"></a>
<a id="ln-244" name="ln-244" href="#ln-244"></a><span class="w">    </span><span class="k">end subroutine </span><span class="n">altitude_maintenance</span><span class="w"></span>
<a id="ln-245" name="ln-245" href="#ln-245"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-246" name="ln-246" href="#ln-246"></a>
<a id="ln-247" name="ln-247" href="#ln-247"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-248" name="ln-248" href="#ln-248"></a><span class="c">!&gt;</span>
<a id="ln-249" name="ln-249" href="#ln-249"></a><span class="c">!  Compute true anomaly [0, 360] deg.</span>
<a id="ln-250" name="ln-250" href="#ln-250"></a>
<a id="ln-251" name="ln-251" href="#ln-251"></a><span class="w">    </span><span class="k">pure function </span><span class="n">true_anomaly</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">tru</span><span class="p">)</span><span class="w"></span>
<a id="ln-252" name="ln-252" href="#ln-252"></a>
<a id="ln-253" name="ln-253" href="#ln-253"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-254" name="ln-254" href="#ln-254"></a>
<a id="ln-255" name="ln-255" href="#ln-255"></a><span class="k">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rv</span><span class="w"> </span><span class="c">!! [position,velocity] vector</span>
<a id="ln-256" name="ln-256" href="#ln-256"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tru</span><span class="w"> </span><span class="c">!! true anomaly (deg)</span>
<a id="ln-257" name="ln-257" href="#ln-257"></a>
<a id="ln-258" name="ln-258" href="#ln-258"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="c">!! position vector</span>
<a id="ln-259" name="ln-259" href="#ln-259"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="c">!! velocity vector</span>
<a id="ln-260" name="ln-260" href="#ln-260"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="n">ecc</span><span class="p">,</span><span class="n">inc</span><span class="p">,</span><span class="n">raan</span><span class="p">,</span><span class="n">aop</span><span class="w"> </span><span class="c">!! orbital elements</span>
<a id="ln-261" name="ln-261" href="#ln-261"></a>
<a id="ln-262" name="ln-262" href="#ln-262"></a><span class="w">    </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rv</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<a id="ln-263" name="ln-263" href="#ln-263"></a><span class="w">    </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rv</span><span class="p">(</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span><span class="w"></span>
<a id="ln-264" name="ln-264" href="#ln-264"></a>
<a id="ln-265" name="ln-265" href="#ln-265"></a><span class="w">    </span><span class="k">call </span><span class="n">rv_to_orbital_elements</span><span class="p">(</span><span class="n">body_moon</span><span class="p">%</span><span class="n">mu</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">ecc</span><span class="p">,</span><span class="n">inc</span><span class="p">,</span><span class="n">raan</span><span class="p">,</span><span class="n">aop</span><span class="p">,</span><span class="n">tru</span><span class="p">)</span><span class="w"></span>
<a id="ln-266" name="ln-266" href="#ln-266"></a>
<a id="ln-267" name="ln-267" href="#ln-267"></a><span class="w">    </span><span class="n">tru</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tru</span><span class="o">*</span><span class="n">rad2deg</span><span class="w"> </span><span class="c">! convert to deg</span>
<a id="ln-268" name="ln-268" href="#ln-268"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tru</span><span class="o">&lt;</span><span class="n">zero</span><span class="p">)</span><span class="w"> </span><span class="n">tru</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tru</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">36</span><span class="mf">0.0_wp</span><span class="w"> </span><span class="c">! wrap from 0 to 369</span>
<a id="ln-269" name="ln-269" href="#ln-269"></a>
<a id="ln-270" name="ln-270" href="#ln-270"></a><span class="w">    </span><span class="k">end function </span><span class="n">true_anomaly</span><span class="w"></span>
<a id="ln-271" name="ln-271" href="#ln-271"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-272" name="ln-272" href="#ln-272"></a>
<a id="ln-273" name="ln-273" href="#ln-273"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-274" name="ln-274" href="#ln-274"></a><span class="c">!&gt;</span>
<a id="ln-275" name="ln-275" href="#ln-275"></a><span class="c">!  Compute the maneuver at apoapsis to raise periapsis to the specified value.</span>
<a id="ln-276" name="ln-276" href="#ln-276"></a>
<a id="ln-277" name="ln-277" href="#ln-277"></a><span class="w">    </span><span class="k">pure function </span><span class="n">periapsis_raise_maneuver</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span><span class="n">target_rp</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">dv</span><span class="p">)</span><span class="w"></span>
<a id="ln-278" name="ln-278" href="#ln-278"></a>
<a id="ln-279" name="ln-279" href="#ln-279"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-280" name="ln-280" href="#ln-280"></a>
<a id="ln-281" name="ln-281" href="#ln-281"></a><span class="k">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rv</span><span class="w"> </span><span class="c">!! [position,velocity] vector</span>
<a id="ln-282" name="ln-282" href="#ln-282"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">target_rp</span><span class="w">  </span><span class="c">!! the rp value to target</span>
<a id="ln-283" name="ln-283" href="#ln-283"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dv</span><span class="w"> </span><span class="c">!! the maneuver to perform at apoapsis to target `target_rp`</span>
<a id="ln-284" name="ln-284" href="#ln-284"></a>
<a id="ln-285" name="ln-285" href="#ln-285"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="c">!! position vector</span>
<a id="ln-286" name="ln-286" href="#ln-286"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="c">!! velocity vector</span>
<a id="ln-287" name="ln-287" href="#ln-287"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">ecc</span><span class="p">,</span><span class="n">inc</span><span class="p">,</span><span class="n">raan</span><span class="p">,</span><span class="n">aop</span><span class="p">,</span><span class="n">tru</span><span class="w"> </span><span class="c">!! orbital elements</span>
<a id="ln-288" name="ln-288" href="#ln-288"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rp1</span><span class="p">,</span><span class="n">ra1</span><span class="p">,</span><span class="n">vp1</span><span class="p">,</span><span class="n">va1</span><span class="p">,</span><span class="n">va2</span><span class="w">  </span><span class="c">!! periapsis/apoapsis pos/vel magnitudes</span>
<a id="ln-289" name="ln-289" href="#ln-289"></a>
<a id="ln-290" name="ln-290" href="#ln-290"></a><span class="w">    </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rv</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<a id="ln-291" name="ln-291" href="#ln-291"></a><span class="w">    </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rv</span><span class="p">(</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span><span class="w"></span>
<a id="ln-292" name="ln-292" href="#ln-292"></a>
<a id="ln-293" name="ln-293" href="#ln-293"></a><span class="w">    </span><span class="k">call </span><span class="n">rv_to_orbital_elements</span><span class="p">(</span><span class="n">body_moon</span><span class="p">%</span><span class="n">mu</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">ecc</span><span class="p">,</span><span class="n">inc</span><span class="p">,</span><span class="n">raan</span><span class="p">,</span><span class="n">aop</span><span class="p">,</span><span class="n">tru</span><span class="p">)</span><span class="w"></span>
<a id="ln-294" name="ln-294" href="#ln-294"></a><span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">one</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ecc</span><span class="o">*</span><span class="n">ecc</span><span class="p">)</span><span class="w"> </span><span class="c">! compute semi-major axis</span>
<a id="ln-295" name="ln-295" href="#ln-295"></a><span class="w">    </span><span class="k">call </span><span class="n">periapsis_apoapsis</span><span class="p">(</span><span class="n">body_moon</span><span class="p">%</span><span class="n">mu</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">ecc</span><span class="p">,</span><span class="n">rp1</span><span class="p">,</span><span class="n">ra1</span><span class="p">,</span><span class="n">vp1</span><span class="p">,</span><span class="n">va1</span><span class="p">)</span><span class="w"></span>
<a id="ln-296" name="ln-296" href="#ln-296"></a>
<a id="ln-297" name="ln-297" href="#ln-297"></a><span class="w">    </span><span class="c">! apoapsis velocity for periapsis radius of target_rp</span>
<a id="ln-298" name="ln-298" href="#ln-298"></a><span class="w">    </span><span class="n">va2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">body_moon</span><span class="p">%</span><span class="n">mu</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">target_rp</span><span class="o">/</span><span class="p">(</span><span class="n">ra1</span><span class="o">*</span><span class="p">(</span><span class="n">target_rp</span><span class="o">+</span><span class="n">ra1</span><span class="p">))</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-299" name="ln-299" href="#ln-299"></a>
<a id="ln-300" name="ln-300" href="#ln-300"></a><span class="w">    </span><span class="c">! delta-v to raise periapsis back to target rp</span>
<a id="ln-301" name="ln-301" href="#ln-301"></a><span class="w">    </span><span class="n">dv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">va2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">va1</span><span class="w"></span>
<a id="ln-302" name="ln-302" href="#ln-302"></a>
<a id="ln-303" name="ln-303" href="#ln-303"></a><span class="w">    </span><span class="k">end function </span><span class="n">periapsis_raise_maneuver</span><span class="w"></span>
<a id="ln-304" name="ln-304" href="#ln-304"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-305" name="ln-305" href="#ln-305"></a>
<a id="ln-306" name="ln-306" href="#ln-306"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-307" name="ln-307" href="#ln-307"></a><span class="c">!&gt;</span>
<a id="ln-308" name="ln-308" href="#ln-308"></a><span class="c">!  Compute radial velocity magnitude \( \dot{r} \)</span>
<a id="ln-309" name="ln-309" href="#ln-309"></a>
<a id="ln-310" name="ln-310" href="#ln-310"></a><span class="w">    </span><span class="k">pure function </span><span class="n">rdot</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"></span>
<a id="ln-311" name="ln-311" href="#ln-311"></a>
<a id="ln-312" name="ln-312" href="#ln-312"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-313" name="ln-313" href="#ln-313"></a>
<a id="ln-314" name="ln-314" href="#ln-314"></a><span class="k">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rv</span><span class="w"> </span><span class="c">!! [position,velocity] vector</span>
<a id="ln-315" name="ln-315" href="#ln-315"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rd</span><span class="w"> </span><span class="c">!! \( \dot{r} \)</span>
<a id="ln-316" name="ln-316" href="#ln-316"></a>
<a id="ln-317" name="ln-317" href="#ln-317"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="c">!! position vector</span>
<a id="ln-318" name="ln-318" href="#ln-318"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="c">!! velocity vector</span>
<a id="ln-319" name="ln-319" href="#ln-319"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rmag</span><span class="w"> </span><span class="c">!! position vector magnitude</span>
<a id="ln-320" name="ln-320" href="#ln-320"></a>
<a id="ln-321" name="ln-321" href="#ln-321"></a><span class="w">    </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rv</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<a id="ln-322" name="ln-322" href="#ln-322"></a><span class="w">    </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rv</span><span class="p">(</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span><span class="w"></span>
<a id="ln-323" name="ln-323" href="#ln-323"></a><span class="w">    </span><span class="n">rmag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">norm2</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="w"></span>
<a id="ln-324" name="ln-324" href="#ln-324"></a>
<a id="ln-325" name="ln-325" href="#ln-325"></a><span class="w">    </span><span class="n">rd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dot_product</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">rmag</span><span class="w"></span>
<a id="ln-326" name="ln-326" href="#ln-326"></a>
<a id="ln-327" name="ln-327" href="#ln-327"></a><span class="w">    </span><span class="k">end function </span><span class="n">rdot</span><span class="w"></span>
<a id="ln-328" name="ln-328" href="#ln-328"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-329" name="ln-329" href="#ln-329"></a>
<a id="ln-330" name="ln-330" href="#ln-330"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-331" name="ln-331" href="#ln-331"></a><span class="c">!&gt;</span>
<a id="ln-332" name="ln-332" href="#ln-332"></a><span class="c">!  Event function: when the altitude drops below the deadband.</span>
<a id="ln-333" name="ln-333" href="#ln-333"></a><span class="c">!</span>
<a id="ln-334" name="ln-334" href="#ln-334"></a><span class="c">!@note Moon is assumed to be a sphere.</span>
<a id="ln-335" name="ln-335" href="#ln-335"></a>
<a id="ln-336" name="ln-336" href="#ln-336"></a><span class="w">    </span><span class="k">subroutine </span><span class="n">event_func</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">g</span><span class="p">)</span><span class="w"></span>
<a id="ln-337" name="ln-337" href="#ln-337"></a>
<a id="ln-338" name="ln-338" href="#ln-338"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-339" name="ln-339" href="#ln-339"></a>
<a id="ln-340" name="ln-340" href="#ln-340"></a><span class="k">    class</span><span class="p">(</span><span class="n">ddeabm_with_event_class</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">me</span><span class="w"></span>
<a id="ln-341" name="ln-341" href="#ln-341"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">              </span><span class="kd">::</span><span class="w"> </span><span class="n">t</span><span class="w">  </span><span class="c">!! time</span>
<a id="ln-342" name="ln-342" href="#ln-342"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span><span class="w">  </span><span class="c">!! state -- moon centered inertial frame</span>
<a id="ln-343" name="ln-343" href="#ln-343"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w">             </span><span class="kd">::</span><span class="w"> </span><span class="n">g</span><span class="w">  </span><span class="c">!! event function</span>
<a id="ln-344" name="ln-344" href="#ln-344"></a>
<a id="ln-345" name="ln-345" href="#ln-345"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">alt</span><span class="w">  </span><span class="c">!! altitude (km)</span>
<a id="ln-346" name="ln-346" href="#ln-346"></a>
<a id="ln-347" name="ln-347" href="#ln-347"></a><span class="w">    </span><span class="k">select type</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">)</span><span class="w"></span>
<a id="ln-348" name="ln-348" href="#ln-348"></a><span class="w">    </span><span class="k">class is</span><span class="w"> </span><span class="p">(</span><span class="n">segment</span><span class="p">)</span><span class="w"></span>
<a id="ln-349" name="ln-349" href="#ln-349"></a>
<a id="ln-350" name="ln-350" href="#ln-350"></a><span class="w">        </span><span class="k">select case</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">event</span><span class="p">)</span><span class="w"></span>
<a id="ln-351" name="ln-351" href="#ln-351"></a><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<a id="ln-352" name="ln-352" href="#ln-352"></a>
<a id="ln-353" name="ln-353" href="#ln-353"></a><span class="w">            </span><span class="c">! g is offset from deadband altitude</span>
<a id="ln-354" name="ln-354" href="#ln-354"></a><span class="w">            </span><span class="n">alt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">norm2</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">))</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">r_moon</span><span class="w"></span>
<a id="ln-355" name="ln-355" href="#ln-355"></a><span class="w">            </span><span class="n">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alt</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nominal_altitude</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">deadband</span><span class="p">)</span><span class="w"></span>
<a id="ln-356" name="ln-356" href="#ln-356"></a>
<a id="ln-357" name="ln-357" href="#ln-357"></a><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<a id="ln-358" name="ln-358" href="#ln-358"></a>
<a id="ln-359" name="ln-359" href="#ln-359"></a><span class="w">            </span><span class="c">! g is rdot, which is zero and periapsis</span>
<a id="ln-360" name="ln-360" href="#ln-360"></a><span class="w">            </span><span class="c">! and apoapsis of an ellipse:</span>
<a id="ln-361" name="ln-361" href="#ln-361"></a><span class="w">            </span><span class="n">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rdot</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span><span class="w"></span>
<a id="ln-362" name="ln-362" href="#ln-362"></a>
<a id="ln-363" name="ln-363" href="#ln-363"></a><span class="w">            </span><span class="c">! TODO: figure out how to get it to ignore periapsis roots</span>
<a id="ln-364" name="ln-364" href="#ln-364"></a><span class="w">            </span><span class="c">! [maybe need to update DDEABM so we have more control</span>
<a id="ln-365" name="ln-365" href="#ln-365"></a><span class="w">            </span><span class="c">! over which roots it stops at]</span>
<a id="ln-366" name="ln-366" href="#ln-366"></a>
<a id="ln-367" name="ln-367" href="#ln-367"></a><span class="w">        </span><span class="k">case </span><span class="n">default</span><span class="w"></span>
<a id="ln-368" name="ln-368" href="#ln-368"></a><span class="w">            </span><span class="k">error stop</span><span class="w"> </span><span class="s1">&#39;invalid event value in event_func&#39;</span><span class="w"></span>
<a id="ln-369" name="ln-369" href="#ln-369"></a><span class="w">        </span><span class="k">end select</span>
<a id="ln-370" name="ln-370" href="#ln-370"></a>
<a id="ln-371" name="ln-371" href="#ln-371"></a><span class="k">    class </span><span class="n">default</span><span class="w"></span>
<a id="ln-372" name="ln-372" href="#ln-372"></a><span class="w">        </span><span class="k">error stop</span><span class="w"> </span><span class="s1">&#39;invalid class in event_func&#39;</span><span class="w"></span>
<a id="ln-373" name="ln-373" href="#ln-373"></a><span class="w">    </span><span class="k">end select</span>
<a id="ln-374" name="ln-374" href="#ln-374"></a>
<a id="ln-375" name="ln-375" href="#ln-375"></a><span class="k">    end subroutine </span><span class="n">event_func</span><span class="w"></span>
<a id="ln-376" name="ln-376" href="#ln-376"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-377" name="ln-377" href="#ln-377"></a>
<a id="ln-378" name="ln-378" href="#ln-378"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-379" name="ln-379" href="#ln-379"></a><span class="c">!&gt;</span>
<a id="ln-380" name="ln-380" href="#ln-380"></a><span class="c">!  Equations of motion for a ballistic orbit around the moon.</span>
<a id="ln-381" name="ln-381" href="#ln-381"></a>
<a id="ln-382" name="ln-382" href="#ln-382"></a><span class="w">    </span><span class="k">subroutine </span><span class="n">ballistic_derivs</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">xdot</span><span class="p">)</span><span class="w"></span>
<a id="ln-383" name="ln-383" href="#ln-383"></a>
<a id="ln-384" name="ln-384" href="#ln-384"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-385" name="ln-385" href="#ln-385"></a>
<a id="ln-386" name="ln-386" href="#ln-386"></a><span class="k">    class</span><span class="p">(</span><span class="n">ddeabm_class</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">me</span><span class="w"></span>
<a id="ln-387" name="ln-387" href="#ln-387"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">               </span><span class="kd">::</span><span class="w"> </span><span class="n">t</span><span class="w">    </span><span class="c">!! time [sec from epoch]</span>
<a id="ln-388" name="ln-388" href="#ln-388"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span><span class="w">    </span><span class="c">!! state [r,v] in inertial frame (moon-centered)</span>
<a id="ln-389" name="ln-389" href="#ln-389"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xdot</span><span class="w"> </span><span class="c">!! derivative of state (\( dx/dt \))</span>
<a id="ln-390" name="ln-390" href="#ln-390"></a>
<a id="ln-391" name="ln-391" href="#ln-391"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="n">rb</span><span class="p">,</span><span class="n">v</span><span class="w"></span>
<a id="ln-392" name="ln-392" href="#ln-392"></a><span class="w">    </span><span class="kt">reaL</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rv_earth_wrt_moon</span><span class="p">,</span><span class="n">rv_sun_wrt_moon</span><span class="w"></span>
<a id="ln-393" name="ln-393" href="#ln-393"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rotmat</span><span class="w"></span>
<a id="ln-394" name="ln-394" href="#ln-394"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">a_geopot</span><span class="w"></span>
<a id="ln-395" name="ln-395" href="#ln-395"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">a_earth</span><span class="w"></span>
<a id="ln-396" name="ln-396" href="#ln-396"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">a_sun</span><span class="w"></span>
<a id="ln-397" name="ln-397" href="#ln-397"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">a_third_body</span><span class="w"></span>
<a id="ln-398" name="ln-398" href="#ln-398"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">et</span><span class="w"> </span><span class="c">!! ephemeris time of `t`</span>
<a id="ln-399" name="ln-399" href="#ln-399"></a><span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">status_ok</span><span class="w">  </span><span class="c">!! ephemeris status flag</span>
<a id="ln-400" name="ln-400" href="#ln-400"></a>
<a id="ln-401" name="ln-401" href="#ln-401"></a><span class="w">    </span><span class="k">select type</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">)</span><span class="w"></span>
<a id="ln-402" name="ln-402" href="#ln-402"></a>
<a id="ln-403" name="ln-403" href="#ln-403"></a><span class="w">    </span><span class="k">class is</span><span class="w"> </span><span class="p">(</span><span class="n">segment</span><span class="p">)</span><span class="w"></span>
<a id="ln-404" name="ln-404" href="#ln-404"></a>
<a id="ln-405" name="ln-405" href="#ln-405"></a><span class="w">        </span><span class="c">! get state:</span>
<a id="ln-406" name="ln-406" href="#ln-406"></a><span class="w">        </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<a id="ln-407" name="ln-407" href="#ln-407"></a><span class="w">        </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span><span class="w"></span>
<a id="ln-408" name="ln-408" href="#ln-408"></a>
<a id="ln-409" name="ln-409" href="#ln-409"></a><span class="w">        </span><span class="c">! compute ephemeris time [sec]:</span>
<a id="ln-410" name="ln-410" href="#ln-410"></a><span class="w">        </span><span class="n">et</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">et_ref</span><span class="w"></span>
<a id="ln-411" name="ln-411" href="#ln-411"></a>
<a id="ln-412" name="ln-412" href="#ln-412"></a><span class="w">        </span><span class="c">! geopotential gravity:</span>
<a id="ln-413" name="ln-413" href="#ln-413"></a><span class="w">        </span><span class="n">rotmat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icrf_to_iau_moon</span><span class="p">(</span><span class="n">et</span><span class="p">)</span><span class="w">   </span><span class="c">! rotation matrix from inertial to body-fixed Moon frame</span>
<a id="ln-414" name="ln-414" href="#ln-414"></a><span class="w">        </span><span class="n">rb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">matmul</span><span class="p">(</span><span class="n">rotmat</span><span class="p">,</span><span class="n">r</span><span class="p">)</span><span class="w">           </span><span class="c">! r in body-fixed frame</span>
<a id="ln-415" name="ln-415" href="#ln-415"></a><span class="w">        </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">grav</span><span class="p">%</span><span class="n">get_acc</span><span class="p">(</span><span class="n">rb</span><span class="p">,</span><span class="n">me</span><span class="p">%</span><span class="n">grav_n</span><span class="p">,</span><span class="n">me</span><span class="p">%</span><span class="n">grav_m</span><span class="p">,</span><span class="n">a_geopot</span><span class="p">)</span><span class="w">  </span><span class="c">! get the acc due to the geopotential</span>
<a id="ln-416" name="ln-416" href="#ln-416"></a><span class="w">        </span><span class="n">a_geopot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">matmul</span><span class="p">(</span><span class="nb">transpose</span><span class="p">(</span><span class="n">rotmat</span><span class="p">),</span><span class="n">a_geopot</span><span class="p">)</span><span class="w">    </span><span class="c">! convert acc back to inertial frame</span>
<a id="ln-417" name="ln-417" href="#ln-417"></a>
<a id="ln-418" name="ln-418" href="#ln-418"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">include_third_bodies</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<a id="ln-419" name="ln-419" href="#ln-419"></a><span class="w">            </span><span class="c">! third-body state vectors (wrt the central body, which is the moon in this case):</span>
<a id="ln-420" name="ln-420" href="#ln-420"></a><span class="w">            </span><span class="c">! [inertial frame]</span>
<a id="ln-421" name="ln-421" href="#ln-421"></a><span class="w">            </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">eph</span><span class="p">%</span><span class="n">get_rv</span><span class="p">(</span><span class="n">et</span><span class="p">,</span><span class="n">body_earth</span><span class="p">,</span><span class="n">body_moon</span><span class="p">,</span><span class="n">rv_earth_wrt_moon</span><span class="p">,</span><span class="n">status_ok</span><span class="p">)</span><span class="w"></span>
<a id="ln-422" name="ln-422" href="#ln-422"></a><span class="w">            </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">eph</span><span class="p">%</span><span class="n">get_rv</span><span class="p">(</span><span class="n">et</span><span class="p">,</span><span class="n">body_sun</span><span class="p">,</span><span class="n">body_moon</span><span class="p">,</span><span class="n">rv_sun_wrt_moon</span><span class="p">,</span><span class="n">status_ok</span><span class="p">)</span><span class="w"></span>
<a id="ln-423" name="ln-423" href="#ln-423"></a>
<a id="ln-424" name="ln-424" href="#ln-424"></a><span class="w">            </span><span class="c">! third-body perturbation (earth &amp; sun):</span>
<a id="ln-425" name="ln-425" href="#ln-425"></a><span class="w">            </span><span class="n">a_third_body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="w"></span>
<a id="ln-426" name="ln-426" href="#ln-426"></a><span class="w">            </span><span class="k">call </span><span class="n">third_body_gravity</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">rv_earth_wrt_moon</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">),</span><span class="n">body_earth</span><span class="p">%</span><span class="n">mu</span><span class="p">,</span><span class="n">a_earth</span><span class="p">)</span><span class="w"></span>
<a id="ln-427" name="ln-427" href="#ln-427"></a><span class="w">            </span><span class="k">call </span><span class="n">third_body_gravity</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">rv_sun_wrt_moon</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">),</span><span class="n">body_sun</span><span class="p">%</span><span class="n">mu</span><span class="p">,</span><span class="n">a_sun</span><span class="p">)</span><span class="w"></span>
<a id="ln-428" name="ln-428" href="#ln-428"></a><span class="w">            </span><span class="n">a_third_body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a_earth</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a_sun</span><span class="w"></span>
<a id="ln-429" name="ln-429" href="#ln-429"></a><span class="w">        </span><span class="k">else</span>
<a id="ln-430" name="ln-430" href="#ln-430"></a><span class="k">            </span><span class="n">a_third_body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span><span class="w"></span>
<a id="ln-431" name="ln-431" href="#ln-431"></a><span class="w">        </span><span class="k">end if</span><span class="w"></span>
<a id="ln-432" name="ln-432" href="#ln-432"></a>
<a id="ln-433" name="ln-433" href="#ln-433"></a><span class="w">        </span><span class="c">!total derivative vector:</span>
<a id="ln-434" name="ln-434" href="#ln-434"></a><span class="w">        </span><span class="n">xdot</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="w"></span>
<a id="ln-435" name="ln-435" href="#ln-435"></a><span class="w">        </span><span class="n">xdot</span><span class="p">(</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a_geopot</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a_third_body</span><span class="w"></span>
<a id="ln-436" name="ln-436" href="#ln-436"></a>
<a id="ln-437" name="ln-437" href="#ln-437"></a><span class="w">    </span><span class="k">class </span><span class="n">default</span><span class="w"></span>
<a id="ln-438" name="ln-438" href="#ln-438"></a><span class="w">        </span><span class="k">error stop</span><span class="w"> </span><span class="s1">&#39;invalid class in ballistic_derivs&#39;</span><span class="w"></span>
<a id="ln-439" name="ln-439" href="#ln-439"></a><span class="w">    </span><span class="k">end select</span>
<a id="ln-440" name="ln-440" href="#ln-440"></a>
<a id="ln-441" name="ln-441" href="#ln-441"></a><span class="k">    end subroutine </span><span class="n">ballistic_derivs</span><span class="w"></span>
<a id="ln-442" name="ln-442" href="#ln-442"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-443" name="ln-443" href="#ln-443"></a>
<a id="ln-444" name="ln-444" href="#ln-444"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-445" name="ln-445" href="#ln-445"></a><span class="w">    </span><span class="k">end module </span><span class="n">altitude_maintenance_module</span><span class="w"></span>
<a id="ln-446" name="ln-446" href="#ln-446"></a><span class="c">!*****************************************************************************************</span>
</pre></div>

    </section>
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>lom was developed by Jacob Williams<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>