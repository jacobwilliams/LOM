<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="Low Lunar Orbit Maintenance">
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>altitude_maintenance.f90 &ndash; lom</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">lom </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>altitude_maintenance.f90
    <small>Source File</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.7% of total for source files.">227 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/altitude_maintenance.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li class="active">altitude_maintenance.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../module/altitude_maintenance_module.html">altitude_maintenance_module</a>
    </div>
  </div>
</div>
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/altitude_maintenance.f90.html#src">altitude_maintenance.f90</a>
  </div>
</div>

</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: sourcefile~~altitude_maintenance.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilealtitude_maintenancef90EfferentGraph" width="641pt" height="708pt"
 viewBox="0.00 0.00 641.00 708.45" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph" class="graph" transform="scale(2.35 2.35) rotate(0) translate(4 1661.57)">
<title>sourcefile~~altitude_maintenance.f90~~EfferentGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1661.57 1503,-1661.57 1503,4 -4,4"/>
<!-- sourcefile~altitude_maintenance.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~altitude_maintenance.f90</title>
<polygon fill="none" stroke="black" points="1499,-366.57 1350,-366.57 1350,-342.57 1499,-342.57 1499,-366.57"/>
<text text-anchor="middle" x="1424.5" y="-352.17" font-family="Helvetica,sans-Serif" font-size="10.50">altitude_maintenance.f90</text>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~fortran_astrodynamics_toolkit.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/fortran_astrodynamics_toolkit.f90.html" xlink:title="fortran_astrodynamics_toolkit.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1314,-446.57 1124,-446.57 1124,-422.57 1314,-422.57 1314,-446.57"/>
<text text-anchor="middle" x="1219" y="-432.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fortran_astrodynamics_toolkit.f90</text>
</a>
</g>
</g>
<!-- sourcefile~altitude_maintenance.f90&#45;&gt;sourcefile~fortran_astrodynamics_toolkit.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~altitude_maintenance.f90&#45;&gt;sourcefile~fortran_astrodynamics_toolkit.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1392.59,-366.72C1357.13,-380.66 1298.87,-403.56 1259.98,-418.85"/>
<polygon fill="#000000" stroke="#000000" points="1258.56,-415.65 1250.53,-422.57 1261.12,-422.16 1258.56,-415.65"/>
</g>
<!-- sourcefile~ddeabm_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~ddeabm_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/ddeabm_module.f90.html" xlink:title="ddeabm_module.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1281.5,-345.57 1156.5,-345.57 1156.5,-321.57 1281.5,-321.57 1281.5,-345.57"/>
<text text-anchor="middle" x="1219" y="-331.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ddeabm_module.F90</text>
</a>
</g>
</g>
<!-- sourcefile~altitude_maintenance.f90&#45;&gt;sourcefile~ddeabm_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~altitude_maintenance.f90&#45;&gt;sourcefile~ddeabm_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1349.74,-346.96C1330.85,-345.01 1310.55,-342.91 1291.76,-340.97"/>
<polygon fill="#000000" stroke="#000000" points="1292.09,-337.49 1281.78,-339.94 1291.37,-344.45 1292.09,-337.49"/>
</g>
<!-- sourcefile~conversion_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~conversion_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/conversion_module.f90.html" xlink:title="conversion_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="454.5,-431.57 317.5,-431.57 317.5,-407.57 454.5,-407.57 454.5,-431.57"/>
<text text-anchor="middle" x="386" y="-417.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">conversion_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~conversion_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~conversion_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008,-640.57C1006.81,-641.11 693.24,-436.97 692,-436.57 617.59,-412.37 527.65,-410.41 464.79,-413.1"/>
<polygon fill="#000000" stroke="#000000" points="464.37,-409.62 454.55,-413.59 464.7,-416.61 464.37,-409.62"/>
</g>
<!-- sourcefile~bplane_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~bplane_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/bplane_module.f90.html" xlink:title="bplane_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="653,-1373.57 538,-1373.57 538,-1349.57 653,-1349.57 653,-1373.57"/>
<text text-anchor="middle" x="595.5" y="-1359.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bplane_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~bplane_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~bplane_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-1443.57C755.09,-1465.25 747.52,-1402.63 692,-1382.57 682.78,-1379.24 672.86,-1376.34 663.02,-1373.85"/>
<polygon fill="#000000" stroke="#000000" points="663.79,-1370.43 653.25,-1371.49 662.15,-1377.24 663.79,-1370.43"/>
</g>
<!-- sourcefile~geodesy_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~geodesy_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/geodesy_module.f90.html" xlink:title="geodesy_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="448,-1577.57 324,-1577.57 324,-1553.57 448,-1553.57 448,-1577.57"/>
<text text-anchor="middle" x="386" y="-1563.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">geodesy_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~geodesy_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~geodesy_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-1565.57C549.4,-1570.77 498.41,-1570.85 458.27,-1569.59"/>
<polygon fill="#000000" stroke="#000000" points="458.16,-1566.08 448.04,-1569.23 457.92,-1573.08 458.16,-1566.08"/>
</g>
<!-- sourcefile~eispack_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~eispack_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/eispack_module.f90.html" xlink:title="eispack_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="445.5,-1535.57 326.5,-1535.57 326.5,-1511.57 445.5,-1511.57 445.5,-1535.57"/>
<text text-anchor="middle" x="386" y="-1521.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eispack_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~eispack_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~eispack_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-1565.57C565.23,-1568.94 491.25,-1551.62 440.03,-1538.2"/>
<polygon fill="#000000" stroke="#000000" points="440.67,-1534.75 430.11,-1535.57 438.88,-1541.52 440.67,-1534.75"/>
</g>
<!-- sourcefile~math_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~math_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/math_module.f90.html" xlink:title="math_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439,-747.57 333,-747.57 333,-723.57 439,-723.57 439,-747.57"/>
<text text-anchor="middle" x="386" y="-733.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">math_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~math_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~math_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-581.57C770.28,-575.62 757.78,-592.61 728,-619.57 704.66,-640.7 717.84,-662.58 692,-680.57 619.79,-730.82 515.41,-739.32 449.4,-738.9"/>
<polygon fill="#000000" stroke="#000000" points="449.19,-735.39 439.15,-738.76 449.1,-742.39 449.19,-735.39"/>
</g>
<!-- sourcefile~geopotential_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~geopotential_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node10"><a xlink:href=".././sourcefile/geopotential_module.f90.html" xlink:title="geopotential_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="668.5,-1201.57 522.5,-1201.57 522.5,-1177.57 668.5,-1177.57 668.5,-1201.57"/>
<text text-anchor="middle" x="595.5" y="-1187.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">geopotential_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~geopotential_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~geopotential_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1215.97,-446.83C1196.4,-562.83 1037.36,-1462.09 812,-1443.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-1443.57C781.53,-1454.81 653.16,-1272.29 610.4,-1210.01"/>
<polygon fill="#000000" stroke="#000000" points="613.27,-1208.01 604.74,-1201.73 607.5,-1211.96 613.27,-1208.01"/>
</g>
<!-- sourcefile~random_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~random_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node11"><a xlink:href=".././sourcefile/random_module.f90.html" xlink:title="random_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="446.5,-1333.57 325.5,-1333.57 325.5,-1309.57 446.5,-1309.57 446.5,-1333.57"/>
<text text-anchor="middle" x="386" y="-1319.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">random_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~random_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~random_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-1443.57C708.35,-1483.71 705.07,-1553.05 596.5,-1565.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-1565.57C544.47,-1571.34 529.18,-1544.89 499,-1504.57 464.62,-1458.62 495.24,-1428.04 463,-1380.57 451.55,-1363.7 433.74,-1349.51 418.24,-1339.27"/>
<polygon fill="#000000" stroke="#000000" points="419.77,-1336.1 409.45,-1333.71 416.03,-1342.01 419.77,-1336.1"/>
</g>
<!-- sourcefile~rk_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~rk_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node12"><a xlink:href=".././sourcefile/rk_module.f90.html" xlink:title="rk_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="640,-945.57 551,-945.57 551,-921.57 640,-921.57 640,-945.57"/>
<text text-anchor="middle" x="595.5" y="-931.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rk_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~rk_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~rk_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008,-640.57C915.97,-682.74 957.72,-757.2 930,-854.57 908.5,-930.1 947.28,-969.87 894,-1027.57 868.24,-1055.47 844.47,-1031.88 812,-1051.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-1051.57C753.14,-1086.05 751.47,-989.33 692,-959.57 679.02,-953.07 664.2,-948.03 650.18,-944.19"/>
<polygon fill="#000000" stroke="#000000" points="650.7,-940.71 640.14,-941.61 648.95,-947.49 650.7,-940.71"/>
</g>
<!-- sourcefile~brent_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~brent_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node13"><a xlink:href=".././sourcefile/brent_module.f90.html" xlink:title="brent_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439,-983.57 333,-983.57 333,-959.57 439,-959.57 439,-983.57"/>
<text text-anchor="middle" x="386" y="-969.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">brent_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~brent_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~brent_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-1011.57C545.84,-1000.87 490.41,-990.27 449.09,-982.67"/>
<polygon fill="#000000" stroke="#000000" points="449.64,-979.21 439.17,-980.85 448.38,-986.09 449.64,-979.21"/>
</g>
<!-- sourcefile~base_class_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~base_class_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node14"><a xlink:href=".././sourcefile/base_class_module.f90.html" xlink:title="base_class_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="273,-83.57 137,-83.57 137,-59.57 273,-59.57 273,-83.57"/>
<text text-anchor="middle" x="205" y="-69.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">base_class_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~base_class_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~base_class_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1197.63,-422.48C1176.16,-408.69 1142.9,-384.2 1124,-354.57 1091.75,-304.03 1113.38,-278.88 1088,-224.57 1062.16,-169.28 1063.55,-140.83 1010,-111.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008,-111.57C976.69,-94.46 960.41,-111.23 930,-92.57 909.05,-79.71 914.88,-63.55 894,-50.57 862.05,-30.7 848.09,-40.18 812,-29.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-29.57C610.94,28.93 359.77,-27.75 255.19,-56.77"/>
<polygon fill="#000000" stroke="#000000" points="254.21,-53.41 245.53,-59.49 256.11,-60.15 254.21,-53.41"/>
</g>
<!-- sourcefile~vector_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~vector_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node15"><a xlink:href=".././sourcefile/vector_module.f90.html" xlink:title="vector_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="442,-1177.57 330,-1177.57 330,-1153.57 442,-1153.57 442,-1177.57"/>
<text text-anchor="middle" x="386" y="-1163.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">vector_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~vector_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~vector_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-1051.57C778.39,-1070.74 759.46,-1046.14 728,-1065.57 705.01,-1079.76 714.8,-1100.06 692,-1114.57 655.49,-1137.8 636.67,-1117.46 596.5,-1133.57"/>
</g>
<!-- sourcefile~complex_step.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~complex_step.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node16"><a xlink:href=".././sourcefile/complex_step.f90.html" xlink:title="complex_step.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="258,-1657.57 152,-1657.57 152,-1633.57 258,-1633.57 258,-1657.57"/>
<text text-anchor="middle" x="205" y="-1643.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">complex_step.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~complex_step.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~complex_step.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-1605.57C336.85,-1603.99 283.1,-1618.25 247.19,-1630.17"/>
<polygon fill="#000000" stroke="#000000" points="245.88,-1626.92 237.55,-1633.46 248.14,-1633.54 245.88,-1626.92"/>
</g>
<!-- sourcefile~crtbp_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~crtbp_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node17"><a xlink:href=".././sourcefile/crtbp_module.f90.html" xlink:title="crtbp_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="648.5,-671.57 542.5,-671.57 542.5,-647.57 648.5,-647.57 648.5,-671.57"/>
<text text-anchor="middle" x="595.5" y="-657.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">crtbp_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~crtbp_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~crtbp_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-581.57C738.65,-570.83 660.31,-615.22 621.36,-641.47"/>
<polygon fill="#000000" stroke="#000000" points="619.02,-638.83 612.78,-647.39 623,-644.59 619.02,-638.83"/>
</g>
<!-- sourcefile~minpack_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~minpack_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node18"><a xlink:href=".././sourcefile/minpack_module.f90.html" xlink:title="minpack_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="448,-903.57 324,-903.57 324,-879.57 448,-879.57 448,-903.57"/>
<text text-anchor="middle" x="386" y="-889.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">minpack_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~minpack_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~minpack_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-1051.57C807.42,-1053.13 599.45,-1012.22 596.5,-1011.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-1011.57C551.76,-1002.17 536.92,-1009.41 499,-987.57 479.12,-976.11 480.1,-965.86 463,-950.57 446.76,-936.05 427.35,-921.01 412.2,-909.75"/>
<polygon fill="#000000" stroke="#000000" points="413.97,-906.7 403.84,-903.59 409.82,-912.34 413.97,-906.7"/>
</g>
<!-- sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~kind_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node19"><a xlink:href=".././sourcefile/kind_module.f90.html" xlink:title="kind_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="101,-1345.57 0,-1345.57 0,-1321.57 101,-1321.57 101,-1345.57"/>
<text text-anchor="middle" x="50.5" y="-1331.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kind_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-1605.57C226.61,-1600.39 101.74,-1417.06 63.58,-1354.35"/>
<polygon fill="#000000" stroke="#000000" points="66.53,-1352.47 58.4,-1345.69 60.53,-1356.07 66.53,-1352.47"/>
</g>
<!-- sourcefile~drag_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~drag_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node20"><a xlink:href=".././sourcefile/drag_module.f90.html" xlink:title="drag_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="256.5,-1436.57 153.5,-1436.57 153.5,-1412.57 256.5,-1412.57 256.5,-1436.57"/>
<text text-anchor="middle" x="205" y="-1422.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">drag_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~drag_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~drag_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-1565.57C501.2,-1576.33 480.87,-1608.64 387,-1605.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-1605.57C350.2,-1604.43 337.24,-1606.93 309,-1586.57 259.02,-1550.53 227.51,-1482.06 213.86,-1446.79"/>
<polygon fill="#000000" stroke="#000000" points="216.98,-1445.12 210.2,-1436.98 210.42,-1447.57 216.98,-1445.12"/>
</g>
<!-- sourcefile~geometry_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~geometry_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node21"><a xlink:href=".././sourcefile/geometry_module.f90.html" xlink:title="geometry_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="660.5,-1495.57 530.5,-1495.57 530.5,-1471.57 660.5,-1471.57 660.5,-1495.57"/>
<text text-anchor="middle" x="595.5" y="-1481.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">geometry_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~geometry_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~geometry_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-1443.57C765.61,-1461.1 712.93,-1471.07 671,-1476.68"/>
<polygon fill="#000000" stroke="#000000" points="670.33,-1473.23 660.86,-1477.97 671.22,-1480.18 670.33,-1473.23"/>
</g>
<!-- sourcefile~gravity_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~gravity_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node22"><a xlink:href=".././sourcefile/gravity_module.f90.html" xlink:title="gravity_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443.5,-1455.57 328.5,-1455.57 328.5,-1431.57 443.5,-1431.57 443.5,-1455.57"/>
<text text-anchor="middle" x="386" y="-1441.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gravity_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~gravity_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~gravity_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-1443.57C547.57,-1441.22 494.59,-1441.27 453.91,-1441.87"/>
<polygon fill="#000000" stroke="#000000" points="453.78,-1438.38 443.84,-1442.04 453.9,-1445.38 453.78,-1438.38"/>
</g>
<!-- sourcefile~rk_module_variable_step.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~rk_module_variable_step.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node23"><a xlink:href=".././sourcefile/rk_module_variable_step.f90.html" xlink:title="rk_module_variable_step.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="894,-780.57 728,-780.57 728,-756.57 894,-756.57 894,-780.57"/>
<text text-anchor="middle" x="811" y="-766.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rk_module_variable_step.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~rk_module_variable_step.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~rk_module_variable_step.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008,-640.57C940.55,-670.54 870.16,-722.4 834.95,-750.02"/>
<polygon fill="#000000" stroke="#000000" points="832.44,-747.53 826.77,-756.49 836.79,-753.02 832.44,-747.53"/>
</g>
<!-- sourcefile~modified_equinoctial_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~modified_equinoctial_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node24"><a xlink:href=".././sourcefile/modified_equinoctial_module.f90.html" xlink:title="modified_equinoctial_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="690.5,-1105.57 500.5,-1105.57 500.5,-1081.57 690.5,-1081.57 690.5,-1105.57"/>
<text text-anchor="middle" x="595.5" y="-1091.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modified_equinoctial_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~modified_equinoctial_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~modified_equinoctial_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-1051.57C778.39,-1070.74 764.31,-1058.61 728,-1065.57 705.93,-1069.8 681.87,-1074.81 660.43,-1079.41"/>
<polygon fill="#000000" stroke="#000000" points="659.5,-1076.03 650.46,-1081.56 660.98,-1082.87 659.5,-1076.03"/>
</g>
<!-- sourcefile~iau_orientation_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~iau_orientation_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node25"><a xlink:href=".././sourcefile/iau_orientation_module.f90.html" xlink:title="iau_orientation_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="675,-553.57 516,-553.57 516,-529.57 675,-529.57 675,-553.57"/>
<text text-anchor="middle" x="595.5" y="-539.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iau_orientation_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~iau_orientation_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~iau_orientation_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-581.57C761.25,-574.23 706.62,-563.95 664.82,-555.66"/>
<polygon fill="#000000" stroke="#000000" points="665.25,-552.17 654.76,-553.65 663.88,-559.04 665.25,-552.17"/>
</g>
<!-- sourcefile~matrix_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~matrix_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node26"><a xlink:href=".././sourcefile/matrix_module.f90.html" xlink:title="matrix_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="442.5,-629.57 329.5,-629.57 329.5,-605.57 442.5,-605.57 442.5,-629.57"/>
<text text-anchor="middle" x="386" y="-615.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matrix_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~matrix_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~matrix_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-581.57C681.97,-562.29 530.46,-586.42 447.99,-603.46"/>
<polygon fill="#000000" stroke="#000000" points="447.1,-600.07 438.04,-605.56 448.54,-606.92 447.1,-600.07"/>
</g>
<!-- sourcefile~gooding_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~gooding_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node27"><a xlink:href=".././sourcefile/gooding_module.f90.html" xlink:title="gooding_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447,-1413.57 325,-1413.57 325,-1389.57 447,-1389.57 447,-1413.57"/>
<text text-anchor="middle" x="386" y="-1399.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gooding_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~gooding_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~gooding_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-1443.57C721.74,-1478.42 691.27,-1448.31 596.5,-1443.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-1443.57C566.45,-1442.17 497.95,-1427.47 447.29,-1415.85"/>
<polygon fill="#000000" stroke="#000000" points="447.94,-1412.41 437.41,-1413.58 446.37,-1419.23 447.94,-1412.41"/>
</g>
<!-- sourcefile~relative_motion_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~relative_motion_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node28"><a xlink:href=".././sourcefile/relative_motion_module.f90.html" xlink:title="relative_motion_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="676,-1063.57 515,-1063.57 515,-1039.57 676,-1039.57 676,-1063.57"/>
<text text-anchor="middle" x="595.5" y="-1049.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">relative_motion_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~relative_motion_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~relative_motion_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-1051.57C789.47,-1064.02 735.02,-1063.87 686.26,-1060.68"/>
<polygon fill="#000000" stroke="#000000" points="686.49,-1057.19 676.27,-1059.98 686,-1064.17 686.49,-1057.19"/>
</g>
<!-- sourcefile~transformation_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~transformation_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node29"><a xlink:href=".././sourcefile/transformation_module.f90.html" xlink:title="transformation_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1088,-257.57 930,-257.57 930,-233.57 1088,-233.57 1088,-257.57"/>
<text text-anchor="middle" x="1009" y="-243.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">transformation_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~transformation_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~transformation_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1203.12,-422.36C1184.39,-406.88 1151.37,-379.26 1124,-354.57 1089.99,-323.88 1051.75,-286.76 1029.33,-264.71"/>
<polygon fill="#000000" stroke="#000000" points="1031.67,-262.11 1022.1,-257.58 1026.76,-267.09 1031.67,-262.11"/>
</g>
<!-- sourcefile~halo_orbit_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~halo_orbit_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node30"><a xlink:href=".././sourcefile/halo_orbit_module.f90.html" xlink:title="halo_orbit_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="877,-652.57 745,-652.57 745,-628.57 877,-628.57 877,-652.57"/>
<text text-anchor="middle" x="811" y="-638.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">halo_orbit_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~halo_orbit_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~halo_orbit_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008,-640.57C968.32,-658.2 919.51,-658.25 880.52,-653.87"/>
<polygon fill="#000000" stroke="#000000" points="880.67,-650.37 870.31,-652.6 879.8,-657.31 880.67,-650.37"/>
</g>
<!-- sourcefile~string_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node31" class="node">
<title>sourcefile~string_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node31"><a xlink:href=".././sourcefile/string_module.f90.html" xlink:title="string_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1063.5,-446.57 954.5,-446.57 954.5,-422.57 1063.5,-422.57 1063.5,-446.57"/>
<text text-anchor="middle" x="1009" y="-432.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">string_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~string_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~string_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1123.74,-434.57C1106.81,-434.57 1089.53,-434.57 1073.72,-434.57"/>
<polygon fill="#000000" stroke="#000000" points="1073.57,-431.07 1063.57,-434.57 1073.57,-438.07 1073.57,-431.07"/>
</g>
<!-- sourcefile~standish_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node32" class="node">
<title>sourcefile~standish_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node32"><a xlink:href=".././sourcefile/standish_module.f90.html" xlink:title="standish_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="872.5,-83.57 749.5,-83.57 749.5,-59.57 872.5,-59.57 872.5,-83.57"/>
<text text-anchor="middle" x="811" y="-69.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">standish_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~standish_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~standish_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008,-111.57C996.84,-105.47 934.28,-93.25 882.79,-83.92"/>
<polygon fill="#000000" stroke="#000000" points="883.12,-80.42 872.66,-82.09 881.88,-87.31 883.12,-80.42"/>
</g>
<!-- sourcefile~kepler_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node33" class="node">
<title>sourcefile~kepler_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node33"><a xlink:href=".././sourcefile/kepler_module.f90.html" xlink:title="kepler_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="651.5,-511.57 539.5,-511.57 539.5,-487.57 651.5,-487.57 651.5,-511.57"/>
<text text-anchor="middle" x="595.5" y="-497.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">kepler_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~kepler_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~kepler_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-581.57C751.62,-572.78 747.52,-540.63 692,-520.57 682.32,-517.07 671.87,-514.05 661.56,-511.48"/>
<polygon fill="#000000" stroke="#000000" points="662.28,-508.05 651.74,-509.15 660.66,-514.87 662.28,-508.05"/>
</g>
<!-- sourcefile~analytical_ephemeris_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node34" class="node">
<title>sourcefile~analytical_ephemeris_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node34"><a xlink:href=".././sourcefile/analytical_ephemeris_module.f90.html" xlink:title="analytical_ephemeris_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="692,-469.57 499,-469.57 499,-445.57 692,-445.57 692,-469.57"/>
<text text-anchor="middle" x="595.5" y="-455.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">analytical_ephemeris_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~analytical_ephemeris_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~analytical_ephemeris_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008,-640.57C924.87,-677.51 901.96,-595.11 812,-581.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-581.57C764.28,-574.68 762.01,-548.88 728,-517.57 710.64,-501.59 712.46,-490.31 692,-478.57 688.71,-476.68 685.28,-474.97 681.74,-473.4"/>
<polygon fill="#000000" stroke="#000000" points="682.75,-470.04 672.17,-469.62 680.18,-476.55 682.75,-470.04"/>
</g>
<!-- sourcefile~celestial_body_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node35" class="node">
<title>sourcefile~celestial_body_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node35"><a xlink:href=".././sourcefile/celestial_body_module.f90.html" xlink:title="celestial_body_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463,-237.57 309,-237.57 309,-213.57 463,-213.57 463,-237.57"/>
<text text-anchor="middle" x="386" y="-223.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">celestial_body_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~celestial_body_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~celestial_body_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-29.57C676.9,9.22 618.24,17.15 499,-53.57 468.99,-71.36 419.37,-162.56 397.69,-204.46"/>
<polygon fill="#000000" stroke="#000000" points="394.49,-203.03 393.04,-213.53 400.72,-206.23 394.49,-203.03"/>
</g>
<!-- sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node36" class="node">
<title>sourcefile~numbers_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node36"><a xlink:href=".././sourcefile/numbers_module.f90.html" xlink:title="numbers_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="268,-863.57 142,-863.57 142,-839.57 268,-839.57 268,-863.57"/>
<text text-anchor="middle" x="205" y="-849.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">numbers_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-1011.57C470.3,-984.26 420.41,-1053.89 309,-992.57 260.59,-965.92 228.9,-905.74 214.66,-873.29"/>
<polygon fill="#000000" stroke="#000000" points="217.77,-871.65 210.65,-863.8 211.32,-874.37 217.77,-871.65"/>
</g>
<!-- sourcefile~obliquity_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node37" class="node">
<title>sourcefile~obliquity_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node37"><a xlink:href=".././sourcefile/obliquity_module.f90.html" xlink:title="obliquity_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="873,-353.57 749,-353.57 749,-329.57 873,-329.57 873,-353.57"/>
<text text-anchor="middle" x="811" y="-339.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">obliquity_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~obliquity_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~obliquity_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1210.57,-446.59C1186.86,-483.72 1108.7,-596.71 1010,-640.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008,-640.57C992.73,-647.35 864.43,-431.1 824.09,-362.28"/>
<polygon fill="#000000" stroke="#000000" points="827.07,-360.45 819,-353.59 821.03,-363.99 827.07,-360.45"/>
</g>
<!-- sourcefile~time_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node38" class="node">
<title>sourcefile~time_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node38"><a xlink:href=".././sourcefile/time_module.f90.html" xlink:title="time_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="647,-161.57 544,-161.57 544,-137.57 647,-137.57 647,-161.57"/>
<text text-anchor="middle" x="595.5" y="-147.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">time_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~time_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~time_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008,-111.57C930.14,-69.01 900.5,-156.01 812,-149.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-149.57C758.6,-145.82 700.06,-146.15 657.29,-147.22"/>
<polygon fill="#000000" stroke="#000000" points="656.95,-143.73 647.05,-147.5 657.14,-150.73 656.95,-143.73"/>
</g>
<!-- sourcefile~lambert_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node39" class="node">
<title>sourcefile~lambert_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node39"><a xlink:href=".././sourcefile/lambert_module.f90.html" xlink:title="lambert_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="656,-1415.57 535,-1415.57 535,-1391.57 656,-1391.57 656,-1415.57"/>
<text text-anchor="middle" x="595.5" y="-1401.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lambert_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~lambert_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~lambert_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-1443.57C795.74,-1449.2 713.47,-1431.54 655.33,-1417.91"/>
<polygon fill="#000000" stroke="#000000" points="656.04,-1414.48 645.5,-1415.59 654.43,-1421.29 656.04,-1414.48"/>
</g>
<!-- sourcefile~jpl_ephemeris_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node40" class="node">
<title>sourcefile~jpl_ephemeris_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node40"><a xlink:href=".././sourcefile/jpl_ephemeris_module.f90.html" xlink:title="jpl_ephemeris_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="888,-201.57 734,-201.57 734,-177.57 888,-177.57 888,-201.57"/>
<text text-anchor="middle" x="811" y="-187.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jpl_ephemeris_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~jpl_ephemeris_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~jpl_ephemeris_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008,-111.57C959.13,-84.86 945.97,-143.56 894,-163.57 884.18,-167.35 873.55,-171.02 863.3,-174.35"/>
<polygon fill="#000000" stroke="#000000" points="862.1,-171.06 853.63,-177.44 864.22,-177.73 862.1,-171.06"/>
</g>
<!-- sourcefile~orbital_mechanics_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node41" class="node">
<title>sourcefile~orbital_mechanics_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node41"><a xlink:href=".././sourcefile/orbital_mechanics_module.f90.html" xlink:title="orbital_mechanics_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="683.5,-827.57 507.5,-827.57 507.5,-803.57 683.5,-803.57 683.5,-827.57"/>
<text text-anchor="middle" x="595.5" y="-813.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">orbital_mechanics_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~orbital_mechanics_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~orbital_mechanics_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008,-640.57C886.26,-694.67 836.92,-670.86 728,-747.57 707.9,-761.72 712.78,-776.43 692,-789.57 685.47,-793.7 678.28,-797.18 670.87,-800.12"/>
<polygon fill="#000000" stroke="#000000" points="669.6,-796.85 661.39,-803.55 671.99,-803.44 669.6,-796.85"/>
</g>
<!-- sourcefile~c_interface_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node42" class="node">
<title>sourcefile~c_interface_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node42"><a xlink:href=".././sourcefile/c_interface_module.f90.html" xlink:title="c_interface_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1078,-887.57 940,-887.57 940,-863.57 1078,-863.57 1078,-887.57"/>
<text text-anchor="middle" x="1009" y="-873.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">c_interface_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~c_interface_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~c_interface_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1212.22,-446.82C1183.65,-507.4 1057.41,-775.06 1020.29,-853.74"/>
<polygon fill="#000000" stroke="#000000" points="1016.95,-852.63 1015.85,-863.16 1023.28,-855.61 1016.95,-852.63"/>
</g>
<!-- sourcefile~ephemeris_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node43" class="node">
<title>sourcefile~ephemeris_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node43"><a xlink:href=".././sourcefile/ephemeris_module.f90.html" xlink:title="ephemeris_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="663.5,-119.57 527.5,-119.57 527.5,-95.57 663.5,-95.57 663.5,-119.57"/>
<text text-anchor="middle" x="595.5" y="-105.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ephemeris_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~ephemeris_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~fortran_astrodynamics_toolkit.f90&#45;&gt;sourcefile~ephemeris_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008,-111.57C931.56,-69.79 897.82,-126.51 812,-111.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-111.57C765.39,-103.8 714.74,-102.53 673.98,-103.33"/>
<polygon fill="#000000" stroke="#000000" points="673.75,-99.84 663.84,-103.58 673.92,-106.84 673.75,-99.84"/>
</g>
<!-- sourcefile~root_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~root_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/root_module.f90.html" xlink:title="root_module.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1060,-83.57 958,-83.57 958,-59.57 1060,-59.57 1060,-83.57"/>
<text text-anchor="middle" x="1009" y="-69.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">root_module.F90</text>
</a>
</g>
</g>
<!-- sourcefile~ddeabm_module.f90&#45;&gt;sourcefile~root_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~ddeabm_module.f90&#45;&gt;sourcefile~root_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1214.79,-321.5C1203.9,-282.94 1164.74,-161.49 1088,-97.57 1082.62,-93.09 1076.44,-89.37 1069.96,-86.29"/>
<polygon fill="#000000" stroke="#000000" points="1070.89,-82.88 1060.32,-82.21 1068.16,-89.33 1070.89,-82.88"/>
</g>
<!-- sourcefile~conversion_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~conversion_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M367.24,-407.52C328,-381.6 235.15,-324.26 206,-341.57"/>
</g>
<!-- sourcefile~conversion_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~conversion_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M362.48,-431.66C345.38,-441.96 322.57,-458.3 309,-478.57 231.23,-594.7 211.84,-768.43 207.3,-829.44"/>
<polygon fill="#000000" stroke="#000000" points="203.81,-829.26 206.62,-839.48 210.79,-829.74 203.81,-829.26"/>
</g>
<!-- sourcefile~bplane_module.f90&#45;&gt;sourcefile~vector_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~bplane_module.f90&#45;&gt;sourcefile~vector_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M588.33,-1349.31C572.11,-1318.31 525.21,-1236.08 463,-1191.57 457.59,-1187.7 451.56,-1184.37 445.32,-1181.51"/>
<polygon fill="#000000" stroke="#000000" points="446.67,-1178.28 436.09,-1177.65 443.97,-1184.74 446.67,-1178.28"/>
</g>
<!-- sourcefile~bplane_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~bplane_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-1243.57C353.8,-1218.9 244.46,-1233.42 206,-1243.57"/>
</g>
<!-- sourcefile~bplane_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~bplane_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M580.85,-1349.56C557.95,-1329.95 509.7,-1290.89 463,-1267.57 431.31,-1251.74 414.79,-1265.54 387,-1243.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-1243.57C357.21,-1221.6 333.63,-1245.02 309,-1219.57 212.39,-1119.71 204.91,-936.96 205.39,-873.76"/>
<polygon fill="#000000" stroke="#000000" points="208.89,-873.77 205.55,-863.72 201.89,-873.66 208.89,-873.77"/>
</g>
<!-- sourcefile~geodesy_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~geodesy_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M323.64,-1555.06C318.23,-1552.31 313.22,-1548.87 309,-1544.57 263.72,-1498.39 293.55,-1464.89 273,-1403.57 248.51,-1330.47 280.55,-1223.91 206,-1243.57"/>
</g>
<!-- sourcefile~geodesy_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~geodesy_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M323.74,-1556.02C318.17,-1553.1 313.09,-1549.35 309,-1544.57 263.21,-1491.02 283.15,-1299.29 273,-1229.57 253.19,-1093.57 221.82,-931.4 210.37,-873.47"/>
<polygon fill="#000000" stroke="#000000" points="213.79,-872.73 208.41,-863.6 206.93,-874.09 213.79,-872.73"/>
</g>
<!-- sourcefile~eispack_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~eispack_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M330.16,-1511.4C322.4,-1507.89 315.02,-1503.38 309,-1497.57 265.16,-1455.28 264.9,-1228.04 206,-1243.57"/>
</g>
<!-- sourcefile~eispack_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~eispack_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M361.09,-1511.48C343.71,-1501.38 321.19,-1485.3 309,-1464.57 255.46,-1373.47 290.22,-1333.82 273,-1229.57 250.6,-1093.97 220.81,-931.56 210.08,-873.51"/>
<polygon fill="#000000" stroke="#000000" points="213.51,-872.82 208.24,-863.63 206.62,-874.1 213.51,-872.82"/>
</g>
<!-- sourcefile~math_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~math_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M373.21,-723.35C356.85,-705.84 327.23,-672 309,-638.57 242.11,-515.91 326.12,-270.22 206,-341.57"/>
</g>
<!-- sourcefile~math_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~math_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M340.32,-747.62C329.7,-751.36 318.66,-755.99 309,-761.57 275.6,-780.86 243.12,-811.91 223.83,-832.02"/>
<polygon fill="#000000" stroke="#000000" points="221.19,-829.72 216.88,-839.4 226.29,-834.52 221.19,-829.72"/>
</g>
<!-- sourcefile~geopotential_module.f90&#45;&gt;sourcefile~conversion_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~geopotential_module.f90&#45;&gt;sourcefile~conversion_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M569.11,-1177.53C546.31,-1165.21 514.17,-1143.75 499,-1114.57 430.33,-982.47 552.8,-564.32 463,-445.57 460.68,-442.5 457.97,-439.78 454.99,-437.39"/>
<polygon fill="#000000" stroke="#000000" points="456.8,-434.39 446.53,-431.77 452.92,-440.22 456.8,-434.39"/>
</g>
<!-- sourcefile~geopotential_module.f90&#45;&gt;sourcefile~random_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~geopotential_module.f90&#45;&gt;sourcefile~random_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M575.35,-1201.75C538.45,-1225.23 457.35,-1276.81 414.61,-1304"/>
<polygon fill="#000000" stroke="#000000" points="412.66,-1301.09 406.1,-1309.42 416.42,-1307 412.66,-1301.09"/>
</g>
<!-- sourcefile~geopotential_module.f90&#45;&gt;sourcefile~vector_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~geopotential_module.f90&#45;&gt;sourcefile~vector_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M522.22,-1181.21C499.4,-1178.57 474.33,-1175.67 452.05,-1173.09"/>
<polygon fill="#000000" stroke="#000000" points="452.36,-1169.6 442.02,-1171.93 451.55,-1176.56 452.36,-1169.6"/>
</g>
<!-- sourcefile~geopotential_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~geopotential_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-1205.57C307.82,-1179.93 284.64,-1222.81 206,-1243.57"/>
</g>
<!-- sourcefile~geopotential_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~geopotential_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M554.76,-1201.62C512.15,-1212.5 443.06,-1224.19 387,-1205.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-1205.57C351.96,-1194.59 334.27,-1210.52 309,-1186.57 217.53,-1099.85 206.65,-934.12 205.83,-874.03"/>
<polygon fill="#000000" stroke="#000000" points="209.33,-873.76 205.78,-863.78 202.33,-873.8 209.33,-873.76"/>
</g>
<!-- sourcefile~random_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~random_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M346.34,-1309.49C334.25,-1305.41 320.95,-1300.6 309,-1295.57 261.74,-1275.67 255.59,-1230.49 206,-1243.57"/>
</g>
<!-- sourcefile~rk_module.f90&#45;&gt;sourcefile~brent_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~rk_module.f90&#45;&gt;sourcefile~brent_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M550.75,-941.58C521.22,-946.99 481.82,-954.2 449.07,-960.2"/>
<polygon fill="#000000" stroke="#000000" points="448.34,-956.78 439.13,-962.02 449.6,-963.66 448.34,-956.78"/>
</g>
<!-- sourcefile~rk_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~rk_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M550.97,-930.48C480.6,-926.41 345.97,-922.69 309,-950.57 198.79,-1033.68 339.46,-1208.32 206,-1243.57"/>
</g>
<!-- sourcefile~rk_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~rk_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M574.84,-921.51C539.05,-900.57 460.22,-859 387,-851.57"/>
</g>
<!-- sourcefile~brent_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~brent_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M366.55,-983.77C349.88,-995.51 325.51,-1014.53 309,-1035.57 245.32,-1116.72 305.75,-1217.26 206,-1243.57"/>
</g>
<!-- sourcefile~brent_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~brent_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M366.85,-959.4C335.14,-938.14 269.52,-894.15 232.65,-869.43"/>
<polygon fill="#000000" stroke="#000000" points="234.19,-866.25 223.93,-863.59 230.29,-872.06 234.19,-866.25"/>
</g>
<!-- sourcefile~vector_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~vector_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M346.34,-1177.65C334.25,-1181.73 320.95,-1186.53 309,-1191.57 261.74,-1211.47 255.59,-1230.49 206,-1243.57"/>
</g>
<!-- sourcefile~vector_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~vector_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M365.88,-1153.4C348.99,-1141.82 324.67,-1123.02 309,-1101.57 254.53,-1026.99 222.95,-919.4 211.25,-873.57"/>
<polygon fill="#000000" stroke="#000000" points="214.63,-872.65 208.81,-863.79 207.83,-874.34 214.63,-872.65"/>
</g>
<!-- sourcefile~complex_step.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~complex_step.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M156.61,-1633.53C149.31,-1629.99 142.42,-1625.43 137,-1619.57 65.93,-1542.59 53.79,-1408.83 51.82,-1355.98"/>
<polygon fill="#000000" stroke="#000000" points="55.31,-1355.6 51.54,-1345.71 48.32,-1355.8 55.31,-1355.6"/>
</g>
<!-- sourcefile~crtbp_module.f90&#45;&gt;sourcefile~math_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~crtbp_module.f90&#45;&gt;sourcefile~math_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M561.62,-671.61C525.91,-684.69 468.73,-705.63 429.6,-719.96"/>
<polygon fill="#000000" stroke="#000000" points="428.25,-716.73 420.07,-723.46 430.66,-723.3 428.25,-716.73"/>
</g>
<!-- sourcefile~crtbp_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~crtbp_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M557.94,-647.49C538.99,-640.01 516.27,-629.06 499,-614.57 477.75,-596.73 485.4,-579.94 463,-563.57 434.4,-542.67 417.07,-558.29 387,-539.57"/>
</g>
<!-- sourcefile~crtbp_module.f90&#45;&gt;sourcefile~celestial_body_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~crtbp_module.f90&#45;&gt;sourcefile~celestial_body_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M577.79,-647.5C556.1,-630.9 518.71,-598.92 499,-562.57 463.43,-496.97 486.12,-469.52 463,-398.57 444.58,-342.03 414.15,-278.83 397.94,-246.74"/>
<polygon fill="#000000" stroke="#000000" points="401.06,-245.15 393.4,-237.83 394.82,-248.32 401.06,-245.15"/>
</g>
<!-- sourcefile~crtbp_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~crtbp_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M542.25,-658.67C481.7,-659.97 381.04,-669.58 309,-714.57 263.45,-743.01 230.93,-799.44 215.71,-830.26"/>
<polygon fill="#000000" stroke="#000000" points="212.55,-828.76 211.38,-839.29 218.86,-831.79 212.55,-828.76"/>
</g>
<!-- sourcefile~minpack_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~minpack_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M329.46,-903.6C321.88,-907.13 314.75,-911.68 309,-917.57 202.83,-1026.27 352.93,-1204.82 206,-1243.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M204,-1243.57C153.08,-1256.99 102.03,-1292.74 73.82,-1314.93"/>
<polygon fill="#000000" stroke="#000000" points="71.44,-1312.36 65.82,-1321.34 75.82,-1317.82 71.44,-1312.36"/>
</g>
<!-- sourcefile~minpack_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~minpack_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M331.29,-879.57C312,-875.26 290.05,-870.35 269.97,-865.86"/>
<polygon fill="#000000" stroke="#000000" points="270.5,-862.39 259.98,-863.63 268.97,-869.23 270.5,-862.39"/>
</g>
<!-- sourcefile~drag_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~drag_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M183.75,-1412.48C157.32,-1396.71 110.87,-1369 80.65,-1350.96"/>
<polygon fill="#000000" stroke="#000000" points="82.22,-1347.82 71.83,-1345.7 78.63,-1353.83 82.22,-1347.82"/>
</g>
<!-- sourcefile~geometry_module.f90&#45;&gt;sourcefile~vector_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~geometry_module.f90&#45;&gt;sourcefile~vector_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M530.05,-1477C518.28,-1473 507.16,-1466.87 499,-1457.57 420.36,-1367.86 538.74,-1283.74 463,-1191.57 459.66,-1187.5 455.64,-1184.06 451.23,-1181.16"/>
<polygon fill="#000000" stroke="#000000" points="452.77,-1178.01 442.33,-1176.22 449.37,-1184.14 452.77,-1178.01"/>
</g>
<!-- sourcefile~geometry_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~geometry_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M537.84,-1495.59C475.98,-1505.37 376.73,-1510.96 309,-1464.57 264.3,-1433.95 258.39,-1229.74 206,-1243.57"/>
</g>
<!-- sourcefile~gravity_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~gravity_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M328.24,-1433.28C321.35,-1430.51 314.74,-1427.01 309,-1422.57 236.44,-1366.36 294.75,-1220.16 206,-1243.57"/>
</g>
<!-- sourcefile~gravity_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~gravity_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M328.16,-1435.67C320.95,-1432.57 314.26,-1428.33 309,-1422.57 306.61,-1419.95 228.49,-978.77 209.93,-873.79"/>
<polygon fill="#000000" stroke="#000000" points="213.33,-872.93 208.14,-863.7 206.44,-874.15 213.33,-872.93"/>
</g>
<!-- sourcefile~rk_module_variable_step.f90&#45;&gt;sourcefile~conversion_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~rk_module_variable_step.f90&#45;&gt;sourcefile~conversion_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M801.96,-756.47C784.65,-731.28 741.41,-672.69 692,-638.57 616.15,-586.18 561.64,-630.2 499,-562.57 462.03,-522.65 500.87,-484.63 463,-445.57 459.75,-442.21 456.04,-439.29 452.06,-436.74"/>
<polygon fill="#000000" stroke="#000000" points="453.41,-433.49 442.96,-431.75 450.04,-439.63 453.41,-433.49"/>
</g>
<!-- sourcefile~rk_module_variable_step.f90&#45;&gt;sourcefile~brent_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~rk_module_variable_step.f90&#45;&gt;sourcefile~brent_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M806.03,-780.99C794.5,-814.91 757.61,-909.59 692,-954.57 656.31,-979.04 635.13,-954.06 596.5,-973.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-973.57C547.51,-997.3 486.56,-993.29 442.9,-985.47"/>
<polygon fill="#000000" stroke="#000000" points="443.5,-982.02 433.02,-983.59 442.19,-988.9 443.5,-982.02"/>
</g>
<!-- sourcefile~rk_module_variable_step.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~rk_module_variable_step.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-973.57C555.43,-993.3 539.42,-980.79 499,-997.57 408.04,-1035.31 382.76,-1046.31 309,-1111.57 253.27,-1160.88 277.97,-1224.66 206,-1243.57"/>
</g>
<!-- sourcefile~rk_module_variable_step.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~rk_module_variable_step.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M794.69,-780.63C773.19,-796.77 732.15,-824.76 692,-836.57 561.79,-874.85 522.02,-865.28 387,-851.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-851.57C350.1,-848.27 311.21,-847.87 278.61,-848.47"/>
<polygon fill="#000000" stroke="#000000" points="278.19,-844.98 268.27,-848.69 278.34,-851.97 278.19,-844.98"/>
</g>
<!-- sourcefile~rk_module_variable_step.f90&#45;&gt;sourcefile~orbital_mechanics_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~rk_module_variable_step.f90&#45;&gt;sourcefile~orbital_mechanics_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M755.3,-780.61C726.55,-786.94 691.13,-794.74 661.04,-801.36"/>
<polygon fill="#000000" stroke="#000000" points="660.08,-797.99 651.06,-803.56 661.58,-804.82 660.08,-797.99"/>
</g>
<!-- sourcefile~modified_equinoctial_module.f90&#45;&gt;sourcefile~vector_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~modified_equinoctial_module.f90&#45;&gt;sourcefile~vector_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M541.2,-1105.64C527.25,-1109.46 512.37,-1114.13 499,-1119.57 482.05,-1126.47 479.72,-1132.13 463,-1139.57 454.48,-1143.35 445.24,-1146.94 436.22,-1150.16"/>
<polygon fill="#000000" stroke="#000000" points="434.86,-1146.93 426.57,-1153.51 437.16,-1153.54 434.86,-1146.93"/>
</g>
<!-- sourcefile~modified_equinoctial_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~modified_equinoctial_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M500.46,-1097.72C463.85,-1101.96 422.31,-1110.11 387,-1125.57"/>
</g>
<!-- sourcefile~modified_equinoctial_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~modified_equinoctial_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M509.4,-1105.58C470.51,-1107.5 424.8,-1104.56 387,-1087.57"/>
</g>
<!-- sourcefile~iau_orientation_module.f90&#45;&gt;sourcefile~conversion_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~iau_orientation_module.f90&#45;&gt;sourcefile~conversion_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515.69,-530.53C509.72,-527.85 504.06,-524.57 499,-520.57 470.02,-497.61 490.64,-470.13 463,-445.57 458.9,-441.92 454.26,-438.78 449.34,-436.08"/>
<polygon fill="#000000" stroke="#000000" points="450.78,-432.89 440.26,-431.67 447.73,-439.18 450.78,-432.89"/>
</g>
<!-- sourcefile~iau_orientation_module.f90&#45;&gt;sourcefile~vector_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~iau_orientation_module.f90&#45;&gt;sourcefile~vector_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M576.21,-553.8C553.54,-570.11 515.84,-601.32 499,-638.57 453.01,-740.27 531.12,-1051.15 463,-1139.57 459.73,-1143.81 455.74,-1147.36 451.3,-1150.34"/>
<polygon fill="#000000" stroke="#000000" points="449.32,-1147.44 442.31,-1155.38 452.75,-1153.54 449.32,-1147.44"/>
</g>
<!-- sourcefile~iau_orientation_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~iau_orientation_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M550.33,-553.61C505.62,-563.11 436.24,-570.22 387,-539.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-539.57C355.44,-521.17 336.78,-541.55 309,-520.57 235.75,-465.25 284.92,-294.7 206,-341.57"/>
</g>
<!-- sourcefile~iau_orientation_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~iau_orientation_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515.74,-547.43C465.71,-552.6 406.78,-561.84 387,-577.57"/>
</g>
<!-- sourcefile~matrix_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~matrix_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M366.52,-605.39C349.82,-593.68 325.43,-574.66 309,-553.57 244.64,-470.91 296.07,-288.07 206,-341.57"/>
</g>
<!-- sourcefile~matrix_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~matrix_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M357.61,-629.69C341.95,-637.63 322.76,-649.2 309,-663.57 260.53,-714.18 227.64,-792.05 213.63,-829.69"/>
<polygon fill="#000000" stroke="#000000" points="210.31,-828.6 210.18,-839.19 216.89,-830.98 210.31,-828.6"/>
</g>
<!-- sourcefile~gooding_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~gooding_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M335.93,-1389.46C326.5,-1385.87 317.06,-1381.31 309,-1375.57 248.39,-1332.4 277.95,-1224.59 206,-1243.57"/>
</g>
<!-- sourcefile~gooding_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~gooding_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M361.77,-1389.49C344.52,-1379.31 321.84,-1363.1 309,-1342.57 283.46,-1301.71 225.12,-964.67 209.76,-873.97"/>
<polygon fill="#000000" stroke="#000000" points="213.19,-873.22 208.07,-863.95 206.28,-874.39 213.19,-873.22"/>
</g>
<!-- sourcefile~relative_motion_module.f90&#45;&gt;sourcefile~vector_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~relative_motion_module.f90&#45;&gt;sourcefile~vector_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M514.94,-1063.28C509.27,-1065.82 503.88,-1068.88 499,-1072.57 472.03,-1092.95 488.77,-1117.7 463,-1139.57 458.68,-1143.23 453.82,-1146.39 448.69,-1149.11"/>
<polygon fill="#000000" stroke="#000000" points="446.81,-1146.12 439.25,-1153.54 449.79,-1152.46 446.81,-1146.12"/>
</g>
<!-- sourcefile~relative_motion_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~relative_motion_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M522.62,-1063.57C514.46,-1066.04 506.42,-1069.01 499,-1072.57 480.48,-1081.45 481.11,-1091.86 463,-1101.57 431.78,-1118.3 419.45,-1111.36 387,-1125.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-1125.57C353.11,-1139.53 339.47,-1127.71 309,-1144.57 253.44,-1175.3 267.39,-1227.35 206,-1243.57"/>
</g>
<!-- sourcefile~relative_motion_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~relative_motion_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M534.93,-1063.58C476.06,-1075.19 393.79,-1090.62 387,-1087.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-1087.57C290.42,-1045.04 233.77,-923.08 213.99,-873.21"/>
<polygon fill="#000000" stroke="#000000" points="217.19,-871.79 210.32,-863.72 210.66,-874.31 217.19,-871.79"/>
</g>
<!-- sourcefile~transformation_module.f90&#45;&gt;sourcefile~vector_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~transformation_module.f90&#45;&gt;sourcefile~vector_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1000.61,-257.66C984.6,-284.55 946.76,-351.81 930,-413.57 886.02,-575.58 950.4,-631.45 894,-789.57 849.44,-914.49 793.17,-922.04 728,-1037.57 709.44,-1070.47 721.73,-1091.26 692,-1114.57 657.94,-1141.27 637.91,-1120.99 596.5,-1133.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-1133.57C549.03,-1151.8 494.1,-1159.71 452.18,-1163.11"/>
<polygon fill="#000000" stroke="#000000" points="451.8,-1159.63 442.09,-1163.86 452.32,-1166.61 451.8,-1159.63"/>
</g>
<!-- sourcefile~transformation_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~transformation_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-273.57C714.56,-282.06 691.87,-294.33 596.5,-303.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-303.57C468.2,-315.8 433.72,-278.2 309,-301.57 260.73,-310.61 248.17,-316.39 206,-341.57"/>
</g>
<!-- sourcefile~transformation_module.f90&#45;&gt;sourcefile~iau_orientation_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~transformation_module.f90&#45;&gt;sourcefile~iau_orientation_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M998.42,-257.78C963.14,-301.79 835.11,-453.18 692,-520.57 687.41,-522.73 682.6,-524.67 677.67,-526.41"/>
<polygon fill="#000000" stroke="#000000" points="676.51,-523.11 668.08,-529.53 678.67,-529.77 676.51,-523.11"/>
</g>
<!-- sourcefile~transformation_module.f90&#45;&gt;sourcefile~celestial_body_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~transformation_module.f90&#45;&gt;sourcefile~celestial_body_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M944.29,-257.64C906.09,-264.13 856.45,-271.27 812,-273.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M810,-273.57C682.64,-280.16 534.79,-256.06 451.94,-239.64"/>
<polygon fill="#000000" stroke="#000000" points="452.41,-236.17 441.91,-237.63 451.03,-243.03 452.41,-236.17"/>
</g>
<!-- sourcefile~transformation_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~transformation_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-303.57C528.07,-311.2 353.01,-348.23 309,-398.57 251.08,-464.83 217.06,-747.32 208.28,-829.23"/>
<polygon fill="#000000" stroke="#000000" points="204.78,-829.1 207.21,-839.41 211.74,-829.83 204.78,-829.1"/>
</g>
<!-- sourcefile~transformation_module.f90&#45;&gt;sourcefile~obliquity_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~transformation_module.f90&#45;&gt;sourcefile~obliquity_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M983.18,-257.73C948.42,-274.75 885.13,-305.75 846.01,-324.91"/>
<polygon fill="#000000" stroke="#000000" points="844.06,-321.97 836.62,-329.51 847.14,-328.25 844.06,-321.97"/>
</g>
<!-- sourcefile~transformation_module.f90&#45;&gt;sourcefile~time_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~transformation_module.f90&#45;&gt;sourcefile~time_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M993.9,-233.49C973.31,-216.49 933.19,-185.64 894,-168.57 859.7,-153.63 849.31,-152.29 812,-149.57"/>
</g>
<!-- sourcefile~transformation_module.f90&#45;&gt;sourcefile~jpl_ephemeris_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~transformation_module.f90&#45;&gt;sourcefile~jpl_ephemeris_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M965.95,-233.55C936.21,-225.06 896.14,-213.61 864.33,-204.52"/>
<polygon fill="#000000" stroke="#000000" points="864.89,-201.04 854.32,-201.66 862.97,-207.77 864.89,-201.04"/>
</g>
<!-- sourcefile~transformation_module.f90&#45;&gt;sourcefile~ephemeris_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~transformation_module.f90&#45;&gt;sourcefile~ephemeris_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M998.75,-233.35C980.96,-210.7 939.66,-162.09 894,-135.57 861.16,-116.5 849.41,-118.08 812,-111.57"/>
</g>
<!-- sourcefile~halo_orbit_module.f90&#45;&gt;sourcefile~math_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~halo_orbit_module.f90&#45;&gt;sourcefile~math_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M750.21,-652.7C742.12,-656.21 734.4,-660.74 728,-666.57 697.66,-694.19 723.16,-724.88 692,-751.57 658.76,-780.03 639.09,-765.5 596.5,-775.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-775.57C565.46,-782.43 489.56,-764.43 438.06,-750.38"/>
<polygon fill="#000000" stroke="#000000" points="438.68,-746.92 428.11,-747.63 436.82,-753.67 438.68,-746.92"/>
</g>
<!-- sourcefile~halo_orbit_module.f90&#45;&gt;sourcefile~rk_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~halo_orbit_module.f90&#45;&gt;sourcefile~rk_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M797.63,-652.86C779.51,-671.6 745.95,-709.2 728,-747.57 697.11,-813.59 742.38,-854.89 692,-907.57 680.99,-919.08 665.43,-925.66 650.06,-929.38"/>
<polygon fill="#000000" stroke="#000000" points="649.14,-925.99 640.04,-931.43 650.54,-932.85 649.14,-925.99"/>
</g>
<!-- sourcefile~halo_orbit_module.f90&#45;&gt;sourcefile~crtbp_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~halo_orbit_module.f90&#45;&gt;sourcefile~crtbp_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M744.78,-646.37C717.49,-648.8 685.9,-651.61 658.92,-654.01"/>
<polygon fill="#000000" stroke="#000000" points="658.47,-650.54 648.82,-654.91 659.09,-657.51 658.47,-650.54"/>
</g>
<!-- sourcefile~halo_orbit_module.f90&#45;&gt;sourcefile~minpack_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~halo_orbit_module.f90&#45;&gt;sourcefile~minpack_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M798.98,-652.64C782.02,-671.68 749.25,-710.38 728,-747.57 706.83,-784.62 725.11,-809.66 692,-836.57 626.17,-890.07 525.75,-898.53 458.3,-897.14"/>
<polygon fill="#000000" stroke="#000000" points="458.28,-893.64 448.19,-896.85 458.08,-900.63 458.28,-893.64"/>
</g>
<!-- sourcefile~halo_orbit_module.f90&#45;&gt;sourcefile~matrix_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~halo_orbit_module.f90&#45;&gt;sourcefile~matrix_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M770.21,-652.62C756.74,-656.85 741.66,-661.75 728,-666.57 711.81,-672.28 708.87,-677.4 692,-680.57 607.69,-696.38 581.98,-702.3 499,-680.57 466,-671.92 432.45,-651.12 410.8,-635.78"/>
<polygon fill="#000000" stroke="#000000" points="412.7,-632.84 402.55,-629.79 408.59,-638.5 412.7,-632.84"/>
</g>
<!-- sourcefile~halo_orbit_module.f90&#45;&gt;sourcefile~celestial_body_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~halo_orbit_module.f90&#45;&gt;sourcefile~celestial_body_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M773.42,-628.41C757.24,-621.26 739.34,-610.61 728,-595.57 684.4,-537.7 738.57,-492.08 692,-436.57 632.21,-365.3 574.25,-410.26 499,-355.57 456.35,-324.57 419.14,-274.29 400.23,-246.21"/>
<polygon fill="#000000" stroke="#000000" points="402.97,-244.01 394.54,-237.6 397.13,-247.87 402.97,-244.01"/>
</g>
<!-- sourcefile~halo_orbit_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~halo_orbit_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-775.57C470.58,-804.87 431.53,-764.9 309,-799.57 281.75,-807.28 253.19,-822.32 233.08,-834.26"/>
<polygon fill="#000000" stroke="#000000" points="231.2,-831.31 224.46,-839.49 234.83,-837.29 231.2,-831.31"/>
</g>
<!-- sourcefile~standish_module.f90&#45;&gt;sourcefile~conversion_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~standish_module.f90&#45;&gt;sourcefile~conversion_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-67.57C554.12,-83.12 529.98,-56.35 499,-86.57 446.82,-137.46 485.76,-177.32 463,-246.57 444.43,-303.05 414.06,-366.27 397.91,-398.38"/>
<polygon fill="#000000" stroke="#000000" points="394.78,-396.8 393.38,-407.3 401.02,-399.97 394.78,-396.8"/>
</g>
<!-- sourcefile~standish_module.f90&#45;&gt;sourcefile~base_class_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~standish_module.f90&#45;&gt;sourcefile~base_class_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M769.55,-59.49C690.39,-38.31 511.84,-2.91 387,-71.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-71.57C352.98,-85.14 314.74,-86.84 281.84,-84.46"/>
<polygon fill="#000000" stroke="#000000" points="282.08,-80.97 271.82,-83.6 281.48,-87.95 282.08,-80.97"/>
</g>
<!-- sourcefile~standish_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~standish_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-71.57C351.86,-85.61 335.07,-74.75 309,-99.57 224.33,-180.16 306.37,-281.65 206,-341.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M204,-341.57C117.06,-393.47 62.27,-1169.03 52.93,-1311.25"/>
<polygon fill="#000000" stroke="#000000" points="49.42,-1311.18 52.27,-1321.39 56.41,-1311.64 49.42,-1311.18"/>
</g>
<!-- sourcefile~standish_module.f90&#45;&gt;sourcefile~celestial_body_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~standish_module.f90&#45;&gt;sourcefile~celestial_body_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-67.57C554.12,-83.12 533.19,-60.04 499,-86.57 469.79,-109.23 485.65,-132.34 463,-161.57 449.18,-179.4 429.65,-195.72 413.84,-207.41"/>
<polygon fill="#000000" stroke="#000000" points="411.58,-204.73 405.51,-213.41 415.67,-210.41 411.58,-204.73"/>
</g>
<!-- sourcefile~standish_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~standish_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M755.4,-59.5C711.06,-52.27 647.7,-47.85 596.5,-67.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-67.57C554.12,-83.12 539.25,-70.67 499,-86.57 406.54,-123.08 364.01,-121.77 309,-204.57 291.14,-231.44 223.99,-719.18 208.99,-829.51"/>
<polygon fill="#000000" stroke="#000000" points="205.51,-829.13 207.63,-839.51 212.44,-830.07 205.51,-829.13"/>
</g>
<!-- sourcefile~standish_module.f90&#45;&gt;sourcefile~time_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~standish_module.f90&#45;&gt;sourcefile~time_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M788.9,-83.63C765.77,-96.4 727.26,-116.36 692,-128.57 680.85,-132.43 668.71,-135.74 656.94,-138.52"/>
<polygon fill="#000000" stroke="#000000" points="656.15,-135.11 647.17,-140.73 657.7,-141.94 656.15,-135.11"/>
</g>
<!-- sourcefile~standish_module.f90&#45;&gt;sourcefile~ephemeris_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~standish_module.f90&#45;&gt;sourcefile~ephemeris_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M749.39,-81.79C725.88,-85.75 698.67,-90.34 673.78,-94.54"/>
<polygon fill="#000000" stroke="#000000" points="672.91,-91.13 663.64,-96.25 674.08,-98.04 672.91,-91.13"/>
</g>
<!-- sourcefile~kepler_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~kepler_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.08,-490.73C487.46,-482.16 414.47,-469.1 387,-459.57"/>
</g>
<!-- sourcefile~kepler_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~kepler_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.24,-506.59C525.59,-509.69 511.35,-514.15 499,-520.57 479.74,-530.58 481.79,-542.71 463,-553.57 432.33,-571.29 414.73,-555.52 387,-577.57"/>
</g>
<!-- sourcefile~newton_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_node44" class="node">
<title>sourcefile~newton_module.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~EfferentGraph_node44"><a xlink:href=".././sourcefile/newton_module.f90.html" xlink:title="newton_module.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="445,-511.57 327,-511.57 327,-487.57 445,-487.57 445,-511.57"/>
<text text-anchor="middle" x="386" y="-497.17" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">newton_module.f90</text>
</a>
</g>
</g>
<!-- sourcefile~kepler_module.f90&#45;&gt;sourcefile~newton_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~kepler_module.f90&#45;&gt;sourcefile~newton_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.44,-499.57C513.67,-499.57 482.73,-499.57 455.47,-499.57"/>
<polygon fill="#000000" stroke="#000000" points="455.23,-496.07 445.23,-499.57 455.23,-503.07 455.23,-496.07"/>
</g>
<!-- sourcefile~analytical_ephemeris_module.f90&#45;&gt;sourcefile~conversion_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~analytical_ephemeris_module.f90&#45;&gt;sourcefile~conversion_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M528.85,-445.54C507.74,-441.68 484.19,-437.37 462.44,-433.38"/>
<polygon fill="#000000" stroke="#000000" points="463.05,-429.94 452.58,-431.58 461.79,-436.82 463.05,-429.94"/>
</g>
<!-- sourcefile~analytical_ephemeris_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~analytical_ephemeris_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M526.29,-469.6C484.87,-474.16 431.58,-475.04 387,-459.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-459.57C352.11,-448.15 339.47,-457.42 309,-440.57 253.44,-409.83 260.59,-309.14 206,-341.57"/>
</g>
<!-- sourcefile~analytical_ephemeris_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~analytical_ephemeris_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M513.35,-469.69C508.24,-472.16 503.39,-475.09 499,-478.57 470.02,-501.52 490.93,-529.34 463,-553.57 436.24,-576.78 414.73,-555.52 387,-577.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-577.57C357.75,-599.24 335.27,-573.72 309,-596.57 236.83,-659.35 214.54,-780.05 208.25,-829.56"/>
<polygon fill="#000000" stroke="#000000" points="204.78,-829.17 207.09,-839.51 211.73,-829.99 204.78,-829.17"/>
</g>
<!-- sourcefile~celestial_body_module.f90&#45;&gt;sourcefile~base_class_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~celestial_body_module.f90&#45;&gt;sourcefile~base_class_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M370.95,-213.48C339.85,-186.72 264.95,-122.29 227.74,-90.27"/>
<polygon fill="#000000" stroke="#000000" points="229.84,-87.46 219.98,-83.6 225.28,-92.77 229.84,-87.46"/>
</g>
<!-- sourcefile~celestial_body_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~celestial_body_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M340.32,-237.62C329.7,-241.36 318.66,-245.99 309,-251.57 256.36,-281.98 258.27,-310.52 206,-341.57"/>
</g>
<!-- sourcefile~celestial_body_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~celestial_body_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M363.73,-237.67C346.17,-248.82 322.08,-267.04 309,-289.57 253.77,-384.68 216.94,-736.7 208.07,-829.19"/>
<polygon fill="#000000" stroke="#000000" points="204.57,-829.09 207.11,-839.37 211.54,-829.74 204.57,-829.09"/>
</g>
<!-- sourcefile~numbers_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~numbers_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M200.08,-863.97C179.62,-928.62 85.11,-1227.33 58.49,-1311.46"/>
<polygon fill="#000000" stroke="#000000" points="55.08,-1310.66 55.4,-1321.25 61.75,-1312.77 55.08,-1310.66"/>
</g>
<!-- sourcefile~obliquity_module.f90&#45;&gt;sourcefile~conversion_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~obliquity_module.f90&#45;&gt;sourcefile~conversion_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-341.57C531.92,-347.34 521.97,-371.83 463,-393.57 453.38,-397.11 443.02,-400.76 433.14,-404.17"/>
<polygon fill="#000000" stroke="#000000" points="431.79,-400.93 423.46,-407.48 434.06,-407.56 431.79,-400.93"/>
</g>
<!-- sourcefile~obliquity_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~obliquity_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M748.66,-338.59C705.92,-337.24 647.62,-336.85 596.5,-341.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-341.57C422.56,-357.44 354.64,-253.7 206,-341.57"/>
</g>
<!-- sourcefile~time_module.f90&#45;&gt;sourcefile~conversion_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge133" class="edge">
<title>sourcefile~time_module.f90&#45;&gt;sourcefile~conversion_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M543.96,-154.84C528.16,-158.58 511.58,-164.9 499,-175.57 489.76,-183.4 421.59,-339.6 396.36,-397.89"/>
<polygon fill="#000000" stroke="#000000" points="393.05,-396.7 392.3,-407.27 399.48,-399.48 393.05,-396.7"/>
</g>
<!-- sourcefile~time_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge134" class="edge">
<title>sourcefile~time_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M543.86,-148.63C483.5,-149.8 381.68,-159.18 309,-204.57 244.39,-244.92 271.5,-302.67 206,-341.57"/>
</g>
<!-- sourcefile~lambert_module.f90&#45;&gt;sourcefile~random_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge138" class="edge">
<title>sourcefile~lambert_module.f90&#45;&gt;sourcefile~random_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M534.85,-1395.78C522.54,-1392.73 509.99,-1388.48 499,-1382.57 479.35,-1371.99 482.02,-1359.24 463,-1347.57 456.71,-1343.71 449.77,-1340.33 442.72,-1337.4"/>
<polygon fill="#000000" stroke="#000000" points="443.68,-1334.02 433.09,-1333.69 441.16,-1340.55 443.68,-1334.02"/>
</g>
<!-- sourcefile~lambert_module.f90&#45;&gt;sourcefile~vector_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge136" class="edge">
<title>sourcefile~lambert_module.f90&#45;&gt;sourcefile~vector_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M534.56,-1401.26C521.33,-1398.02 508.46,-1392.31 499,-1382.57 438.85,-1320.57 519.55,-1256.87 463,-1191.57 459.55,-1187.59 455.46,-1184.21 451,-1181.35"/>
<polygon fill="#000000" stroke="#000000" points="452.49,-1178.18 442.03,-1176.47 449.14,-1184.33 452.49,-1178.18"/>
</g>
<!-- sourcefile~lambert_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge137" class="edge">
<title>sourcefile~lambert_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M534.72,-1392.61C456.98,-1378.08 328.75,-1353.05 309,-1342.57 252.92,-1312.79 267.4,-1227.38 206,-1243.57"/>
</g>
<!-- sourcefile~lambert_module.f90&#45;&gt;sourcefile~gooding_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge139" class="edge">
<title>sourcefile~lambert_module.f90&#45;&gt;sourcefile~gooding_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M534.76,-1402.99C510.56,-1402.76 482.43,-1402.49 457.26,-1402.24"/>
<polygon fill="#000000" stroke="#000000" points="457.07,-1398.74 447.04,-1402.15 457,-1405.74 457.07,-1398.74"/>
</g>
<!-- sourcefile~lambert_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge135" class="edge">
<title>sourcefile~lambert_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M534.55,-1399.28C521.78,-1396.06 509.11,-1390.86 499,-1382.57 468.22,-1357.33 493.06,-1326.65 463,-1300.57 409.33,-1253.99 358.65,-1308.41 309,-1257.57 254.04,-1201.28 218.41,-950.14 208.69,-873.71"/>
<polygon fill="#000000" stroke="#000000" points="212.16,-873.23 207.45,-863.74 205.21,-874.1 212.16,-873.23"/>
</g>
<!-- sourcefile~jpl_ephemeris_module.f90&#45;&gt;sourcefile~conversion_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge140" class="edge">
<title>sourcefile~jpl_ephemeris_module.f90&#45;&gt;sourcefile~conversion_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M735.58,-201.63C669.24,-215.01 571.68,-241.39 499,-289.57 455.05,-318.7 418.34,-369.69 399.86,-398.39"/>
<polygon fill="#000000" stroke="#000000" points="396.68,-396.88 394.31,-407.2 402.6,-400.61 396.68,-396.88"/>
</g>
<!-- sourcefile~jpl_ephemeris_module.f90&#45;&gt;sourcefile~celestial_body_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge144" class="edge">
<title>sourcefile~jpl_ephemeris_module.f90&#45;&gt;sourcefile~celestial_body_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M733.87,-183.28C692.88,-181.46 641.6,-181.74 596.5,-189.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-189.57C552.34,-196.89 505.36,-205.04 466.77,-211.73"/>
<polygon fill="#000000" stroke="#000000" points="465.9,-208.33 456.64,-213.49 467.09,-215.23 465.9,-208.33"/>
</g>
<!-- sourcefile~jpl_ephemeris_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge141" class="edge">
<title>sourcefile~jpl_ephemeris_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M594.5,-189.57C551.86,-196.97 536.89,-187.65 499,-208.57 478.63,-219.81 480.26,-230.96 463,-246.57 398.84,-304.58 355.01,-292.32 309,-365.57 210.8,-521.9 204.81,-756.57 205.48,-829.29"/>
<polygon fill="#000000" stroke="#000000" points="201.98,-829.58 205.63,-839.53 208.98,-829.48 201.98,-829.58"/>
</g>
<!-- sourcefile~jpl_ephemeris_module.f90&#45;&gt;sourcefile~time_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge142" class="edge">
<title>sourcefile~jpl_ephemeris_module.f90&#45;&gt;sourcefile~time_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M745.94,-177.57C717.83,-172.3 684.98,-166.15 657.26,-160.95"/>
<polygon fill="#000000" stroke="#000000" points="657.77,-157.49 647.29,-159.08 656.48,-164.37 657.77,-157.49"/>
</g>
<!-- sourcefile~jpl_ephemeris_module.f90&#45;&gt;sourcefile~ephemeris_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge143" class="edge">
<title>sourcefile~jpl_ephemeris_module.f90&#45;&gt;sourcefile~ephemeris_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M790.67,-177.57C767.87,-163.89 728.44,-141.74 692,-128.57 685.62,-126.26 678.9,-124.16 672.11,-122.26"/>
<polygon fill="#000000" stroke="#000000" points="672.69,-118.8 662.13,-119.62 670.9,-125.57 672.69,-118.8"/>
</g>
<!-- sourcefile~orbital_mechanics_module.f90&#45;&gt;sourcefile~math_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge145" class="edge">
<title>sourcefile~orbital_mechanics_module.f90&#45;&gt;sourcefile~math_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M543.4,-803.51C528.88,-799.59 513.17,-794.86 499,-789.57 470.87,-779.06 440.23,-764.02 418.13,-752.48"/>
<polygon fill="#000000" stroke="#000000" points="419.68,-749.35 409.21,-747.78 416.42,-755.54 419.68,-749.35"/>
</g>
<!-- sourcefile~orbital_mechanics_module.f90&#45;&gt;sourcefile~vector_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge147" class="edge">
<title>sourcefile~orbital_mechanics_module.f90&#45;&gt;sourcefile~vector_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M577.09,-827.75C554.99,-844.24 517.53,-875.86 499,-912.57 452.97,-1003.76 528.75,-1061.39 463,-1139.57 459.61,-1143.6 455.56,-1147.01 451.13,-1149.89"/>
<polygon fill="#000000" stroke="#000000" points="449.27,-1146.92 442.2,-1154.8 452.65,-1153.05 449.27,-1146.92"/>
</g>
<!-- sourcefile~orbital_mechanics_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge148" class="edge">
<title>sourcefile~orbital_mechanics_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M536.57,-827.58C493.26,-833.66 433.72,-835.71 387,-813.57"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-813.57C346.85,-795.49 332.33,-791.76 309,-756.57 204.01,-598.16 369.39,-244.52 206,-341.57"/>
</g>
<!-- sourcefile~orbital_mechanics_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge146" class="edge">
<title>sourcefile~orbital_mechanics_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M385,-813.57C335.46,-790.09 271.36,-815.53 234.85,-834.61"/>
<polygon fill="#000000" stroke="#000000" points="232.88,-831.7 225.76,-839.53 236.22,-837.85 232.88,-831.7"/>
</g>
<!-- sourcefile~c_interface_module.f90&#45;&gt;sourcefile~geopotential_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge149" class="edge">
<title>sourcefile~c_interface_module.f90&#45;&gt;sourcefile~geopotential_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1003.86,-887.58C991.96,-920.52 954.54,-1013.25 894,-1065.57 826.24,-1124.12 726.94,-1157.92 662.01,-1175.04"/>
<polygon fill="#000000" stroke="#000000" points="661.1,-1171.66 652.29,-1177.55 662.85,-1178.44 661.1,-1171.66"/>
</g>
<!-- sourcefile~ephemeris_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge151" class="edge">
<title>sourcefile~ephemeris_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M527.42,-101.85C465.29,-100.02 373.07,-106.45 309,-151.57 230.46,-206.87 288.53,-292.42 206,-341.57"/>
</g>
<!-- sourcefile~ephemeris_module.f90&#45;&gt;sourcefile~celestial_body_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge150" class="edge">
<title>sourcefile~ephemeris_module.f90&#45;&gt;sourcefile~celestial_body_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M527.42,-117.6C517.58,-120.41 507.81,-123.99 499,-128.57 479.74,-138.58 479.3,-147.24 463,-161.57 445.29,-177.13 424.82,-194.32 409.6,-206.96"/>
<polygon fill="#000000" stroke="#000000" points="407.2,-204.41 401.72,-213.48 411.66,-209.8 407.2,-204.41"/>
</g>
<!-- sourcefile~newton_module.f90&#45;&gt;sourcefile~kind_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge153" class="edge">
<title>sourcefile~newton_module.f90&#45;&gt;sourcefile~kind_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M335.93,-487.46C326.5,-483.87 317.06,-479.31 309,-473.57 248.39,-430.4 269.98,-303.57 206,-341.57"/>
</g>
<!-- sourcefile~newton_module.f90&#45;&gt;sourcefile~numbers_module.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~EfferentGraph_edge152" class="edge">
<title>sourcefile~newton_module.f90&#45;&gt;sourcefile~numbers_module.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M365.3,-511.79C348.26,-523.27 324.06,-541.89 309,-563.57 248.17,-651.12 219.4,-778.48 209.82,-829.36"/>
<polygon fill="#000000" stroke="#000000" points="206.36,-828.82 208.02,-839.28 213.25,-830.07 206.36,-828.82"/>
</g>
</g>
</svg>
</div><script>var pansourcefilealtitude_maintenancef90EfferentGraph = svgPanZoom('#sourcefilealtitude_maintenancef90EfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="193.5,-24 88.5,-24 88.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: sourcefile~~altitude_maintenance.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilealtitude_maintenancef90AfferentGraph" width="253pt" height="32pt"
 viewBox="0.00 0.00 253.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~altitude_maintenance.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>sourcefile~~altitude_maintenance.f90~~AfferentGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 249,-28 249,4 -4,4"/>
<!-- sourcefile~altitude_maintenance.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~altitude_maintenance.f90</title>
<polygon fill="none" stroke="black" points="149,-24 0,-24 0,0 149,0 149,-24"/>
<text text-anchor="middle" x="74.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">altitude_maintenance.f90</text>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~altitude_maintenance.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="245,-24 185,-24 185,0 245,0 245,-24"/>
<text text-anchor="middle" x="215" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~altitude_maintenance.f90 -->
<g id="sourcefile~~altitude_maintenance.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~altitude_maintenance.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M184.97,-12C177.16,-12 168.31,-12 159.11,-12"/>
<polygon fill="#000000" stroke="#000000" points="159.02,-8.5 149.02,-12 159.02,-15.5 159.02,-8.5"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="193.5,-24 88.5,-24 88.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be.
    </p>
    </div></div></div></div>
      </div>
    </div>
<br>
    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../module/altitude_maintenance_module.html">altitude_maintenance_module</a>
    </div>
  </div>
</div>
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/altitude_maintenance.f90.html#src">altitude_maintenance.f90</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a id="ln-1" name="ln-1" href="#ln-1"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-2" name="ln-2" href="#ln-2"></a><span class="c">!&gt;</span>
<a id="ln-3" name="ln-3" href="#ln-3"></a><span class="c">!  Altitude maintenance for low lunar orbits.</span>
<a id="ln-4" name="ln-4" href="#ln-4"></a><span class="c">!</span>
<a id="ln-5" name="ln-5" href="#ln-5"></a><span class="c">!  Assumptions:</span>
<a id="ln-6" name="ln-6" href="#ln-6"></a><span class="c">!</span>
<a id="ln-7" name="ln-7" href="#ln-7"></a><span class="c">!  * Circular low-lunar orbit.</span>
<a id="ln-8" name="ln-8" href="#ln-8"></a><span class="c">!  * Only periapsis altitude is controlled (all other elements float)</span>
<a id="ln-9" name="ln-9" href="#ln-9"></a><span class="c">!  * The low-fidelity IAU_MOON frame is used for the elements and gravity model.</span>
<a id="ln-10" name="ln-10" href="#ln-10"></a>
<a id="ln-11" name="ln-11" href="#ln-11"></a><span class="w">    </span><span class="k">module </span><span class="n">altitude_maintenance_module</span><span class="w"></span>
<a id="ln-12" name="ln-12" href="#ln-12"></a>
<a id="ln-13" name="ln-13" href="#ln-13"></a><span class="w">    </span><span class="k">use </span><span class="n">fortran_astrodynamics_toolkit</span><span class="w"></span>
<a id="ln-14" name="ln-14" href="#ln-14"></a><span class="w">    </span><span class="k">use </span><span class="n">ddeabm_module</span><span class="p">,</span><span class="w">   </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">ddeabm_class</span><span class="p">,</span><span class="n">ddeabm_with_event_class</span><span class="w"></span>
<a id="ln-15" name="ln-15" href="#ln-15"></a><span class="w">    </span><span class="k">use </span><span class="n">iso_fortran_env</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">error_unit</span><span class="p">,</span><span class="n">output_unit</span><span class="p">,</span><span class="w"> </span><span class="n">wp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real64</span><span class="w"></span>
<a id="ln-16" name="ln-16" href="#ln-16"></a>
<a id="ln-17" name="ln-17" href="#ln-17"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-18" name="ln-18" href="#ln-18"></a>
<a id="ln-19" name="ln-19" href="#ln-19"></a><span class="k">    private</span>
<a id="ln-20" name="ln-20" href="#ln-20"></a>
<a id="ln-21" name="ln-21" href="#ln-21"></a><span class="k">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ephemeris_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;./data/eph/JPLEPH_gfortran_mac.421&#39;</span><span class="w"></span>
<a id="ln-22" name="ln-22" href="#ln-22"></a><span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">gravfile</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;./data/grav/gggrx_0020pm_sha.tab&#39;</span><span class="w"></span>
<a id="ln-23" name="ln-23" href="#ln-23"></a>
<a id="ln-24" name="ln-24" href="#ln-24"></a><span class="w">    </span><span class="k">type</span><span class="p">,</span><span class="k">extends</span><span class="p">(</span><span class="n">ddeabm_with_event_class</span><span class="p">),</span><span class="k">public</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">segment</span><span class="w"></span>
<a id="ln-25" name="ln-25" href="#ln-25"></a>
<a id="ln-26" name="ln-26" href="#ln-26"></a><span class="w">        </span><span class="c">!! the main class for integrating a low-lunar orbit.</span>
<a id="ln-27" name="ln-27" href="#ln-27"></a>
<a id="ln-28" name="ln-28" href="#ln-28"></a><span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="c">!! event function to use:</span>
<a id="ln-29" name="ln-29" href="#ln-29"></a><span class="w">                             </span><span class="c">!!</span>
<a id="ln-30" name="ln-30" href="#ln-30"></a><span class="w">                             </span><span class="c">!! 1 = integrate until minimum altitude</span>
<a id="ln-31" name="ln-31" href="#ln-31"></a><span class="w">                             </span><span class="c">!! 2 = integrate to apoapsis</span>
<a id="ln-32" name="ln-32" href="#ln-32"></a>
<a id="ln-33" name="ln-33" href="#ln-33"></a><span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">et_ref</span><span class="w"> </span><span class="c">!! reference ephemeris time (sec)</span>
<a id="ln-34" name="ln-34" href="#ln-34"></a>
<a id="ln-35" name="ln-35" href="#ln-35"></a><span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nominal_altitude</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="mf">0.0_wp</span><span class="w">  </span><span class="c">!! nominal altitude (km)</span>
<a id="ln-36" name="ln-36" href="#ln-36"></a><span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">deadband</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="mf">0.0_wp</span><span class="w">   </span><span class="c">!! altitude below nominal to trigger maneuver (km)</span>
<a id="ln-37" name="ln-37" href="#ln-37"></a><span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">r_moon</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="mi">173</span><span class="mf">7.4_wp</span><span class="w"> </span><span class="c">!! radius of the moon (km)</span>
<a id="ln-38" name="ln-38" href="#ln-38"></a>
<a id="ln-39" name="ln-39" href="#ln-39"></a><span class="w">        </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">include_third_bodies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!! to also include Earth and Sun in force model</span>
<a id="ln-40" name="ln-40" href="#ln-40"></a>
<a id="ln-41" name="ln-41" href="#ln-41"></a><span class="w">        </span><span class="k">type</span><span class="p">(</span><span class="n">geopotential_model_pines</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">grav</span><span class="w">  </span><span class="c">!! central body geopotential model</span>
<a id="ln-42" name="ln-42" href="#ln-42"></a><span class="w">        </span><span class="k">type</span><span class="p">(</span><span class="n">jpl_ephemeris</span><span class="p">)</span><span class="w">            </span><span class="kd">::</span><span class="w"> </span><span class="n">eph</span><span class="w">   </span><span class="c">!! the ephemeris</span>
<a id="ln-43" name="ln-43" href="#ln-43"></a>
<a id="ln-44" name="ln-44" href="#ln-44"></a><span class="w">        </span><span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">n_eoms</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="w">                  </span><span class="c">!! size of EOM derivative vector [x,y,z,vx,vy,vz]</span>
<a id="ln-45" name="ln-45" href="#ln-45"></a><span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">integrator_tol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0e-12_wp</span><span class="w"> </span><span class="c">!! integrator tols</span>
<a id="ln-46" name="ln-46" href="#ln-46"></a><span class="w">        </span><span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">maxsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1000000</span><span class="w">          </span><span class="c">!! integrator max steps</span>
<a id="ln-47" name="ln-47" href="#ln-47"></a><span class="w">        </span><span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">grav_n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="w">                  </span><span class="c">!! max grav degree</span>
<a id="ln-48" name="ln-48" href="#ln-48"></a><span class="w">        </span><span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">grav_m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="w">                  </span><span class="c">!! max grav order</span>
<a id="ln-49" name="ln-49" href="#ln-49"></a><span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">root_tol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0e-6_wp</span><span class="w">        </span><span class="c">!! event tolerance for deadband (km)</span>
<a id="ln-50" name="ln-50" href="#ln-50"></a>
<a id="ln-51" name="ln-51" href="#ln-51"></a><span class="w">        </span><span class="k">contains</span>
<a id="ln-52" name="ln-52" href="#ln-52"></a>
<a id="ln-53" name="ln-53" href="#ln-53"></a><span class="k">        procedure</span><span class="p">,</span><span class="k">public</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">initialize_seg</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">initialize_segment</span><span class="w"></span>
<a id="ln-54" name="ln-54" href="#ln-54"></a><span class="w">        </span><span class="k">procedure</span><span class="p">,</span><span class="k">public</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">altitude_maintenance</span><span class="w"></span>
<a id="ln-55" name="ln-55" href="#ln-55"></a>
<a id="ln-56" name="ln-56" href="#ln-56"></a><span class="w">    </span><span class="k">end type </span><span class="n">segment</span><span class="w"></span>
<a id="ln-57" name="ln-57" href="#ln-57"></a>
<a id="ln-58" name="ln-58" href="#ln-58"></a><span class="w">    </span><span class="k">contains</span><span class="w"></span>
<a id="ln-59" name="ln-59" href="#ln-59"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-60" name="ln-60" href="#ln-60"></a>
<a id="ln-61" name="ln-61" href="#ln-61"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-62" name="ln-62" href="#ln-62"></a><span class="c">!&gt;</span>
<a id="ln-63" name="ln-63" href="#ln-63"></a><span class="c">!  Initialize the segment for integration.</span>
<a id="ln-64" name="ln-64" href="#ln-64"></a>
<a id="ln-65" name="ln-65" href="#ln-65"></a><span class="w">    </span><span class="k">subroutine </span><span class="n">initialize_segment</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">alt0</span><span class="p">,</span><span class="n">deadband_alt</span><span class="p">,</span><span class="n">grav_n</span><span class="p">,</span><span class="n">grav_m</span><span class="p">)</span><span class="w"></span>
<a id="ln-66" name="ln-66" href="#ln-66"></a>
<a id="ln-67" name="ln-67" href="#ln-67"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-68" name="ln-68" href="#ln-68"></a>
<a id="ln-69" name="ln-69" href="#ln-69"></a><span class="k">    class</span><span class="p">(</span><span class="n">segment</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">me</span><span class="w"></span>
<a id="ln-70" name="ln-70" href="#ln-70"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">alt0</span><span class="w"></span>
<a id="ln-71" name="ln-71" href="#ln-71"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">deadband_alt</span><span class="w"></span>
<a id="ln-72" name="ln-72" href="#ln-72"></a><span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">grav_n</span><span class="w"></span>
<a id="ln-73" name="ln-73" href="#ln-73"></a><span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">grav_m</span><span class="w"></span>
<a id="ln-74" name="ln-74" href="#ln-74"></a>
<a id="ln-75" name="ln-75" href="#ln-75"></a><span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">status_ok</span><span class="w"></span>
<a id="ln-76" name="ln-76" href="#ln-76"></a>
<a id="ln-77" name="ln-77" href="#ln-77"></a><span class="w">    </span><span class="c">! set up the integrator:</span>
<a id="ln-78" name="ln-78" href="#ln-78"></a><span class="w">    </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">initialize_event</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">n_eoms</span><span class="p">,</span><span class="n">me</span><span class="p">%</span><span class="n">maxsteps</span><span class="p">,</span><span class="n">ballistic_derivs</span><span class="p">,&amp;</span><span class="w"></span>
<a id="ln-79" name="ln-79" href="#ln-79"></a><span class="w">                                </span><span class="p">[</span><span class="n">me</span><span class="p">%</span><span class="n">integrator_tol</span><span class="p">],[</span><span class="n">me</span><span class="p">%</span><span class="n">integrator_tol</span><span class="p">],&amp;</span><span class="w"></span>
<a id="ln-80" name="ln-80" href="#ln-80"></a><span class="w">                                 </span><span class="n">event_func</span><span class="p">,</span><span class="n">me</span><span class="p">%</span><span class="n">root_tol</span><span class="p">)</span><span class="w"></span>
<a id="ln-81" name="ln-81" href="#ln-81"></a>
<a id="ln-82" name="ln-82" href="#ln-82"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">include_third_bodies</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<a id="ln-83" name="ln-83" href="#ln-83"></a><span class="w">        </span><span class="c">! set up the ephemeris:</span>
<a id="ln-84" name="ln-84" href="#ln-84"></a><span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="n">output_unit</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;loading ephemeris file: &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">ephemeris_file</span><span class="p">)</span><span class="w"></span>
<a id="ln-85" name="ln-85" href="#ln-85"></a><span class="w">        </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">eph</span><span class="p">%</span><span class="n">initialize</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">ephemeris_file</span><span class="p">,</span><span class="n">status_ok</span><span class="o">=</span><span class="n">status_ok</span><span class="p">)</span><span class="w"></span>
<a id="ln-86" name="ln-86" href="#ln-86"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">status_ok</span><span class="p">)</span><span class="w"> </span><span class="k">error stop</span><span class="w"> </span><span class="s1">&#39;error initializing ephemeris&#39;</span><span class="w"></span>
<a id="ln-87" name="ln-87" href="#ln-87"></a><span class="w">    </span><span class="k">end if</span><span class="w"></span>
<a id="ln-88" name="ln-88" href="#ln-88"></a>
<a id="ln-89" name="ln-89" href="#ln-89"></a><span class="w">    </span><span class="c">! set class variables for event function:</span>
<a id="ln-90" name="ln-90" href="#ln-90"></a><span class="w">    </span><span class="n">me</span><span class="p">%</span><span class="n">nominal_altitude</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alt0</span><span class="w"></span>
<a id="ln-91" name="ln-91" href="#ln-91"></a><span class="w">    </span><span class="n">me</span><span class="p">%</span><span class="n">deadband</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deadband_alt</span><span class="w"></span>
<a id="ln-92" name="ln-92" href="#ln-92"></a><span class="w">    </span><span class="n">me</span><span class="p">%</span><span class="n">grav_n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">grav_n</span><span class="w"></span>
<a id="ln-93" name="ln-93" href="#ln-93"></a><span class="w">    </span><span class="n">me</span><span class="p">%</span><span class="n">grav_m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">grav_m</span><span class="w"></span>
<a id="ln-94" name="ln-94" href="#ln-94"></a>
<a id="ln-95" name="ln-95" href="#ln-95"></a><span class="w">    </span><span class="c">! set up the force model [main body is moon]:</span>
<a id="ln-96" name="ln-96" href="#ln-96"></a><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="n">output_unit</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;loading gravity file: &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">gravfile</span><span class="p">)</span><span class="w"></span>
<a id="ln-97" name="ln-97" href="#ln-97"></a><span class="w">    </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">grav</span><span class="p">%</span><span class="n">initialize</span><span class="p">(</span><span class="n">gravfile</span><span class="p">,</span><span class="n">me</span><span class="p">%</span><span class="n">grav_n</span><span class="p">,</span><span class="n">me</span><span class="p">%</span><span class="n">grav_m</span><span class="p">,</span><span class="n">status_ok</span><span class="p">)</span><span class="w"></span>
<a id="ln-98" name="ln-98" href="#ln-98"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">status_ok</span><span class="p">)</span><span class="w"> </span><span class="k">error stop</span><span class="w"> </span><span class="s1">&#39;error initializing gravity model&#39;</span><span class="w"></span>
<a id="ln-99" name="ln-99" href="#ln-99"></a>
<a id="ln-100" name="ln-100" href="#ln-100"></a><span class="w">    </span><span class="k">end subroutine </span><span class="n">initialize_segment</span><span class="w"></span>
<a id="ln-101" name="ln-101" href="#ln-101"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-102" name="ln-102" href="#ln-102"></a>
<a id="ln-103" name="ln-103" href="#ln-103"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-104" name="ln-104" href="#ln-104"></a><span class="c">!&gt;</span>
<a id="ln-105" name="ln-105" href="#ln-105"></a><span class="c">!  Altitude maintenance for a circular lunar orbit - periapsis only control.</span>
<a id="ln-106" name="ln-106" href="#ln-106"></a>
<a id="ln-107" name="ln-107" href="#ln-107"></a><span class="w">    </span><span class="k">subroutine </span><span class="n">altitude_maintenance</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">et0</span><span class="p">,</span><span class="n">inc0</span><span class="p">,</span><span class="n">ran0</span><span class="p">,</span><span class="n">tru0</span><span class="p">,</span><span class="n">dt_max</span><span class="p">,</span><span class="n">n_dvs</span><span class="p">,</span><span class="n">dv_total</span><span class="p">,</span><span class="n">xf</span><span class="p">)</span><span class="w"></span>
<a id="ln-108" name="ln-108" href="#ln-108"></a>
<a id="ln-109" name="ln-109" href="#ln-109"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-110" name="ln-110" href="#ln-110"></a>
<a id="ln-111" name="ln-111" href="#ln-111"></a><span class="k">    class</span><span class="p">(</span><span class="n">segment</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w">      </span><span class="kd">::</span><span class="w"> </span><span class="n">seg</span><span class="w"></span>
<a id="ln-112" name="ln-112" href="#ln-112"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">               </span><span class="kd">::</span><span class="w"> </span><span class="n">et0</span><span class="w">      </span><span class="c">!! initial ephemeris time (sec)</span>
<a id="ln-113" name="ln-113" href="#ln-113"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">               </span><span class="kd">::</span><span class="w"> </span><span class="n">inc0</span><span class="w">     </span><span class="c">!! initial inclination - IAU_MOON of date (deg)</span>
<a id="ln-114" name="ln-114" href="#ln-114"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">               </span><span class="kd">::</span><span class="w"> </span><span class="n">ran0</span><span class="w">     </span><span class="c">!! initial RAAN - IAU_MOON of date (deg)</span>
<a id="ln-115" name="ln-115" href="#ln-115"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">               </span><span class="kd">::</span><span class="w"> </span><span class="n">tru0</span><span class="w">     </span><span class="c">!! initial true anomaly - IAU_MOON of date (deg)</span>
<a id="ln-116" name="ln-116" href="#ln-116"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">               </span><span class="kd">::</span><span class="w"> </span><span class="n">dt_max</span><span class="w">   </span><span class="c">!! how long to propagate (days)</span>
<a id="ln-117" name="ln-117" href="#ln-117"></a><span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w">               </span><span class="kd">::</span><span class="w"> </span><span class="n">n_dvs</span><span class="w">    </span><span class="c">!! number of DV maneuvers performed</span>
<a id="ln-118" name="ln-118" href="#ln-118"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w">              </span><span class="kd">::</span><span class="w"> </span><span class="n">dv_total</span><span class="w"> </span><span class="c">!! total DV (km/s)</span>
<a id="ln-119" name="ln-119" href="#ln-119"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xf</span><span class="w">       </span><span class="c">!! final state - inertial frame (km, km/s)</span>
<a id="ln-120" name="ln-120" href="#ln-120"></a>
<a id="ln-121" name="ln-121" href="#ln-121"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="c">!! position vector (km)</span>
<a id="ln-122" name="ln-122" href="#ln-122"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="c">!! velocity vector (km/s)</span>
<a id="ln-123" name="ln-123" href="#ln-123"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rotmat</span><span class="w">  </span><span class="c">!! rotation matrix from ICRF to IAU_MOON</span>
<a id="ln-124" name="ln-124" href="#ln-124"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span><span class="w">  </span><span class="c">!! J2000-Moon state vector</span>
<a id="ln-125" name="ln-125" href="#ln-125"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">idid</span><span class="w">             </span><span class="c">!! integrator status flag</span>
<a id="ln-126" name="ln-126" href="#ln-126"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">sma</span><span class="w">             </span><span class="c">!! circular orbit semi-major axis (km)</span>
<a id="ln-127" name="ln-127" href="#ln-127"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">min_altitude</span><span class="w">    </span><span class="c">!! minimum altitude (km)</span>
<a id="ln-128" name="ln-128" href="#ln-128"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dv</span><span class="w">              </span><span class="c">!! periapsis raise maneuver magnitude (km/s)</span>
<a id="ln-129" name="ln-129" href="#ln-129"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">t</span><span class="w">               </span><span class="c">!! integration time (sec from et0)</span>
<a id="ln-130" name="ln-130" href="#ln-130"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tf</span><span class="w">              </span><span class="c">!! final integration time (sec from et0)</span>
<a id="ln-131" name="ln-131" href="#ln-131"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">gval</span><span class="w">            </span><span class="c">!! event function value</span>
<a id="ln-132" name="ln-132" href="#ln-132"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tru</span><span class="w">             </span><span class="c">!! true anomaly (deg)</span>
<a id="ln-133" name="ln-133" href="#ln-133"></a>
<a id="ln-134" name="ln-134" href="#ln-134"></a><span class="w">    </span><span class="c">! initialize</span>
<a id="ln-135" name="ln-135" href="#ln-135"></a><span class="w">    </span><span class="n">n_dvs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-136" name="ln-136" href="#ln-136"></a><span class="w">    </span><span class="n">dv_total</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span><span class="w"></span>
<a id="ln-137" name="ln-137" href="#ln-137"></a>
<a id="ln-138" name="ln-138" href="#ln-138"></a><span class="w">    </span><span class="c">! get initial state in J2000 - Cartesian for integration</span>
<a id="ln-139" name="ln-139" href="#ln-139"></a><span class="w">    </span><span class="c">! note that inc,ran are in moon-centered-of-date-frame</span>
<a id="ln-140" name="ln-140" href="#ln-140"></a><span class="w">    </span><span class="c">! [circular orbit so p=sma]</span>
<a id="ln-141" name="ln-141" href="#ln-141"></a><span class="w">    </span><span class="n">sma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">seg</span><span class="p">%</span><span class="n">r_moon</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">seg</span><span class="p">%</span><span class="n">nominal_altitude</span><span class="w">  </span><span class="c">! initial orbit sma (circular)</span>
<a id="ln-142" name="ln-142" href="#ln-142"></a><span class="w">    </span><span class="k">call </span><span class="n">orbital_elements_to_rv</span><span class="p">(</span><span class="n">body_moon</span><span class="p">%</span><span class="n">mu</span><span class="p">,</span><span class="n">sma</span><span class="p">,</span><span class="n">zero</span><span class="p">,&amp;</span><span class="w"></span>
<a id="ln-143" name="ln-143" href="#ln-143"></a><span class="w">                                </span><span class="n">inc0</span><span class="o">*</span><span class="n">deg2rad</span><span class="p">,</span><span class="n">ran0</span><span class="o">*</span><span class="n">deg2rad</span><span class="p">,</span><span class="n">zero</span><span class="p">,</span><span class="n">tru0</span><span class="o">*</span><span class="n">deg2rad</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">v</span><span class="p">)</span><span class="w"></span>
<a id="ln-144" name="ln-144" href="#ln-144"></a>
<a id="ln-145" name="ln-145" href="#ln-145"></a><span class="w">    </span><span class="c">! rotate from body-fixed moon of date to j2000:</span>
<a id="ln-146" name="ln-146" href="#ln-146"></a><span class="w">    </span><span class="n">rotmat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icrf_to_iau_moon</span><span class="p">(</span><span class="n">et0</span><span class="p">)</span><span class="w">   </span><span class="c">! rotation matrix from inertial to body-fixed Moon frame</span>
<a id="ln-147" name="ln-147" href="#ln-147"></a><span class="w">    </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">matmul</span><span class="p">(</span><span class="nb">transpose</span><span class="p">(</span><span class="n">rotmat</span><span class="p">),</span><span class="n">r</span><span class="p">)</span><span class="w"></span>
<a id="ln-148" name="ln-148" href="#ln-148"></a><span class="w">    </span><span class="n">x</span><span class="p">(</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">matmul</span><span class="p">(</span><span class="nb">transpose</span><span class="p">(</span><span class="n">rotmat</span><span class="p">),</span><span class="n">v</span><span class="p">)</span><span class="w">  </span><span class="c">! because using &quot;of date&quot; iau_moon frame</span>
<a id="ln-149" name="ln-149" href="#ln-149"></a>
<a id="ln-150" name="ln-150" href="#ln-150"></a><span class="w">    </span><span class="c">! times are relative to initial epoch (sec)</span>
<a id="ln-151" name="ln-151" href="#ln-151"></a><span class="w">    </span><span class="n">seg</span><span class="p">%</span><span class="n">et_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">et0</span><span class="w"></span>
<a id="ln-152" name="ln-152" href="#ln-152"></a><span class="w">    </span><span class="n">t</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span><span class="w"></span>
<a id="ln-153" name="ln-153" href="#ln-153"></a><span class="w">    </span><span class="n">tf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dt_max</span><span class="o">*</span><span class="n">day2sec</span><span class="w"></span>
<a id="ln-154" name="ln-154" href="#ln-154"></a>
<a id="ln-155" name="ln-155" href="#ln-155"></a><span class="w">    </span><span class="c">! propagate until the altitude is less than min_altitude</span>
<a id="ln-156" name="ln-156" href="#ln-156"></a><span class="w">    </span><span class="n">seg</span><span class="p">%</span><span class="n">event</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-157" name="ln-157" href="#ln-157"></a>
<a id="ln-158" name="ln-158" href="#ln-158"></a><span class="w">    </span><span class="c">! main integration loop:</span>
<a id="ln-159" name="ln-159" href="#ln-159"></a><span class="w">    </span><span class="k">call </span><span class="n">seg</span><span class="p">%</span><span class="n">first_call</span><span class="p">()</span><span class="w"></span>
<a id="ln-160" name="ln-160" href="#ln-160"></a><span class="w">    </span><span class="k">do</span>
<a id="ln-161" name="ln-161" href="#ln-161"></a>
<a id="ln-162" name="ln-162" href="#ln-162"></a><span class="k">        call </span><span class="n">seg</span><span class="p">%</span><span class="n">integrate_to_event</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">tf</span><span class="p">,</span><span class="n">idid</span><span class="o">=</span><span class="n">idid</span><span class="p">,</span><span class="n">gval</span><span class="o">=</span><span class="n">gval</span><span class="p">)</span><span class="w"></span>
<a id="ln-163" name="ln-163" href="#ln-163"></a>
<a id="ln-164" name="ln-164" href="#ln-164"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">idid</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-165" name="ln-165" href="#ln-165"></a>
<a id="ln-166" name="ln-166" href="#ln-166"></a><span class="k">            write</span><span class="p">(</span><span class="n">error_unit</span><span class="p">,</span><span class="s1">&#39;(A,*(I5/))&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;idid: &#39;</span><span class="p">,</span><span class="n">idid</span><span class="w"></span>
<a id="ln-167" name="ln-167" href="#ln-167"></a><span class="w">            </span><span class="k">error stop</span><span class="w"> </span><span class="s1">&#39;error in integrator&#39;</span><span class="w"></span>
<a id="ln-168" name="ln-168" href="#ln-168"></a>
<a id="ln-169" name="ln-169" href="#ln-169"></a><span class="w">        </span><span class="n">elseif</span><span class="w"> </span><span class="p">(</span><span class="n">idid</span><span class="o">==</span><span class="mi">2</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">idid</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<a id="ln-170" name="ln-170" href="#ln-170"></a>
<a id="ln-171" name="ln-171" href="#ln-171"></a><span class="w">            </span><span class="c">! if we reached the max time, then we are done, so exit</span>
<a id="ln-172" name="ln-172" href="#ln-172"></a><span class="w">            </span><span class="k">exit</span>
<a id="ln-173" name="ln-173" href="#ln-173"></a>
<a id="ln-174" name="ln-174" href="#ln-174"></a><span class="k">        </span><span class="n">elseif</span><span class="w"> </span><span class="p">(</span><span class="n">idid</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1000</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">  </span><span class="c">! a root has been found</span>
<a id="ln-175" name="ln-175" href="#ln-175"></a>
<a id="ln-176" name="ln-176" href="#ln-176"></a><span class="w">            </span><span class="k">select case</span><span class="w"> </span><span class="p">(</span><span class="n">seg</span><span class="p">%</span><span class="n">event</span><span class="p">)</span><span class="w"></span>
<a id="ln-177" name="ln-177" href="#ln-177"></a><span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<a id="ln-178" name="ln-178" href="#ln-178"></a>
<a id="ln-179" name="ln-179" href="#ln-179"></a><span class="w">                </span><span class="c">! if we hit the min altitude, then integrate to next apoapsis</span>
<a id="ln-180" name="ln-180" href="#ln-180"></a><span class="w">                </span><span class="c">! and raise the periapsis:</span>
<a id="ln-181" name="ln-181" href="#ln-181"></a><span class="w">                </span><span class="n">seg</span><span class="p">%</span><span class="n">event</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="c">! propagate until apoapsis</span>
<a id="ln-182" name="ln-182" href="#ln-182"></a><span class="w">                </span><span class="k">call </span><span class="n">seg</span><span class="p">%</span><span class="n">first_call</span><span class="p">()</span><span class="w">  </span><span class="c">! have to restart the integration</span>
<a id="ln-183" name="ln-183" href="#ln-183"></a><span class="w">                                       </span><span class="c">! since we just root solved</span>
<a id="ln-184" name="ln-184" href="#ln-184"></a>
<a id="ln-185" name="ln-185" href="#ln-185"></a><span class="w">                </span><span class="c">! compute the maneuver here that will be performed</span>
<a id="ln-186" name="ln-186" href="#ln-186"></a><span class="w">                </span><span class="c">! at next apoapsis to raise the periapsis, no matter what.</span>
<a id="ln-187" name="ln-187" href="#ln-187"></a><span class="w">                </span><span class="n">dv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">periapsis_raise_maneuver</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">sma</span><span class="p">)</span><span class="w"></span>
<a id="ln-188" name="ln-188" href="#ln-188"></a>
<a id="ln-189" name="ln-189" href="#ln-189"></a><span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<a id="ln-190" name="ln-190" href="#ln-190"></a>
<a id="ln-191" name="ln-191" href="#ln-191"></a><span class="w">                </span><span class="c">! we have propagated to periapsis or apoapsis, if at apoapsis,</span>
<a id="ln-192" name="ln-192" href="#ln-192"></a><span class="w">                </span><span class="c">! perform a maneuver to raise periapsis</span>
<a id="ln-193" name="ln-193" href="#ln-193"></a><span class="w">                </span><span class="c">! if at periapsis, just continue on.</span>
<a id="ln-194" name="ln-194" href="#ln-194"></a>
<a id="ln-195" name="ln-195" href="#ln-195"></a><span class="w">                </span><span class="c">! compute current true anomaly:</span>
<a id="ln-196" name="ln-196" href="#ln-196"></a><span class="w">                </span><span class="n">tru</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">true_anomaly</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<a id="ln-197" name="ln-197" href="#ln-197"></a>
<a id="ln-198" name="ln-198" href="#ln-198"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tru</span><span class="o">&lt;</span><span class="mi">17</span><span class="mf">9.0_wp</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">tru</span><span class="o">&gt;</span><span class="mi">18</span><span class="mf">1.0_wp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<a id="ln-199" name="ln-199" href="#ln-199"></a>
<a id="ln-200" name="ln-200" href="#ln-200"></a><span class="w">                    </span><span class="c">! we have to keep integrating, since we stopped at periapsis</span>
<a id="ln-201" name="ln-201" href="#ln-201"></a><span class="w">                    </span><span class="c">! note: this is inefficient since we have to</span>
<a id="ln-202" name="ln-202" href="#ln-202"></a><span class="w">                    </span><span class="c">! restart the integration. it would be better to prevent</span>
<a id="ln-203" name="ln-203" href="#ln-203"></a><span class="w">                    </span><span class="c">! to root solver from stopping here.</span>
<a id="ln-204" name="ln-204" href="#ln-204"></a><span class="w">                    </span><span class="n">seg</span><span class="p">%</span><span class="n">event</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w">  </span><span class="c">! continue with mode 2</span>
<a id="ln-205" name="ln-205" href="#ln-205"></a><span class="w">                    </span><span class="k">call </span><span class="n">seg</span><span class="p">%</span><span class="n">first_call</span><span class="p">()</span><span class="w">  </span><span class="c">! have to restart integration</span>
<a id="ln-206" name="ln-206" href="#ln-206"></a><span class="w">                    </span><span class="k">cycle</span>
<a id="ln-207" name="ln-207" href="#ln-207"></a>
<a id="ln-208" name="ln-208" href="#ln-208"></a><span class="k">                else</span><span class="w"> </span><span class="c">! we are at apoapsis</span>
<a id="ln-209" name="ln-209" href="#ln-209"></a>
<a id="ln-210" name="ln-210" href="#ln-210"></a><span class="w">                    </span><span class="c">! perform the maneuver we computed when</span>
<a id="ln-211" name="ln-211" href="#ln-211"></a><span class="w">                    </span><span class="c">! the min altitude was triggered</span>
<a id="ln-212" name="ln-212" href="#ln-212"></a><span class="w">                    </span><span class="c">! apply the maneuver along the current apoapsis velocity vector:</span>
<a id="ln-213" name="ln-213" href="#ln-213"></a><span class="w">                    </span><span class="n">x</span><span class="p">(</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dv</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">unit</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span><span class="w"></span>
<a id="ln-214" name="ln-214" href="#ln-214"></a>
<a id="ln-215" name="ln-215" href="#ln-215"></a><span class="w">                    </span><span class="c">! keep track of totals:</span>
<a id="ln-216" name="ln-216" href="#ln-216"></a><span class="w">                    </span><span class="n">n_dvs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n_dvs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-217" name="ln-217" href="#ln-217"></a><span class="w">                    </span><span class="n">dv_total</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dv_total</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dv</span><span class="w"></span>
<a id="ln-218" name="ln-218" href="#ln-218"></a>
<a id="ln-219" name="ln-219" href="#ln-219"></a><span class="w">                    </span><span class="k">write</span><span class="p">(</span><span class="n">output_unit</span><span class="p">,</span><span class="s1">&#39;(*(A,F12.6))&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;maneuver at &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="o">*</span><span class="n">sec2hr</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-220" name="ln-220" href="#ln-220"></a><span class="w">                                                      </span><span class="s1">&#39; hr : TRU = &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">tru</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-221" name="ln-221" href="#ln-221"></a><span class="w">                                                      </span><span class="s1">&#39; : dv = &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">dv</span><span class="w"></span>
<a id="ln-222" name="ln-222" href="#ln-222"></a>
<a id="ln-223" name="ln-223" href="#ln-223"></a><span class="w">                </span><span class="k">end if</span>
<a id="ln-224" name="ln-224" href="#ln-224"></a>
<a id="ln-225" name="ln-225" href="#ln-225"></a><span class="k">                </span><span class="n">seg</span><span class="p">%</span><span class="n">event</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">     </span><span class="c">! continue with normal mode</span>
<a id="ln-226" name="ln-226" href="#ln-226"></a><span class="w">                </span><span class="k">call </span><span class="n">seg</span><span class="p">%</span><span class="n">first_call</span><span class="p">()</span><span class="w">  </span><span class="c">! have to restart the integration</span>
<a id="ln-227" name="ln-227" href="#ln-227"></a><span class="w">                                       </span><span class="c">! since we root solved and/or changed</span>
<a id="ln-228" name="ln-228" href="#ln-228"></a><span class="w">                                       </span><span class="c">! the state</span>
<a id="ln-229" name="ln-229" href="#ln-229"></a>
<a id="ln-230" name="ln-230" href="#ln-230"></a><span class="w">            </span><span class="k">case </span><span class="n">default</span><span class="w"></span>
<a id="ln-231" name="ln-231" href="#ln-231"></a><span class="w">                </span><span class="k">error stop</span><span class="w"> </span><span class="s1">&#39;invalid event value in altitude_maintenance&#39;</span><span class="w"></span>
<a id="ln-232" name="ln-232" href="#ln-232"></a><span class="w">            </span><span class="k">end select</span>
<a id="ln-233" name="ln-233" href="#ln-233"></a>
<a id="ln-234" name="ln-234" href="#ln-234"></a><span class="k">        else</span>
<a id="ln-235" name="ln-235" href="#ln-235"></a><span class="k">            write</span><span class="p">(</span><span class="n">error_unit</span><span class="p">,</span><span class="s1">&#39;(A,I5)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;unknown exit code from integrator: idid=&#39;</span><span class="p">,</span><span class="n">idid</span><span class="w"></span>
<a id="ln-236" name="ln-236" href="#ln-236"></a><span class="w">            </span><span class="k">error stop</span><span class="w"> </span><span class="s1">&#39;error in altitude_maintenance&#39;</span><span class="w"></span>
<a id="ln-237" name="ln-237" href="#ln-237"></a><span class="w">        </span><span class="k">end if</span>
<a id="ln-238" name="ln-238" href="#ln-238"></a>
<a id="ln-239" name="ln-239" href="#ln-239"></a><span class="k">    end do</span><span class="w"></span>
<a id="ln-240" name="ln-240" href="#ln-240"></a>
<a id="ln-241" name="ln-241" href="#ln-241"></a><span class="w">    </span><span class="c">! final state:</span>
<a id="ln-242" name="ln-242" href="#ln-242"></a><span class="w">    </span><span class="n">xf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"></span>
<a id="ln-243" name="ln-243" href="#ln-243"></a>
<a id="ln-244" name="ln-244" href="#ln-244"></a><span class="w">    </span><span class="k">end subroutine </span><span class="n">altitude_maintenance</span><span class="w"></span>
<a id="ln-245" name="ln-245" href="#ln-245"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-246" name="ln-246" href="#ln-246"></a>
<a id="ln-247" name="ln-247" href="#ln-247"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-248" name="ln-248" href="#ln-248"></a><span class="c">!&gt;</span>
<a id="ln-249" name="ln-249" href="#ln-249"></a><span class="c">!  Compute true anomaly [0, 360] deg.</span>
<a id="ln-250" name="ln-250" href="#ln-250"></a>
<a id="ln-251" name="ln-251" href="#ln-251"></a><span class="w">    </span><span class="k">pure function </span><span class="n">true_anomaly</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">tru</span><span class="p">)</span><span class="w"></span>
<a id="ln-252" name="ln-252" href="#ln-252"></a>
<a id="ln-253" name="ln-253" href="#ln-253"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-254" name="ln-254" href="#ln-254"></a>
<a id="ln-255" name="ln-255" href="#ln-255"></a><span class="k">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rv</span><span class="w"> </span><span class="c">!! [position,velocity] vector</span>
<a id="ln-256" name="ln-256" href="#ln-256"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tru</span><span class="w"> </span><span class="c">!! true anomaly (deg)</span>
<a id="ln-257" name="ln-257" href="#ln-257"></a>
<a id="ln-258" name="ln-258" href="#ln-258"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="c">!! position vector</span>
<a id="ln-259" name="ln-259" href="#ln-259"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="c">!! velocity vector</span>
<a id="ln-260" name="ln-260" href="#ln-260"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="n">ecc</span><span class="p">,</span><span class="n">inc</span><span class="p">,</span><span class="n">raan</span><span class="p">,</span><span class="n">aop</span><span class="w"> </span><span class="c">!! orbital elements</span>
<a id="ln-261" name="ln-261" href="#ln-261"></a>
<a id="ln-262" name="ln-262" href="#ln-262"></a><span class="w">    </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rv</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<a id="ln-263" name="ln-263" href="#ln-263"></a><span class="w">    </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rv</span><span class="p">(</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span><span class="w"></span>
<a id="ln-264" name="ln-264" href="#ln-264"></a>
<a id="ln-265" name="ln-265" href="#ln-265"></a><span class="w">    </span><span class="k">call </span><span class="n">rv_to_orbital_elements</span><span class="p">(</span><span class="n">body_moon</span><span class="p">%</span><span class="n">mu</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">ecc</span><span class="p">,</span><span class="n">inc</span><span class="p">,</span><span class="n">raan</span><span class="p">,</span><span class="n">aop</span><span class="p">,</span><span class="n">tru</span><span class="p">)</span><span class="w"></span>
<a id="ln-266" name="ln-266" href="#ln-266"></a>
<a id="ln-267" name="ln-267" href="#ln-267"></a><span class="w">    </span><span class="n">tru</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tru</span><span class="o">*</span><span class="n">rad2deg</span><span class="w"> </span><span class="c">! convert to deg</span>
<a id="ln-268" name="ln-268" href="#ln-268"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tru</span><span class="o">&lt;</span><span class="n">zero</span><span class="p">)</span><span class="w"> </span><span class="n">tru</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tru</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">36</span><span class="mf">0.0_wp</span><span class="w"> </span><span class="c">! wrap from 0 to 369</span>
<a id="ln-269" name="ln-269" href="#ln-269"></a>
<a id="ln-270" name="ln-270" href="#ln-270"></a><span class="w">    </span><span class="k">end function </span><span class="n">true_anomaly</span><span class="w"></span>
<a id="ln-271" name="ln-271" href="#ln-271"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-272" name="ln-272" href="#ln-272"></a>
<a id="ln-273" name="ln-273" href="#ln-273"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-274" name="ln-274" href="#ln-274"></a><span class="c">!&gt;</span>
<a id="ln-275" name="ln-275" href="#ln-275"></a><span class="c">!  Compute the maneuver at apoapsis to raise periapsis to the specified value.</span>
<a id="ln-276" name="ln-276" href="#ln-276"></a>
<a id="ln-277" name="ln-277" href="#ln-277"></a><span class="w">    </span><span class="k">pure function </span><span class="n">periapsis_raise_maneuver</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span><span class="n">target_rp</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">dv</span><span class="p">)</span><span class="w"></span>
<a id="ln-278" name="ln-278" href="#ln-278"></a>
<a id="ln-279" name="ln-279" href="#ln-279"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-280" name="ln-280" href="#ln-280"></a>
<a id="ln-281" name="ln-281" href="#ln-281"></a><span class="k">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rv</span><span class="w"> </span><span class="c">!! [position,velocity] vector</span>
<a id="ln-282" name="ln-282" href="#ln-282"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">target_rp</span><span class="w">  </span><span class="c">!! the rp value to target</span>
<a id="ln-283" name="ln-283" href="#ln-283"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dv</span><span class="w"> </span><span class="c">!! the maneuver to perform at apoapsis to target `target_rp`</span>
<a id="ln-284" name="ln-284" href="#ln-284"></a>
<a id="ln-285" name="ln-285" href="#ln-285"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="c">!! position vector</span>
<a id="ln-286" name="ln-286" href="#ln-286"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="c">!! velocity vector</span>
<a id="ln-287" name="ln-287" href="#ln-287"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">ecc</span><span class="p">,</span><span class="n">inc</span><span class="p">,</span><span class="n">raan</span><span class="p">,</span><span class="n">aop</span><span class="p">,</span><span class="n">tru</span><span class="w"> </span><span class="c">!! orbital elements</span>
<a id="ln-288" name="ln-288" href="#ln-288"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rp1</span><span class="p">,</span><span class="n">ra1</span><span class="p">,</span><span class="n">vp1</span><span class="p">,</span><span class="n">va1</span><span class="p">,</span><span class="n">va2</span><span class="w">  </span><span class="c">!! periapsis/apoapsis pos/vel magnitudes</span>
<a id="ln-289" name="ln-289" href="#ln-289"></a>
<a id="ln-290" name="ln-290" href="#ln-290"></a><span class="w">    </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rv</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<a id="ln-291" name="ln-291" href="#ln-291"></a><span class="w">    </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rv</span><span class="p">(</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span><span class="w"></span>
<a id="ln-292" name="ln-292" href="#ln-292"></a>
<a id="ln-293" name="ln-293" href="#ln-293"></a><span class="w">    </span><span class="k">call </span><span class="n">rv_to_orbital_elements</span><span class="p">(</span><span class="n">body_moon</span><span class="p">%</span><span class="n">mu</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">ecc</span><span class="p">,</span><span class="n">inc</span><span class="p">,</span><span class="n">raan</span><span class="p">,</span><span class="n">aop</span><span class="p">,</span><span class="n">tru</span><span class="p">)</span><span class="w"></span>
<a id="ln-294" name="ln-294" href="#ln-294"></a><span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">one</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ecc</span><span class="o">*</span><span class="n">ecc</span><span class="p">)</span><span class="w"> </span><span class="c">! compute semi-major axis</span>
<a id="ln-295" name="ln-295" href="#ln-295"></a><span class="w">    </span><span class="k">call </span><span class="n">periapsis_apoapsis</span><span class="p">(</span><span class="n">body_moon</span><span class="p">%</span><span class="n">mu</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">ecc</span><span class="p">,</span><span class="n">rp1</span><span class="p">,</span><span class="n">ra1</span><span class="p">,</span><span class="n">vp1</span><span class="p">,</span><span class="n">va1</span><span class="p">)</span><span class="w"></span>
<a id="ln-296" name="ln-296" href="#ln-296"></a>
<a id="ln-297" name="ln-297" href="#ln-297"></a><span class="w">    </span><span class="c">! apoapsis velocity for periapsis radius of target_rp</span>
<a id="ln-298" name="ln-298" href="#ln-298"></a><span class="w">    </span><span class="n">va2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">body_moon</span><span class="p">%</span><span class="n">mu</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">target_rp</span><span class="o">/</span><span class="p">(</span><span class="n">ra1</span><span class="o">*</span><span class="p">(</span><span class="n">target_rp</span><span class="o">+</span><span class="n">ra1</span><span class="p">))</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-299" name="ln-299" href="#ln-299"></a>
<a id="ln-300" name="ln-300" href="#ln-300"></a><span class="w">    </span><span class="c">! delta-v to raise periapsis back to target rp</span>
<a id="ln-301" name="ln-301" href="#ln-301"></a><span class="w">    </span><span class="n">dv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">va2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">va1</span><span class="w"></span>
<a id="ln-302" name="ln-302" href="#ln-302"></a>
<a id="ln-303" name="ln-303" href="#ln-303"></a><span class="w">    </span><span class="k">end function </span><span class="n">periapsis_raise_maneuver</span><span class="w"></span>
<a id="ln-304" name="ln-304" href="#ln-304"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-305" name="ln-305" href="#ln-305"></a>
<a id="ln-306" name="ln-306" href="#ln-306"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-307" name="ln-307" href="#ln-307"></a><span class="c">!&gt;</span>
<a id="ln-308" name="ln-308" href="#ln-308"></a><span class="c">!  Compute radial velocity magnitude \( \dot{r} \)</span>
<a id="ln-309" name="ln-309" href="#ln-309"></a>
<a id="ln-310" name="ln-310" href="#ln-310"></a><span class="w">    </span><span class="k">pure function </span><span class="n">rdot</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"></span>
<a id="ln-311" name="ln-311" href="#ln-311"></a>
<a id="ln-312" name="ln-312" href="#ln-312"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-313" name="ln-313" href="#ln-313"></a>
<a id="ln-314" name="ln-314" href="#ln-314"></a><span class="k">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rv</span><span class="w"> </span><span class="c">!! [position,velocity] vector</span>
<a id="ln-315" name="ln-315" href="#ln-315"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rd</span><span class="w"> </span><span class="c">!! \( \dot{r} \)</span>
<a id="ln-316" name="ln-316" href="#ln-316"></a>
<a id="ln-317" name="ln-317" href="#ln-317"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="c">!! position vector</span>
<a id="ln-318" name="ln-318" href="#ln-318"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="c">!! velocity vector</span>
<a id="ln-319" name="ln-319" href="#ln-319"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rmag</span><span class="w"> </span><span class="c">!! position vector magnitude</span>
<a id="ln-320" name="ln-320" href="#ln-320"></a>
<a id="ln-321" name="ln-321" href="#ln-321"></a><span class="w">    </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rv</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<a id="ln-322" name="ln-322" href="#ln-322"></a><span class="w">    </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rv</span><span class="p">(</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span><span class="w"></span>
<a id="ln-323" name="ln-323" href="#ln-323"></a><span class="w">    </span><span class="n">rmag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">norm2</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="w"></span>
<a id="ln-324" name="ln-324" href="#ln-324"></a>
<a id="ln-325" name="ln-325" href="#ln-325"></a><span class="w">    </span><span class="n">rd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dot_product</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">rmag</span><span class="w"></span>
<a id="ln-326" name="ln-326" href="#ln-326"></a>
<a id="ln-327" name="ln-327" href="#ln-327"></a><span class="w">    </span><span class="k">end function </span><span class="n">rdot</span><span class="w"></span>
<a id="ln-328" name="ln-328" href="#ln-328"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-329" name="ln-329" href="#ln-329"></a>
<a id="ln-330" name="ln-330" href="#ln-330"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-331" name="ln-331" href="#ln-331"></a><span class="c">!&gt;</span>
<a id="ln-332" name="ln-332" href="#ln-332"></a><span class="c">!  Event function: when the altitude drops below the deadband.</span>
<a id="ln-333" name="ln-333" href="#ln-333"></a><span class="c">!</span>
<a id="ln-334" name="ln-334" href="#ln-334"></a><span class="c">!@note Moon is assumed to be a sphere.</span>
<a id="ln-335" name="ln-335" href="#ln-335"></a>
<a id="ln-336" name="ln-336" href="#ln-336"></a><span class="w">    </span><span class="k">subroutine </span><span class="n">event_func</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">g</span><span class="p">)</span><span class="w"></span>
<a id="ln-337" name="ln-337" href="#ln-337"></a>
<a id="ln-338" name="ln-338" href="#ln-338"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-339" name="ln-339" href="#ln-339"></a>
<a id="ln-340" name="ln-340" href="#ln-340"></a><span class="k">    class</span><span class="p">(</span><span class="n">ddeabm_with_event_class</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">me</span><span class="w"></span>
<a id="ln-341" name="ln-341" href="#ln-341"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">              </span><span class="kd">::</span><span class="w"> </span><span class="n">t</span><span class="w">  </span><span class="c">!! time</span>
<a id="ln-342" name="ln-342" href="#ln-342"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span><span class="w">  </span><span class="c">!! state -- moon centered inertial frame</span>
<a id="ln-343" name="ln-343" href="#ln-343"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w">             </span><span class="kd">::</span><span class="w"> </span><span class="n">g</span><span class="w">  </span><span class="c">!! event function</span>
<a id="ln-344" name="ln-344" href="#ln-344"></a>
<a id="ln-345" name="ln-345" href="#ln-345"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">alt</span><span class="w">  </span><span class="c">!! altitude (km)</span>
<a id="ln-346" name="ln-346" href="#ln-346"></a>
<a id="ln-347" name="ln-347" href="#ln-347"></a><span class="w">    </span><span class="k">select type</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">)</span><span class="w"></span>
<a id="ln-348" name="ln-348" href="#ln-348"></a><span class="w">    </span><span class="k">class is</span><span class="w"> </span><span class="p">(</span><span class="n">segment</span><span class="p">)</span><span class="w"></span>
<a id="ln-349" name="ln-349" href="#ln-349"></a>
<a id="ln-350" name="ln-350" href="#ln-350"></a><span class="w">        </span><span class="k">select case</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">event</span><span class="p">)</span><span class="w"></span>
<a id="ln-351" name="ln-351" href="#ln-351"></a><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<a id="ln-352" name="ln-352" href="#ln-352"></a>
<a id="ln-353" name="ln-353" href="#ln-353"></a><span class="w">            </span><span class="c">! g is offset from deadband altitude</span>
<a id="ln-354" name="ln-354" href="#ln-354"></a><span class="w">            </span><span class="n">alt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">norm2</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">))</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">r_moon</span><span class="w"></span>
<a id="ln-355" name="ln-355" href="#ln-355"></a><span class="w">            </span><span class="n">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alt</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nominal_altitude</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">deadband</span><span class="p">)</span><span class="w"></span>
<a id="ln-356" name="ln-356" href="#ln-356"></a>
<a id="ln-357" name="ln-357" href="#ln-357"></a><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<a id="ln-358" name="ln-358" href="#ln-358"></a>
<a id="ln-359" name="ln-359" href="#ln-359"></a><span class="w">            </span><span class="c">! g is rdot, which is zero and periapsis</span>
<a id="ln-360" name="ln-360" href="#ln-360"></a><span class="w">            </span><span class="c">! and apoapsis of an ellipse:</span>
<a id="ln-361" name="ln-361" href="#ln-361"></a><span class="w">            </span><span class="n">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rdot</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span><span class="w"></span>
<a id="ln-362" name="ln-362" href="#ln-362"></a>
<a id="ln-363" name="ln-363" href="#ln-363"></a><span class="w">            </span><span class="c">! TODO: figure out how to get it to ignore periapsis roots</span>
<a id="ln-364" name="ln-364" href="#ln-364"></a><span class="w">            </span><span class="c">! [maybe need to update DDEABM so we have more control</span>
<a id="ln-365" name="ln-365" href="#ln-365"></a><span class="w">            </span><span class="c">! over which roots it stops at]</span>
<a id="ln-366" name="ln-366" href="#ln-366"></a>
<a id="ln-367" name="ln-367" href="#ln-367"></a><span class="w">        </span><span class="k">case </span><span class="n">default</span><span class="w"></span>
<a id="ln-368" name="ln-368" href="#ln-368"></a><span class="w">            </span><span class="k">error stop</span><span class="w"> </span><span class="s1">&#39;invalid event value in event_func&#39;</span><span class="w"></span>
<a id="ln-369" name="ln-369" href="#ln-369"></a><span class="w">        </span><span class="k">end select</span>
<a id="ln-370" name="ln-370" href="#ln-370"></a>
<a id="ln-371" name="ln-371" href="#ln-371"></a><span class="k">    class </span><span class="n">default</span><span class="w"></span>
<a id="ln-372" name="ln-372" href="#ln-372"></a><span class="w">        </span><span class="k">error stop</span><span class="w"> </span><span class="s1">&#39;invalid class in event_func&#39;</span><span class="w"></span>
<a id="ln-373" name="ln-373" href="#ln-373"></a><span class="w">    </span><span class="k">end select</span>
<a id="ln-374" name="ln-374" href="#ln-374"></a>
<a id="ln-375" name="ln-375" href="#ln-375"></a><span class="k">    end subroutine </span><span class="n">event_func</span><span class="w"></span>
<a id="ln-376" name="ln-376" href="#ln-376"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-377" name="ln-377" href="#ln-377"></a>
<a id="ln-378" name="ln-378" href="#ln-378"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-379" name="ln-379" href="#ln-379"></a><span class="c">!&gt;</span>
<a id="ln-380" name="ln-380" href="#ln-380"></a><span class="c">!  Equations of motion for a ballistic orbit around the moon.</span>
<a id="ln-381" name="ln-381" href="#ln-381"></a>
<a id="ln-382" name="ln-382" href="#ln-382"></a><span class="w">    </span><span class="k">subroutine </span><span class="n">ballistic_derivs</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">xdot</span><span class="p">)</span><span class="w"></span>
<a id="ln-383" name="ln-383" href="#ln-383"></a>
<a id="ln-384" name="ln-384" href="#ln-384"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-385" name="ln-385" href="#ln-385"></a>
<a id="ln-386" name="ln-386" href="#ln-386"></a><span class="k">    class</span><span class="p">(</span><span class="n">ddeabm_class</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">me</span><span class="w"></span>
<a id="ln-387" name="ln-387" href="#ln-387"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">               </span><span class="kd">::</span><span class="w"> </span><span class="n">t</span><span class="w">    </span><span class="c">!! time [sec from epoch]</span>
<a id="ln-388" name="ln-388" href="#ln-388"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span><span class="w">    </span><span class="c">!! state [r,v] in inertial frame (moon-centered)</span>
<a id="ln-389" name="ln-389" href="#ln-389"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xdot</span><span class="w"> </span><span class="c">!! derivative of state (\( dx/dt \))</span>
<a id="ln-390" name="ln-390" href="#ln-390"></a>
<a id="ln-391" name="ln-391" href="#ln-391"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="n">rb</span><span class="p">,</span><span class="n">v</span><span class="w"></span>
<a id="ln-392" name="ln-392" href="#ln-392"></a><span class="w">    </span><span class="kt">reaL</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rv_earth_wrt_moon</span><span class="p">,</span><span class="n">rv_sun_wrt_moon</span><span class="w"></span>
<a id="ln-393" name="ln-393" href="#ln-393"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rotmat</span><span class="w"></span>
<a id="ln-394" name="ln-394" href="#ln-394"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">a_geopot</span><span class="w"></span>
<a id="ln-395" name="ln-395" href="#ln-395"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">a_earth</span><span class="w"></span>
<a id="ln-396" name="ln-396" href="#ln-396"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">a_sun</span><span class="w"></span>
<a id="ln-397" name="ln-397" href="#ln-397"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">a_third_body</span><span class="w"></span>
<a id="ln-398" name="ln-398" href="#ln-398"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">et</span><span class="w"> </span><span class="c">!! ephemeris time of `t`</span>
<a id="ln-399" name="ln-399" href="#ln-399"></a><span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">status_ok</span><span class="w">  </span><span class="c">!! ephemeris status flag</span>
<a id="ln-400" name="ln-400" href="#ln-400"></a>
<a id="ln-401" name="ln-401" href="#ln-401"></a><span class="w">    </span><span class="k">select type</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">)</span><span class="w"></span>
<a id="ln-402" name="ln-402" href="#ln-402"></a>
<a id="ln-403" name="ln-403" href="#ln-403"></a><span class="w">    </span><span class="k">class is</span><span class="w"> </span><span class="p">(</span><span class="n">segment</span><span class="p">)</span><span class="w"></span>
<a id="ln-404" name="ln-404" href="#ln-404"></a>
<a id="ln-405" name="ln-405" href="#ln-405"></a><span class="w">        </span><span class="c">! get state:</span>
<a id="ln-406" name="ln-406" href="#ln-406"></a><span class="w">        </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<a id="ln-407" name="ln-407" href="#ln-407"></a><span class="w">        </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span><span class="w"></span>
<a id="ln-408" name="ln-408" href="#ln-408"></a>
<a id="ln-409" name="ln-409" href="#ln-409"></a><span class="w">        </span><span class="c">! compute ephemeris time [sec]:</span>
<a id="ln-410" name="ln-410" href="#ln-410"></a><span class="w">        </span><span class="n">et</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">et_ref</span><span class="w"></span>
<a id="ln-411" name="ln-411" href="#ln-411"></a>
<a id="ln-412" name="ln-412" href="#ln-412"></a><span class="w">        </span><span class="c">! geopotential gravity:</span>
<a id="ln-413" name="ln-413" href="#ln-413"></a><span class="w">        </span><span class="n">rotmat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icrf_to_iau_moon</span><span class="p">(</span><span class="n">et</span><span class="p">)</span><span class="w">   </span><span class="c">! rotation matrix from inertial to body-fixed Moon frame</span>
<a id="ln-414" name="ln-414" href="#ln-414"></a><span class="w">        </span><span class="n">rb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">matmul</span><span class="p">(</span><span class="n">rotmat</span><span class="p">,</span><span class="n">r</span><span class="p">)</span><span class="w">           </span><span class="c">! r in body-fixed frame</span>
<a id="ln-415" name="ln-415" href="#ln-415"></a><span class="w">        </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">grav</span><span class="p">%</span><span class="n">get_acc</span><span class="p">(</span><span class="n">rb</span><span class="p">,</span><span class="n">me</span><span class="p">%</span><span class="n">grav_n</span><span class="p">,</span><span class="n">me</span><span class="p">%</span><span class="n">grav_m</span><span class="p">,</span><span class="n">a_geopot</span><span class="p">)</span><span class="w">  </span><span class="c">! get the acc due to the geopotential</span>
<a id="ln-416" name="ln-416" href="#ln-416"></a><span class="w">        </span><span class="n">a_geopot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">matmul</span><span class="p">(</span><span class="nb">transpose</span><span class="p">(</span><span class="n">rotmat</span><span class="p">),</span><span class="n">a_geopot</span><span class="p">)</span><span class="w">    </span><span class="c">! convert acc back to inertial frame</span>
<a id="ln-417" name="ln-417" href="#ln-417"></a>
<a id="ln-418" name="ln-418" href="#ln-418"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">include_third_bodies</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<a id="ln-419" name="ln-419" href="#ln-419"></a><span class="w">            </span><span class="c">! third-body state vectors (wrt the central body, which is the moon in this case):</span>
<a id="ln-420" name="ln-420" href="#ln-420"></a><span class="w">            </span><span class="c">! [inertial frame]</span>
<a id="ln-421" name="ln-421" href="#ln-421"></a><span class="w">            </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">eph</span><span class="p">%</span><span class="n">get_rv</span><span class="p">(</span><span class="n">et</span><span class="p">,</span><span class="n">body_earth</span><span class="p">,</span><span class="n">body_moon</span><span class="p">,</span><span class="n">rv_earth_wrt_moon</span><span class="p">,</span><span class="n">status_ok</span><span class="p">)</span><span class="w"></span>
<a id="ln-422" name="ln-422" href="#ln-422"></a><span class="w">            </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">eph</span><span class="p">%</span><span class="n">get_rv</span><span class="p">(</span><span class="n">et</span><span class="p">,</span><span class="n">body_sun</span><span class="p">,</span><span class="n">body_moon</span><span class="p">,</span><span class="n">rv_sun_wrt_moon</span><span class="p">,</span><span class="n">status_ok</span><span class="p">)</span><span class="w"></span>
<a id="ln-423" name="ln-423" href="#ln-423"></a>
<a id="ln-424" name="ln-424" href="#ln-424"></a><span class="w">            </span><span class="c">! third-body perturbation (earth &amp; sun):</span>
<a id="ln-425" name="ln-425" href="#ln-425"></a><span class="w">            </span><span class="n">a_third_body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="w"></span>
<a id="ln-426" name="ln-426" href="#ln-426"></a><span class="w">            </span><span class="k">call </span><span class="n">third_body_gravity</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">rv_earth_wrt_moon</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">),</span><span class="n">body_earth</span><span class="p">%</span><span class="n">mu</span><span class="p">,</span><span class="n">a_earth</span><span class="p">)</span><span class="w"></span>
<a id="ln-427" name="ln-427" href="#ln-427"></a><span class="w">            </span><span class="k">call </span><span class="n">third_body_gravity</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">rv_sun_wrt_moon</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">),</span><span class="n">body_sun</span><span class="p">%</span><span class="n">mu</span><span class="p">,</span><span class="n">a_sun</span><span class="p">)</span><span class="w"></span>
<a id="ln-428" name="ln-428" href="#ln-428"></a><span class="w">            </span><span class="n">a_third_body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a_earth</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a_sun</span><span class="w"></span>
<a id="ln-429" name="ln-429" href="#ln-429"></a><span class="w">        </span><span class="k">else</span>
<a id="ln-430" name="ln-430" href="#ln-430"></a><span class="k">            </span><span class="n">a_third_body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span><span class="w"></span>
<a id="ln-431" name="ln-431" href="#ln-431"></a><span class="w">        </span><span class="k">end if</span><span class="w"></span>
<a id="ln-432" name="ln-432" href="#ln-432"></a>
<a id="ln-433" name="ln-433" href="#ln-433"></a><span class="w">        </span><span class="c">!total derivative vector:</span>
<a id="ln-434" name="ln-434" href="#ln-434"></a><span class="w">        </span><span class="n">xdot</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="w"></span>
<a id="ln-435" name="ln-435" href="#ln-435"></a><span class="w">        </span><span class="n">xdot</span><span class="p">(</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a_geopot</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a_third_body</span><span class="w"></span>
<a id="ln-436" name="ln-436" href="#ln-436"></a>
<a id="ln-437" name="ln-437" href="#ln-437"></a><span class="w">    </span><span class="k">class </span><span class="n">default</span><span class="w"></span>
<a id="ln-438" name="ln-438" href="#ln-438"></a><span class="w">        </span><span class="k">error stop</span><span class="w"> </span><span class="s1">&#39;invalid class in ballistic_derivs&#39;</span><span class="w"></span>
<a id="ln-439" name="ln-439" href="#ln-439"></a><span class="w">    </span><span class="k">end select</span>
<a id="ln-440" name="ln-440" href="#ln-440"></a>
<a id="ln-441" name="ln-441" href="#ln-441"></a><span class="k">    end subroutine </span><span class="n">ballistic_derivs</span><span class="w"></span>
<a id="ln-442" name="ln-442" href="#ln-442"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-443" name="ln-443" href="#ln-443"></a>
<a id="ln-444" name="ln-444" href="#ln-444"></a><span class="c">!*****************************************************************************************</span>
<a id="ln-445" name="ln-445" href="#ln-445"></a><span class="w">    </span><span class="k">end module </span><span class="n">altitude_maintenance_module</span><span class="w"></span>
<a id="ln-446" name="ln-446" href="#ln-446"></a><span class="c">!*****************************************************************************************</span>
</pre></div>

    </section>
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>lom was developed by Jacob Williams<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>